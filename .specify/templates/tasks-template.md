# 功能文档 (FD): [功能名称]

**文档编号**: FD-[xxxxx]-[功能名称]  
**创建日期**: [日期]  
**需求文档**: `文档/开发文档/PRD/PRD-[xxxxx]-[功能名称].md`  
**技术设计**: `文档/开发文档/TDD/TDD-[xxxxx]-[功能名称].md`

---

## 任务格式说明

- **[P]**: 可并行执行（不同文件，无依赖）
- **[US?]**: 所属用户故事（例如 US1, US2, US3）
- 描述中包含确切的文件路径

## 路径约定

基于项目结构 `com.empathy.ai/`:
- **领域层**: `domain/model/`, `domain/repository/`, `domain/usecase/`
- **数据层**: `data/local/`, `data/repository/`
- **表现层**: `presentation/ui/screen/`, `presentation/viewmodel/`

<!-- 
  ============================================================================
  重要说明: 以下任务为示例，仅供参考。
  
  实际生成时必须根据以下内容替换:
  - PRD 中的用户故事（及其优先级 P1, P2, P3...）
  - TDD 中的技术设计
  - 数据模型定义
  - 接口定义
  
  任务必须按用户故事组织，以便每个故事可以:
  - 独立实现
  - 独立测试
  - 作为 MVP 增量交付
  ============================================================================
-->

## 阶段 1: 基础设置

**目标**: 项目初始化和基础结构

- [ ] T001 创建功能相关的包结构
- [ ] T002 [P] 添加必要的依赖到 build.gradle.kts
- [ ] T003 [P] 创建 Hilt 模块配置

---

## 阶段 2: 基础架构（阻塞性前置条件）

**目标**: 必须在任何用户故事开始前完成的核心基础设施

**⚠️ 关键**: 此阶段完成前不能开始任何用户故事

- [ ] T004 创建领域模型 `domain/model/[Entity].kt`
- [ ] T005 [P] 创建数据库实体 `data/local/entity/[Entity]Entity.kt`
- [ ] T006 [P] 创建 DAO 接口 `data/local/dao/[Entity]Dao.kt`
- [ ] T007 创建 Repository 接口 `domain/repository/[Entity]Repository.kt`
- [ ] T008 实现 Repository `data/repository/[Entity]RepositoryImpl.kt`
- [ ] T009 在 DatabaseModule 中注册 DAO
- [ ] T010 在 RepositoryModule 中注册 Repository

**检查点**: 基础架构就绪 - 可以开始用户故事实现

---

## 阶段 3: 用户故事 1 - [标题] (优先级: P1) 🎯 MVP

**目标**: [简要描述此故事交付的内容]

**独立测试**: [如何验证此故事独立工作]

### 用户故事 1 的测试（可选 - 仅在要求测试时）⚠️

> **注意: 先编写测试，确保测试失败后再实现**

- [ ] T011 [P] [US1] 单元测试 `test/.../[UseCase]Test.kt`
- [ ] T012 [P] [US1] ViewModel 测试 `test/.../[ViewModel]Test.kt`

### 用户故事 1 的实现

- [ ] T013 [US1] 创建用例 `domain/usecase/[UseCase].kt`
- [ ] T014 [US1] 创建 UiState `presentation/ui/screen/[功能]/[功能]UiState.kt`
- [ ] T015 [US1] 创建 UiEvent `presentation/ui/screen/[功能]/[功能]UiEvent.kt`
- [ ] T016 [US1] 创建 ViewModel `presentation/viewmodel/[功能]ViewModel.kt`
- [ ] T017 [US1] 创建 Screen `presentation/ui/screen/[功能]/[功能]Screen.kt`
- [ ] T018 [US1] 添加导航路由到 NavGraph.kt

**检查点**: 用户故事 1 应该完全可用且可独立测试

---

## 阶段 4: 用户故事 2 - [标题] (优先级: P2)

**目标**: [简要描述此故事交付的内容]

**独立测试**: [如何验证此故事独立工作]

### 用户故事 2 的测试（可选）⚠️

- [ ] T019 [P] [US2] 单元测试
- [ ] T020 [P] [US2] 集成测试

### 用户故事 2 的实现

- [ ] T021 [US2] 扩展用例或创建新用例
- [ ] T022 [US2] 更新 UiState 和 UiEvent
- [ ] T023 [US2] 更新 ViewModel
- [ ] T024 [US2] 更新 Screen UI

**检查点**: 用户故事 1 和 2 都应该独立工作

---

## 阶段 5: 用户故事 3 - [标题] (优先级: P3)

**目标**: [简要描述此故事交付的内容]

**独立测试**: [如何验证此故事独立工作]

### 用户故事 3 的实现

- [ ] T025 [US3] 相关实现任务
- [ ] T026 [US3] 相关实现任务

**检查点**: 所有用户故事都应该独立可用

---

## 阶段 N: 收尾与优化

**目标**: 影响多个用户故事的改进

- [ ] TXXX [P] 更新相关文档
- [ ] TXXX 代码清理和重构
- [ ] TXXX 性能优化
- [ ] TXXX 安全加固

---

## 依赖关系与执行顺序

### 阶段依赖

- **阶段 1 (设置)**: 无依赖 - 可立即开始
- **阶段 2 (基础架构)**: 依赖设置完成 - 阻塞所有用户故事
- **阶段 3+ (用户故事)**: 都依赖基础架构完成
  - 用户故事可以并行进行（如果有人力）
  - 或按优先级顺序执行（P1 → P2 → P3）
- **阶段 N (收尾)**: 依赖所有期望的用户故事完成

### 用户故事依赖

- **用户故事 1 (P1)**: 基础架构完成后可开始 - 不依赖其他故事
- **用户故事 2 (P2)**: 基础架构完成后可开始 - 可能与 US1 集成但应独立可测
- **用户故事 3 (P3)**: 基础架构完成后可开始 - 可能与 US1/US2 集成但应独立可测

### 并行机会

- 所有标记 [P] 的任务可以并行执行
- 基础架构完成后，所有用户故事可以并行开始
- 不同用户故事可以由不同开发者并行处理

---

## 实施策略

### MVP 优先（仅用户故事 1）

1. 完成阶段 1: 设置
2. 完成阶段 2: 基础架构（关键 - 阻塞所有故事）
3. 完成阶段 3: 用户故事 1
4. **停止并验证**: 独立测试用户故事 1
5. 如果就绪则部署/演示

### 增量交付

1. 完成设置 + 基础架构 → 基础就绪
2. 添加用户故事 1 → 独立测试 → 部署/演示 (MVP!)
3. 添加用户故事 2 → 独立测试 → 部署/演示
4. 添加用户故事 3 → 独立测试 → 部署/演示
5. 每个故事增加价值而不破坏之前的故事

---

## 注意事项

- [P] 任务 = 不同文件，无依赖
- [US?] 标签将任务映射到特定用户故事以便追踪
- 每个用户故事应该独立可完成和可测试
- 验证测试失败后再实现
- 每个任务或逻辑组完成后提交
- 在任何检查点停止以独立验证故事
- 避免: 模糊任务、同文件冲突、破坏独立性的跨故事依赖

---

## 文档信息

**存放路径**: `文档/开发文档/FD/FD-[xxxxx]-[功能名称].md`

**相关文档**:
- 需求文档: `文档/开发文档/PRD/PRD-[xxxxx]-[功能名称].md`
- 技术设计: `文档/开发文档/TDD/TDD-[xxxxx]-[功能名称].md`
- 测试计划: `文档/开发文档/TP/TP-[xxxxx]-[功能名称].md`
