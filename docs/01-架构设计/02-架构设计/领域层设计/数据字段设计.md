---
date_modified: 2025-12-01 16:11:10
---
### 1. 联系人画像 (ContactProfile)

这是你的核心“角色卡”。我们将所有零碎的事实信息（住址、爱好、性格）都统一放入 `facts` 字典中，方便后续直接遍历拼接到 Prompt 里。

Kotlin

```
package com.empathy.ai.domain.model

data class ContactProfile(
    // 唯一标识 (通常为 UUID 或 微信/QQ 的加密 ID)
    val id: String,

    // 显示名称 (e.g., "王总", "李铁柱")
    val name: String,

    // 核心攻略目标 (这一段关系的终极目的，e.g., "拿下合同", "修复父子关系")
    val targetGoal: String,

    // 上下文读取深度 (配置项：每次分析读取最近多少条记录，默认为 10)
    val contextDepth: Int = 10,

    // 【核心事实槽】
    // 存储所有事实类信息，替代死板的字段。
    // AI 或用户提取的信息都存这里，发送时直接拼接。
    // 结构示例: {"电话": "138...", "住址": "朝阳区", "性格": "吃软不吃硬", "爱好": "钓鱼"}
    val facts: Map<String, String> = emptyMap()
)
```

---

### 2. 策略标签 (BrainTag)

这是 AI 的“军师锦囊”。这里只存储对决策有直接影响的**主观策略**（雷区或建议），不再存储客观事实。

Kotlin

```
package com.empathy.ai.domain.model

// 标签类型定义
enum class TagType {
    RISK_RED,       // 【雷区/警告】：绝对不能踩的点 (e.g., "不要提他前妻", "忌讳迟到")
    STRATEGY_GREEN  // 【重点/策略】：建议切入的点 (e.g., "多夸他衣品好", "聊家庭")
}

data class BrainTag(
    // 数据库自增 ID
    val id: Long = 0,

    // 外键：关联到哪个联系人
    val contactId: String,

    // 标签内容 (e.g., "不喜欢吃香菜")
    val content: String,

    // 类型：雷区(Red) 或 策略(Green)
    val type: TagType,

    // 来源标记：用于区分数据权重
    // "MANUAL" = 用户手动添加 (高权重，AI 不可篡改)
    // "AI_INFERRED" = AI 从聊天记录分析得出 (低权重，用户可确认转正)
    val source: String = "MANUAL"
)
```

---

### 3. 聊天消息 (ChatMessage)

这是最基础的上下文单元。去掉了多媒体路径，只保留纯文本内容（视频/语音转文字后的结果）。

Kotlin

```
package com.empathy.ai.domain.model

// 发送者枚举
enum class MessageSender { 
    ME,    // 我发的
    THEM   // 对方发的
}

data class ChatMessage(
    // 消息唯一 ID
    val id: String,

    // 内容核心：无论是文本消息，还是语音转录/OCR 后的文字，都存这里
    // AI 只消费这个字段
    val content: String,

    // 发送者
    val sender: MessageSender,

    // 时间戳 (用于排序，保证上下文顺序正确)
    val timestamp: Long
)
```

---

### 4. 分析结果 (AnalysisResult)

这是 AI 计算后的输出，直接用于 UI 展示。

Kotlin

```
package com.empathy.ai.domain.model

// 风险等级枚举
enum class RiskLevel { 
    SAFE,    // 安全
    WARNING, // 警告 (有轻微不妥)
    DANGER   // 危险 (踩雷了)
}

data class AnalysisResult(
    // 话术建议：AI 生成的可以直接发送的回复文本
    val replySuggestion: String,

    // 军师分析：AI 对当前局势的心理分析 (给用户看的)
    val strategyAnalysis: String,

    // 风险等级：用于 UI 显示红/黄/绿颜色
    val riskLevel: RiskLevel
)
```
