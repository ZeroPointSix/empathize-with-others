# Project-wide Gradle settings.
# 编译优化配置 - 2025-12-21 更新
# 硬件: i7-13650HX (14核20线程) + 24GB RAM

# ============================================
# JVM 配置 (针对 24GB 内存优化)
# ============================================
org.gradle.java.home=C:\\Program Files\\Java\\jdk-17

# JVM 参数优化（针对24GB RAM和i7-13650HX优化）：
# - Xmx6g: 最大堆6GB（充分利用24GB内存）
# - Xms2g: 初始堆2GB，减少扩容开销
# - XX:+UseG1GC: G1垃圾收集器，大堆内存更高效
# - XX:MaxGCPauseMillis: 控制GC暂停时间
# - XX:+UseStringDeduplication: 字符串去重，节省内存
# 注意：移除了 Windows 不支持的 CGroupMemoryLimitForHeap 参数
org.gradle.jvmargs=-Xmx6g -Xms2g -XX:+UseG1GC -XX:MaxGCPauseMillis=150 -XX:+UseStringDeduplication -XX:MaxMetaspaceSize=512m -Dfile.encoding=UTF-8

# ============================================
# 并行构建优化 (针对 14核20线程)
# ============================================
# 启用并行编译
org.gradle.parallel=true

# 设置最大工作线程数（14核20线程的75%，充分利用多核）
org.gradle.workers.max=15

# 启用构建缓存
org.gradle.caching=true

# 按需配置
org.gradle.configureondemand=true

# 配置缓存 - Gradle 8.x 新特性
org.gradle.configuration-cache=true

# Daemon 配置
org.gradle.daemon=true
org.gradle.daemon.idletimeout=10800000

# ============================================
# Kotlin 编译优化
# ============================================
kotlin.code.style=official
kotlin.incremental=true
kotlin.incremental.useClasspathSnapshot=true

# Kotlin 编译器守护进程 - 针对 AS 优化
kotlin.daemon.jvmargs=-Xmx3g -XX:+UseG1GC -XX:MaxGCPauseMillis=100 -XX:+UseStringDeduplication

# K2 编译器在 Kotlin 2.0+ 中已是默认，无需显式启用

# Kotlin 增量编译优化
kotlin.compiler.execution.strategy=in-process
kotlin.incremental.android=true

# Android Studio 专用优化 (AGP 8.7.3 兼容)
# 注意：android.enableBuildCache 已在 AGP 7.0 废弃，8.0 移除
# 现在使用统一的 Gradle 构建缓存机制

# 模块依赖优化（AGP 8.x 兼容）
android.enableModuleDependencies=true

# R8 全模式优化
android.enableR8.fullMode=true

# ============================================
# Android 特定优化
# ============================================
android.useAndroidX=true
android.nonTransitiveRClass=true

# 禁用不必要的构建特性
android.defaults.buildfeatures.aidl=false
android.defaults.buildfeatures.renderscript=false

# R8 全模式
android.enableR8.fullMode=true

# R8 内存优化（针对6GB堆内存）
org.gradle.workers.worker.heap=2g

# 启用 Jetifier 缓存
android.enableJetifier=false

# 预编译库缓存
org.gradle.dependency.verification=off