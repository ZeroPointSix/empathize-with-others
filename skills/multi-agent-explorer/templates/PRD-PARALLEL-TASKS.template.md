# PRD-XXXXX-[功能名称]

> 本模板展示如何在 PRD 中规划支持并行开发的任务

## 基本信息

| 项目 | 内容 |
|------|------|
| PRD编号 | PRD-XXXXX |
| 功能名称 | [功能名称] |
| 创建日期 | YYYY-MM-DD |
| 状态 | 规划中 / 开发中 / 已完成 |

---

## 功能概述

[功能描述]

---

## 📊 任务影响范围分析

> 🔴 **在分配任务前，必须完成影响范围分析**

### 任务清单与影响范围

| 任务ID | 任务描述 | 影响的文件 | 模块 |
|--------|---------|-----------|------|
| T-001 | [任务描述] | file1.kt, file2.kt | :domain |
| T-002 | [任务描述] | file3.kt | :data |
| T-003 | [任务描述] | file4.kt, file5.kt | :presentation |
| T-004 | [任务描述] | file1.kt, file6.kt | :domain, :data |
| T-005 | [任务描述] | file7.kt | :app |

### 文件冲突矩阵

| 文件 | T-001 | T-002 | T-003 | T-004 | T-005 |
|------|-------|-------|-------|-------|-------|
| file1.kt | ✏️ | | | ✏️ | |
| file2.kt | ✏️ | | | | |
| file3.kt | | ✏️ | | | |
| file4.kt | | | ✏️ | | |
| file5.kt | | | ✏️ | | |
| file6.kt | | | | ✏️ | |
| file7.kt | | | | | ✏️ |

**冲突分析**：
- T-001 和 T-004 都修改 `file1.kt` → 🔴 **冲突**

---

## 🎯 并行性规划

### 任务依赖图

```
     ┌─────┐
     │T-001│──────┐
     └──┬──┘      │
        │         │
        ▼         ▼
     ┌─────┐   ┌─────┐
     │T-004│   │T-002│
     └──┬──┘   └──┬──┘
        │         │
        └────┬────┘
             │
             ▼
          ┌─────┐
          │T-003│
          └──┬──┘
             │
             ▼
          ┌─────┐
          │T-005│
          └─────┘

T-001 → T-004 (文件冲突，必须串行)
T-002 可与 T-001, T-004 并行
T-003 依赖 T-002, T-004 完成
T-005 依赖 T-003 完成
```

### 并行执行计划

#### 🟢 阶段 1：可完全并行

| 智能体 | 任务 | 影响文件 | 预估工时 |
|--------|------|---------|---------|
| Agent A | T-001 | file1.kt, file2.kt | 2h |
| Agent B | T-002 | file3.kt | 1h |

**说明**：T-001 和 T-002 涉及完全不同的文件，可以同时执行。

#### 🟡 阶段 2：部分并行

| 智能体 | 任务 | 影响文件 | 依赖 | 预估工时 |
|--------|------|---------|------|---------|
| Agent A | T-004 | file1.kt, file6.kt | T-001 完成 | 1.5h |
| Agent B | (等待) | - | - | - |

**说明**：T-004 必须等 T-001 完成（都修改 file1.kt）。

#### 🟢 阶段 3：可完全并行

| 智能体 | 任务 | 影响文件 | 依赖 | 预估工时 |
|--------|------|---------|------|---------|
| Agent A | T-003 | file4.kt, file5.kt | T-002, T-004 | 2h |
| Agent B | (可分配其他PRD任务) | - | - | - |

#### 🟢 阶段 4：最终任务

| 智能体 | 任务 | 影响文件 | 依赖 | 预估工时 |
|--------|------|---------|------|---------|
| Agent A | T-005 | file7.kt | T-003 | 0.5h |

---

## 📋 任务详情

### T-001: [任务标题]

**描述**：[详细描述]

**影响范围**：
- 🔧 修改：`domain/src/.../file1.kt`, `domain/src/.../file2.kt`
- ➕ 新增：无
- ➖ 删除：无

**并行性**：
- ✅ 可与 T-002 并行
- ❌ 不可与 T-004 并行（冲突：file1.kt）

**验收标准**：
- [ ] 标准1
- [ ] 标准2

---

### T-002: [任务标题]

**描述**：[详细描述]

**影响范围**：
- 🔧 修改：`data/src/.../file3.kt`
- ➕ 新增：无
- ➖ 删除：无

**并行性**：
- ✅ 可与 T-001, T-004, T-005 并行
- ⚠️ T-003 依赖本任务

**验收标准**：
- [ ] 标准1
- [ ] 标准2

---

### T-003: [任务标题]

**描述**：[详细描述]

**影响范围**：
- 🔧 修改：`presentation/src/.../file4.kt`, `presentation/src/.../file5.kt`
- ➕ 新增：无
- ➖ 删除：无

**依赖**：
- 依赖 T-002 完成（需要使用 T-002 的接口）
- 依赖 T-004 完成（需要使用 T-004 的数据）

**并行性**：
- ✅ 可与 T-005 并行（如果 T-005 不依赖本任务）

**验收标准**：
- [ ] 标准1
- [ ] 标准2

---

### T-004: [任务标题]

**描述**：[详细描述]

**影响范围**：
- 🔧 修改：`domain/src/.../file1.kt`, `data/src/.../file6.kt`
- ➕ 新增：无
- ➖ 删除：无

**依赖**：
- 依赖 T-001 完成（都修改 file1.kt，避免冲突）

**并行性**：
- ❌ 不可与 T-001 并行（冲突：file1.kt）
- ✅ 可与 T-002 并行

**验收标准**：
- [ ] 标准1
- [ ] 标准2

---

### T-005: [任务标题]

**描述**：[详细描述]

**影响范围**：
- 🔧 修改：`app/src/.../file7.kt`
- ➕ 新增：无
- ➖ 删除：无

**依赖**：
- 依赖 T-003 完成（需要集成 T-003 的功能）

**并行性**：
- ✅ 可与 T-001, T-002, T-004 并行（如果不考虑依赖）

**验收标准**：
- [ ] 标准1
- [ ] 标准2

---

## 📈 执行时间线

```
时间 →
     0h      1h      2h      3h      4h      5h      6h      7h
     |-------|-------|-------|-------|-------|-------|-------|
     
Agent A: [===T-001===]        [==T-004==][====T-003====][T-005]
Agent B: [=T-002=]            (空闲/其他任务)

总预估时间：7h（单智能体）→ 5h（双智能体并行）
效率提升：28.6%
```

---

## ⚠️ 风险与注意事项

### 并行开发风险

| 风险 | 级别 | 缓解措施 |
|------|------|---------|
| T-001/T-004 合并冲突 | 高 | 严格串行执行，T-001 完成后再开始 T-004 |
| 接口变更导致依赖任务失败 | 中 | T-002 完成后立即通知 T-003 开始 |
| 并行任务进度不同步 | 低 | 每日同步进度，调整计划 |

### 合并顺序建议

1. T-001 → 合并到主分支
2. T-002 → 合并到主分支
3. T-004 → 合并到主分支（基于最新主分支）
4. T-003 → 合并到主分支
5. T-005 → 合并到主分支

---

## 📝 执行记录

| 任务 | 智能体 | 开始时间 | 完成时间 | 状态 | 备注 |
|------|--------|---------|---------|------|------|
| T-001 | | | | ⏳待开始 | |
| T-002 | | | | ⏳待开始 | |
| T-003 | | | | ⏳待开始 | |
| T-004 | | | | ⏳待开始 | |
| T-005 | | | | ⏳待开始 | |
