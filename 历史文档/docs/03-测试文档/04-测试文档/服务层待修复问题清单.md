# æœåŠ¡å±‚å¾…ä¿®å¤é—®é¢˜æ¸…å•

## ğŸ“… ç”Ÿæˆæ—¶é—´
**åˆ›å»ºæ—¥æœŸ**: 2025-12-04  
**è¯Šæ–­æ¥æº**: æœåŠ¡å±‚æµ‹è¯•è¯Šæ–­æŠ¥å‘Š

---

## ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜ (P0)

### P0-1: FeedTextUseCaseåŠŸèƒ½æœªå®Œæˆä¸”æ— æµ‹è¯•

**é—®é¢˜ç±»å‹**: åŠŸèƒ½ç¼ºå¤± + æµ‹è¯•ç¼ºå¤±  
**å‘ç°ä½ç½®**: `app/src/main/java/com/empathy/ai/domain/usecase/FeedTextUseCase.kt`

#### é—®é¢˜è¯¦æƒ…

1. **æ ¸å¿ƒé€»è¾‘æœªå®ç°**
   - ç¬¬48è¡Œ: `TODO: è°ƒç”¨ aiRepository.extractInfo(maskedText)`
   - ç¬¬49è¡Œ: `TODO: è§£æ AI è¿”å›çš„ JSON ç»“æœ`
   - ç¬¬74-77è¡Œ: `parseAiResponse()`æ–¹æ³•ä¸ºç©ºå®ç°

2. **ä¾èµ–æ³¨å…¥ä¸å®Œæ•´**
   - æ³¨é‡Šè¯´æ˜"æš‚æ—¶ä¸æ³¨å…¥ AiRepository"
   - ç¼ºå°‘å®ç°AIèƒå–åŠŸèƒ½çš„å¿…è¦ä¾èµ–

3. **å®Œå…¨ç¼ºå°‘æµ‹è¯•**
   - æ— æµ‹è¯•æ–‡ä»¶: `FeedTextUseCaseTest.kt`ä¸å­˜åœ¨
   - æ— æ³•éªŒè¯ç°æœ‰éª¨æ¶é€»è¾‘
   - æ— æ³•ä¿è¯åŸºæœ¬æµç¨‹æ­£ç¡®

#### å½±å“è¯„ä¼°

- **åŠŸèƒ½å½±å“**: æ–‡æœ¬å–‚å…»åŠŸèƒ½å®Œå…¨ä¸å¯ç”¨
- **ç”¨æˆ·å½±å“**: ç”¨æˆ·æ— æ³•é€šè¿‡ç²˜è´´æ–‡æœ¬æå–ä¿¡æ¯
- **ç³»ç»Ÿå½±å“**: UseCaseå±‚è¦†ç›–ç‡ä¸‹é™è‡³75%
- **æŠ€æœ¯å€ºåŠ¡**: MVPæœªå†³ç­–çš„åŠŸèƒ½èŒƒå›´

#### ä¿®å¤å»ºè®®

**é˜¶æ®µä¸€: ç«‹å³ (æœ¬å‘¨)**
1. **åˆ›å»ºåŸºç¡€æµ‹è¯•æ–‡ä»¶** (1å°æ—¶)
   ```kotlin
   // FeedTextUseCaseTest.kt
   - æµ‹è¯•è„±æ•é¢„å¤„ç†æµç¨‹
   - æµ‹è¯•ExtractedDataç»“æ„æ­£ç¡®æ€§
   - æµ‹è¯•ç©ºæ•°æ®è¿”å›æƒ…å†µ
   ```

2. **æ˜ç¡®åŠŸèƒ½èŒƒå›´** (å†³ç­–ä¼šè®®)
   - MVPé˜¶æ®µæ˜¯å¦å®ç°AIèƒå–
   - å¦‚ä¸å®ç°,æ›´æ–°æ–‡æ¡£è¯´æ˜çŠ¶æ€
   - å¦‚å®ç°,åˆ¶å®šå®ç°è®¡åˆ’

**é˜¶æ®µäºŒ: çŸ­æœŸ (å¦‚éœ€å®ç°)**
3. **è¡¥å……ä¾èµ–æ³¨å…¥** (30åˆ†é’Ÿ)
   ```kotlin
   constructor(
       private val privacyRepository: PrivacyRepository,
       private val aiRepository: AiRepository  // æ·»åŠ æ­¤ä¾èµ–
   )
   ```

4. **å®ç°AIèƒå–é€»è¾‘** (3-4å°æ—¶)
   - å®ç°`aiRepository.extractInfo()`è°ƒç”¨
   - å®ç°JSONè§£æé€»è¾‘
   - å¤„ç†AIè¿”å›çš„é”™è¯¯æƒ…å†µ

5. **å®Œå–„æµ‹è¯•** (2å°æ—¶)
   - Mock AiRepository
   - æµ‹è¯•AIè°ƒç”¨æµç¨‹
   - æµ‹è¯•JSONè§£æé€»è¾‘
   - æµ‹è¯•é”™è¯¯å¤„ç†

#### é¢„è®¡å·¥ä½œé‡

- **æœ€å°ä¿®å¤** (ä»…æµ‹è¯•): 1å°æ—¶
- **å®Œæ•´ä¿®å¤** (åŠŸèƒ½+æµ‹è¯•): 6-8å°æ—¶

#### ä¼˜å…ˆçº§ç†ç”±

- å½±å“æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
- æµ‹è¯•è¦†ç›–ç‡å”¯ä¸€ç¼ºå£
- æŠ€æœ¯å€ºåŠ¡éœ€è¦å†³ç­–

**çŠ¶æ€**: ğŸ”´ å¾…ä¿®å¤  
**è´Ÿè´£äºº**: å¾…åˆ†é…  
**ç›®æ ‡å®Œæˆæ—¶é—´**: 2025-12-06

---

## ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜ (P1)

### P1-1: CheckDraftUseCaseæ·±åº¦æ£€æŸ¥åŠŸèƒ½æœªæµ‹è¯•

**é—®é¢˜ç±»å‹**: æµ‹è¯•è¦†ç›–ä¸å®Œæ•´  
**å‘ç°ä½ç½®**: `app/src/test/java/com/empathy/ai/domain/usecase/CheckDraftUseCaseTest.kt`

#### é—®é¢˜è¯¦æƒ…

1. **æœªæµ‹è¯•åˆ†æ”¯**
   - `enableDeepCheck=true`åˆ†æ”¯æ— æµ‹è¯•
   - Layer 2äº‘ç«¯è¯­ä¹‰æ£€æŸ¥é€»è¾‘æœªéªŒè¯
   - ç¬¬68-79è¡Œä»£ç è·¯å¾„æœªè¦†ç›–

2. **æ½œåœ¨é£é™©**
   - AIé›†æˆé€»è¾‘æœªéªŒè¯
   - è„±æ• + AIæ£€æŸ¥æµç¨‹æœªæµ‹è¯•
   - å¯èƒ½å­˜åœ¨éšè—bug

#### å½±å“è¯„ä¼°

- **åŠŸèƒ½å½±å“**: æ·±åº¦æ£€æŸ¥åŠŸèƒ½å¯èƒ½æœ‰bug
- **ç”¨æˆ·å½±å“**: ç”¨æˆ·å¯ç”¨æ·±åº¦æ£€æŸ¥æ—¶å¯èƒ½é‡åˆ°é—®é¢˜
- **æµ‹è¯•è¦†ç›–**: å½“å‰åªè¦†ç›–80%åŠŸèƒ½

#### ä¿®å¤å»ºè®®

**æ·»åŠ æµ‹è¯•ç”¨ä¾‹** (1å°æ—¶)

```kotlin
@Test
fun `should perform deep check when enabled`() = runTest {
    // Given
    val redTags = listOf(
        BrainTag(id = 1, contactId = "contact_1", 
                 content = "æ•æ„Ÿè¯é¢˜", type = TagType.RISK_RED)
    )
    coEvery { brainTagRepository.getTagsForContact("contact_1") } 
        returns flowOf(redTags)
    coEvery { privacyRepository.getPrivacyMapping() } 
        returns Result.success(emptyMap())
    
    val deepCheckResult = SafetyCheckResult(
        isSafe = false,
        triggeredRisks = listOf("è¯­ä¹‰æ£€æµ‹åˆ°é£é™©"),
        suggestion = "AIæ£€æµ‹å»ºè®®"
    )
    coEvery { aiRepository.checkDraftSafety(any(), any()) } 
        returns Result.success(deepCheckResult)
    
    val draft = "è¿™æ˜¯ä¸€ä¸ªéœ€è¦æ·±åº¦æ£€æŸ¥çš„æ–‡æœ¬"
    
    // When
    val result = useCase(
        contactId = "contact_1",
        draftSnapshot = draft,
        enableDeepCheck = true  // å¯ç”¨æ·±åº¦æ£€æŸ¥
    )
    
    // Then
    assertTrue(result.isSuccess)
    val checkResult = result.getOrNull()!!
    assertFalse(checkResult.isSafe)
    assertTrue(checkResult.triggeredRisks.contains("è¯­ä¹‰æ£€æµ‹åˆ°é£é™©"))
    
    // éªŒè¯AIè¢«è°ƒç”¨
    coVerify { aiRepository.checkDraftSafety(any(), any()) }
}

@Test
fun `should handle AI check failure gracefully`() = runTest {
    // æµ‹è¯•AIè°ƒç”¨å¤±è´¥çš„æƒ…å†µ
}
```

#### é¢„è®¡å·¥ä½œé‡

1å°æ—¶ (2-3ä¸ªæµ‹è¯•ç”¨ä¾‹)

#### ä¼˜å…ˆçº§ç†ç”±

- åŠŸèƒ½å·²å®ç°ä½†æœªæµ‹è¯•
- ç›¸å¯¹ç‹¬ç«‹,æ˜“äºè¡¥å……
- æå‡æµ‹è¯•è¦†ç›–ç‡

**çŠ¶æ€**: ğŸŸ¡ è®¡åˆ’ä¸­  
**è´Ÿè´£äºº**: å¾…åˆ†é…  
**ç›®æ ‡å®Œæˆæ—¶é—´**: 2025-12-11

---

## ğŸŸ¢ ä½ä¼˜å…ˆçº§å»ºè®® (P2)

### P2-1: å¢åŠ æ€§èƒ½æµ‹è¯•

**é—®é¢˜ç±»å‹**: æµ‹è¯•å¢å¼º  
**æ¶‰åŠæ¨¡å—**: PrivacyEngine, RuleEngine

#### å»ºè®®å†…å®¹

**PrivacyEngineæ€§èƒ½æµ‹è¯•**
```kotlin
@Test
fun `should handle large text efficiently`() {
    // Given - 10000å­—æ–‡æœ¬
    val largeText = "æµ‹è¯•å†…å®¹".repeat(5000)
    val mapping = (1..100).associate { 
        "å…³é”®è¯$it" to "[MASK_$it]" 
    }
    
    // When
    val startTime = System.currentTimeMillis()
    val result = PrivacyEngine.mask(largeText, mapping)
    val duration = System.currentTimeMillis() - startTime
    
    // Then
    assertTrue("è„±æ•åº”åœ¨1ç§’å†…å®Œæˆ", duration < 1000)
}
```

**RuleEngineæ€§èƒ½æµ‹è¯•**
```kotlin
@Test
fun `should handle many rules efficiently`() {
    // Given - 1000æ¡è§„åˆ™
    val rules = (1..1000).map { 
        BusinessRule(
            id = "rule_$it",
            name = "è§„åˆ™$it",
            pattern = "keyword$it",
            matchType = MatchType.SUBSTRING
        )
    }
    ruleEngine.addRules(rules)
    
    // When
    val startTime = System.currentTimeMillis()
    val result = ruleEngine.evaluate("åŒ…å«keyword500çš„æ–‡æœ¬")
    val duration = System.currentTimeMillis() - startTime
    
    // Then
    assertTrue("åŒ¹é…åº”åœ¨100mså†…å®Œæˆ", duration < 100)
}
```

#### ä»·å€¼è¯„ä¼°

- **æ€§èƒ½è¾¹ç•Œ**: äº†è§£æç«¯åœºæ™¯è¡¨ç°
- **ä¼˜åŒ–æŒ‡å¯¼**: è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
- **å›å½’é˜²æŠ¤**: é˜²æ­¢æ€§èƒ½å€’é€€

#### é¢„è®¡å·¥ä½œé‡

2å°æ—¶ (4-5ä¸ªæ€§èƒ½æµ‹è¯•)

**çŠ¶æ€**: ğŸŸ¢ å¯é€‰  
**è´Ÿè´£äºº**: å¾…åˆ†é…  
**ç›®æ ‡å®Œæˆæ—¶é—´**: 2025-12-20

---

## ğŸ“Š é—®é¢˜ç»Ÿè®¡

| ä¼˜å…ˆçº§ | é—®é¢˜æ•°é‡ | å·²ä¿®å¤ | å¾…ä¿®å¤ | è¿›è¡Œä¸­ |
|--------|---------|--------|--------|--------|
| ğŸ”´ P0 | 1 | 0 | 1 | 0 |
| ğŸŸ¡ P1 | 1 | 0 | 1 | 0 |
| ğŸŸ¢ P2 | 1 | 0 | 1 | 0 |
| **æ€»è®¡** | **3** | **0** | **3** | **0** |

---

## ğŸ“… ä¿®å¤æ—¶é—´è¡¨

### æœ¬å‘¨ (2025-12-04 ~ 2025-12-08)

- [ ] **P0-1**: å†³ç­–FeedTextUseCaseåŠŸèƒ½èŒƒå›´
- [ ] **P0-1**: åˆ›å»ºåŸºç¡€æµ‹è¯•æ–‡ä»¶
- [ ] **P0-1**: (å¯é€‰)å¼€å§‹å®ç°AIèƒå–é€»è¾‘

### ä¸‹å‘¨ (2025-12-09 ~ 2025-12-15)

- [ ] **P1-1**: è¡¥å……CheckDraftUseCaseæ·±åº¦æ£€æŸ¥æµ‹è¯•
- [ ] **P0-1**: (å¦‚éœ€è¦)å®ŒæˆAIèƒå–åŠŸèƒ½å®ç°

### æœ¬æœˆå†… (2025-12-16 ~ 2025-12-31)

- [ ] **P2-1**: æ·»åŠ æ€§èƒ½æµ‹è¯•
- [ ] ä»£ç å®¡æŸ¥å’Œæ–‡æ¡£æ›´æ–°

---

## ğŸ¯ ä¿®å¤éªŒæ”¶æ ‡å‡†

### P0-1: FeedTextUseCase

**æœ€å°éªŒæ”¶æ ‡å‡†** (MVPä¸å®ç°AIåŠŸèƒ½):
- [x] åˆ›å»ºFeedTextUseCaseTest.kt
- [x] è‡³å°‘3ä¸ªæµ‹è¯•ç”¨ä¾‹è¦†ç›–åŸºç¡€æµç¨‹
- [x] æµ‹è¯•å…¨éƒ¨é€šè¿‡
- [x] æ–‡æ¡£è¯´æ˜åŠŸèƒ½çŠ¶æ€

**å®Œæ•´éªŒæ”¶æ ‡å‡†** (å®ç°AIåŠŸèƒ½):
- [x] æœ€å°éªŒæ”¶æ ‡å‡†å…¨éƒ¨æ»¡è¶³
- [x] è¡¥å……AiRepositoryä¾èµ–æ³¨å…¥
- [x] å®ç°AIèƒå–é€»è¾‘
- [x] å®ç°JSONè§£æé€»è¾‘
- [x] è‡³å°‘8ä¸ªæµ‹è¯•ç”¨ä¾‹(åŒ…å«Mock AI)
- [x] æµ‹è¯•è¦†ç›–ç‡>90%
- [x] é”™è¯¯å¤„ç†å®Œæ•´

### P1-1: CheckDraftUseCaseæ·±åº¦æ£€æŸ¥

**éªŒæ”¶æ ‡å‡†**:
- [x] æ·»åŠ enableDeepCheck=trueæµ‹è¯•
- [x] Mock aiRepository.checkDraftSafety
- [x] æµ‹è¯•AIè°ƒç”¨æˆåŠŸåœºæ™¯
- [x] æµ‹è¯•AIè°ƒç”¨å¤±è´¥åœºæ™¯
- [x] æµ‹è¯•è¦†ç›–ç‡è¾¾åˆ°100%

### P2-1: æ€§èƒ½æµ‹è¯•

**éªŒæ”¶æ ‡å‡†**:
- [x] PrivacyEngineå¤§æ–‡æœ¬æµ‹è¯•
- [x] RuleEngineå¤§é‡è§„åˆ™æµ‹è¯•
- [x] æ€§èƒ½åŸºå‡†è®°å½•åœ¨æ–‡æ¡£
- [x] æ‰€æœ‰æ€§èƒ½æµ‹è¯•é€šè¿‡

---

## ğŸ“ å¤‡æ³¨

### å†³ç­–å¾…åŠ

1. **FeedTextUseCaseåŠŸèƒ½èŒƒå›´**
   - [ ] å¬å¼€æŠ€æœ¯è¯„å®¡ä¼šè®®
   - [ ] å†³å®šMVPé˜¶æ®µæ˜¯å¦å®ç°
   - [ ] æ›´æ–°äº§å“éœ€æ±‚æ–‡æ¡£
   - [ ] é€šçŸ¥ç›¸å…³å¼€å‘äººå‘˜

### èµ„æºéœ€æ±‚

- **å¼€å‘æ—¶é—´**: 8-10å°æ—¶ (å¦‚å…¨éƒ¨å®Œæˆ)
- **æµ‹è¯•ç¯å¢ƒ**: æ— ç‰¹æ®Šè¦æ±‚
- **å¤–éƒ¨ä¾èµ–**: éœ€è¦AIæœåŠ¡æµ‹è¯•ç¯å¢ƒ(P0-1å®Œæ•´ä¿®å¤)

### é£é™©æç¤º

âš ï¸ **FeedTextUseCase**: å¦‚æœMVPé˜¶æ®µéœ€è¦æ­¤åŠŸèƒ½,å»ºè®®å°½å¿«å®ç°,é¿å…å½±å“æ•´ä½“è¿›åº¦

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-12-04 13:23  
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ