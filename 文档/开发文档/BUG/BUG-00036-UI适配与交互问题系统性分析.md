# BUG-00036: UIé€‚é…ä¸äº¤äº’é—®é¢˜ç³»ç»Ÿæ€§åˆ†æ

> **æ–‡æ¡£ç±»å‹**: BUGåˆ†ææ–‡æ¡£
> **ç‰ˆæœ¬**: 2.1
> **åˆ›å»ºæ—¥æœŸ**: 2025-12-29
> **æ›´æ–°æ—¥æœŸ**: 2025-12-29
> **åˆ†æäºº**: Kiro
> **çŠ¶æ€**: ï¿½ ä¿®å¤å¤ä¸­
> **ä¼˜å…ˆçº§**: P0 (é«˜)
> **å½±å“èŒƒå›´**: å…¨å±€UIæ˜¾ç¤º
> **åˆ†ææ·±åº¦**: æ¡†æ¶çº§ + ç³»ç»Ÿçº§

---

## ğŸ“‹ é—®é¢˜æ¸…å•

| ç¼–å· | é—®é¢˜æè¿° | å½±å“èŒƒå›´ | ä¸¥é‡ç¨‹åº¦ |
|------|----------|----------|----------|
| BUG-36-01 | çœŸæœºåº•éƒ¨ç•Œé¢å­—ä½“æ˜¾ç¤ºä¸å®Œæ•´ | å…¨å±€ | P0 |
| BUG-36-02 | é…ç½®æ¨¡å‹ä¾›åº”å•†ç•Œé¢è¿”å›/æ·»åŠ ä¾›åº”å•†å­—ä½“è¿‡å¤§ | AddProviderScreen | P1 |
| BUG-36-03 | æƒé™è¯¢é—®å¯¹è¯æ¡†ä»ä½¿ç”¨æ—§ç‰ˆMaterialé£æ ¼ | PermissionRequestDialog | P1 |
| BUG-36-04 | ä¸ªäººåŒ–æ ‡ç­¾æ·»åŠ åè‡ªåŠ¨åˆ·æ–°å›åˆ°ç½®é¡¶ | PersonaTab | P1 |
| BUG-36-05 | ä¸ªäººåŒ–ç•Œé¢é‡ç½®åŠŸèƒ½æ— æ•ˆ | PersonaTab | P2 |

---

## ğŸ” ä¸€ã€æœºåˆ¶åˆ†æ

### 1.1 Jetpack Compose å“åº”å¼å°ºå¯¸ç³»ç»Ÿè¿è¡Œæœºåˆ¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Compose æ¸²æŸ“æµç¨‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Configuration å˜åŒ–æ£€æµ‹                                       â”‚
â”‚     â†“                                                           â”‚
â”‚  2. LocalConfiguration.current æ›´æ–°                              â”‚
â”‚     â†“                                                           â”‚
â”‚  3. rememberAdaptiveDimensions() é‡æ–°è®¡ç®—                        â”‚
â”‚     â†“                                                           â”‚
â”‚  4. CompositionLocal ä¼ æ’­æ–°å°ºå¯¸å€¼                                â”‚
â”‚     â†“                                                           â”‚
â”‚  5. æ‰€æœ‰ä½¿ç”¨ AdaptiveDimensions.current çš„ç»„ä»¶é‡ç»„               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 å½“å‰é¡¹ç›®å“åº”å¼å°ºå¯¸ç³»ç»Ÿæ¶æ„

```kotlin
// AdaptiveDimensions.kt æ ¸å¿ƒæœºåˆ¶
@Composable
fun rememberAdaptiveDimensions(): AdaptiveDimensionsData {
    val configuration = LocalConfiguration.current
    
    return remember(configuration.screenWidthDp, configuration.screenHeightDp, configuration.fontScale) {
        // æ ¹æ®å±å¹•å®½åº¦ç¡®å®šè®¾å¤‡ç±»å‹
        val screenSizeType = when {
            configuration.screenWidthDp < 360 -> ScreenSizeType.COMPACT
            configuration.screenWidthDp < 600 -> ScreenSizeType.MEDIUM
            configuration.screenWidthDp < 840 -> ScreenSizeType.EXPANDED
            else -> ScreenSizeType.LARGE
        }
        
        // è®¡ç®—ç¼©æ”¾å› å­
        val scaleFactor = when (screenSizeType) {
            ScreenSizeType.COMPACT -> 0.85f
            ScreenSizeType.MEDIUM -> 1.0f
            ScreenSizeType.EXPANDED -> 1.1f
            ScreenSizeType.LARGE -> 1.2f
        }
        
        // è¿”å›ç¼©æ”¾åçš„å°ºå¯¸æ•°æ®
        AdaptiveDimensionsData(...)
    }
}
```

### 1.3 æ­£å¸¸æµç¨‹

1. **åº”ç”¨å¯åŠ¨** â†’ EmpathyTheme åŒ…è£… ProvideAdaptiveDimensions
2. **å±å¹•é…ç½®è¯»å–** â†’ LocalConfiguration è·å– screenWidthDpã€fontScale
3. **å°ºå¯¸è®¡ç®—** â†’ æ ¹æ®å±å¹•å®½åº¦ç¡®å®š scaleFactor
4. **ç»„ä»¶æ¸²æŸ“** â†’ ä½¿ç”¨ `dimensions.spacingMedium` ç­‰å“åº”å¼å€¼
5. **å­—ä½“æ¸²æŸ“** â†’ ä½¿ç”¨å›ºå®š `sp` å€¼ï¼ˆå¦‚ `17.sp`ï¼‰

### 1.4 é—®é¢˜å…³é”®ç‚¹

**å½“å‰ç³»ç»Ÿçš„è®¾è®¡ç¼ºé™·**ï¼š
- âœ… é—´è·ã€å›¾æ ‡ã€ç»„ä»¶å°ºå¯¸å·²å®ç°å“åº”å¼ï¼ˆä½¿ç”¨ `scaleFactor`ï¼‰
- âŒ **å­—ä½“å¤§å°ä»ä½¿ç”¨å›ºå®š `sp` å€¼**ï¼Œæœªè€ƒè™‘ `fontScale` å’Œå±å¹•å¯†åº¦
- âŒ **æœªè€ƒè™‘ç³»ç»Ÿå­—ä½“ç¼©æ”¾è®¾ç½®**ï¼ˆç”¨æˆ·åœ¨ç³»ç»Ÿè®¾ç½®ä¸­è°ƒå¤§å­—ä½“ï¼‰
- âŒ **æœªè€ƒè™‘é«˜å¯†åº¦å±å¹•**ï¼ˆå¦‚ 500dpi è®¾å¤‡ï¼‰

---

## ğŸŒ³ äºŒã€æ½œåœ¨æ ¹å› æ ‘ï¼ˆRoot Cause Treeï¼‰- æ·±åº¦æ‰©å±•ç‰ˆ

### 2.1 BUG-36-01: çœŸæœºåº•éƒ¨ç•Œé¢å­—ä½“æ˜¾ç¤ºä¸å®Œæ•´

```
æ ¹å› æ ‘ï¼ˆæ·±åº¦æ‰©å±•ï¼‰
â”œâ”€â”€ æ¡†æ¶æœºåˆ¶å±‚
â”‚   â”œâ”€â”€ [R1] AdaptiveDimensions æœªåŒ…å«å“åº”å¼å­—ä½“å°ºå¯¸
â”‚   â”œâ”€â”€ [R2] fontScale å‚æ•°æœªè¢«å®é™…ä½¿ç”¨ï¼ˆä»…å­˜å‚¨ï¼Œæœªåº”ç”¨ï¼‰
â”‚   â”œâ”€â”€ [R3] é«˜å¯†åº¦å±å¹•ï¼ˆ>400dpiï¼‰çš„ dp è½¬æ¢å¯¼è‡´å®é™…åƒç´ è¿‡å°
â”‚   â””â”€â”€ [R4] sp å•ä½åœ¨ä¸åŒ density ä¸‹çš„æ¸²æŸ“å·®å¼‚
â”‚
â”œâ”€â”€ æ¨¡å—è¡Œä¸ºå±‚
â”‚   â”œâ”€â”€ [R5] IOSNavigationBar ä½¿ç”¨å›ºå®š 17.sp å­—ä½“
â”‚   â”œâ”€â”€ [R6] IOSSettingsItem ä½¿ç”¨å›ºå®š 16.sp/14.sp å­—ä½“
â”‚   â”œâ”€â”€ [R7] åº•éƒ¨ç»„ä»¶é«˜åº¦å›ºå®šï¼Œå­—ä½“è¿‡å¤§æ—¶è¢«è£å‰ª
â”‚   â””â”€â”€ [R8] ç»„ä»¶æœªè®¾ç½® minHeight/maxHeight è¾¹ç•Œä¿æŠ¤
â”‚
â”œâ”€â”€ ä½¿ç”¨æ–¹å¼å±‚
â”‚   â”œâ”€â”€ [R9] ç»„ä»¶æœªä½¿ç”¨ dimensions.fontScale è°ƒæ•´å­—ä½“
â”‚   â”œâ”€â”€ [R10] æœªè®¾ç½® minHeight ä¿æŠ¤ï¼Œå¯¼è‡´å†…å®¹æº¢å‡º
â”‚   â””â”€â”€ [R11] æœªå®ç°å­—ä½“ç¼©æ”¾è¾¹ç•Œé™åˆ¶ï¼ˆå¦‚æœ€å¤§200%ï¼‰
â”‚
â”œâ”€â”€ ç¯å¢ƒå±‚
â”‚   â”œâ”€â”€ [R12] çœŸæœºå±å¹•å¯†åº¦ä¸æ¨¡æ‹Ÿå™¨å·®å¼‚å¤§
â”‚   â”œâ”€â”€ [R13] ç”¨æˆ·ç³»ç»Ÿå­—ä½“ç¼©æ”¾è®¾ç½®ï¼ˆå¦‚è€å¹´æ¨¡å¼ã€200%ç¼©æ”¾ï¼‰
â”‚   â””â”€â”€ [R14] ä¸åŒå‚å•†ROMçš„å­—ä½“æ¸²æŸ“å·®å¼‚
â”‚
â””â”€â”€ ğŸ†• å­—ä½“æ¸²æŸ“å¼•æ“å·®å¼‚å±‚ï¼ˆæ·±åº¦è¡¥å……ï¼‰
    â”œâ”€â”€ [R15] MIUI/HyperOS å­—ä½“æ¸²æŸ“å¼•æ“
    â”‚   â”œâ”€â”€ å°ç±³è‡ªå®šä¹‰å­—ä½“æ¸²æŸ“ç®¡çº¿
    â”‚   â”œâ”€â”€ åŠ¨æ€å­—ä½“ç¼©æ”¾ç®—æ³•å·®å¼‚
    â”‚   â””â”€â”€ ç³»ç»Ÿçº§å­—ä½“æ›¿æ¢æœºåˆ¶
    â”œâ”€â”€ [R16] EMUI/HarmonyOS å­—ä½“æ¸²æŸ“å¼•æ“
    â”‚   â”œâ”€â”€ åä¸ºè‡ªå®šä¹‰å­—ä½“å¼•æ“
    â”‚   â”œâ”€â”€ å­—ä½“æŠ—é”¯é½¿ç®—æ³•å·®å¼‚
    â”‚   â””â”€â”€ é«˜åˆ†è¾¨ç‡å±å¹•ä¼˜åŒ–ç­–ç•¥
    â”œâ”€â”€ [R17] ColorOS/realme UI å­—ä½“æ¸²æŸ“å¼•æ“
    â”‚   â”œâ”€â”€ OPPO å­—ä½“æ¸²æŸ“ä¼˜åŒ–
    â”‚   â””â”€â”€ å­—ä½“ç²—ç»†æ¸²æŸ“å·®å¼‚
    â”œâ”€â”€ [R18] One UI (Samsung) å­—ä½“æ¸²æŸ“å¼•æ“
    â”‚   â”œâ”€â”€ ä¸‰æ˜Ÿè‡ªå®šä¹‰å­—ä½“å¼•æ“
    â”‚   â””â”€â”€ é«˜åˆ·æ–°ç‡å±å¹•å­—ä½“ä¼˜åŒ–
    â””â”€â”€ [R19] åŸç”Ÿ Android (AOSP) å­—ä½“æ¸²æŸ“
        â”œâ”€â”€ Skia å­—ä½“æ¸²æŸ“å¼•æ“
        â””â”€â”€ æ ‡å‡† sp åˆ° px è½¬æ¢
```

### 2.1.1 ğŸ†• ç³»ç»Ÿå­—ä½“ç¼©æ”¾è¾¹ç•Œæƒ…å†µåˆ†æ

```
å­—ä½“ç¼©æ”¾è¾¹ç•Œé—®é¢˜
â”œâ”€â”€ è¶…å¤§å­—ä½“åœºæ™¯ï¼ˆfontScale > 1.5ï¼‰
â”‚   â”œâ”€â”€ é—®é¢˜ï¼šå­—ä½“è¶…å‡ºå®¹å™¨è¾¹ç•Œ
â”‚   â”œâ”€â”€ é—®é¢˜ï¼šå¸ƒå±€æº¢å‡ºå¯¼è‡´å†…å®¹è£å‰ª
â”‚   â””â”€â”€ é—®é¢˜ï¼šæŒ‰é’®æ–‡å­—æ¢è¡Œæˆ–æˆªæ–­
â”‚
â”œâ”€â”€ è¶…å°å­—ä½“åœºæ™¯ï¼ˆfontScale < 0.85ï¼‰
â”‚   â”œâ”€â”€ é—®é¢˜ï¼šå­—ä½“è¿‡å°éš¾ä»¥é˜…è¯»
â”‚   â””â”€â”€ é—®é¢˜ï¼šè§¦æ‘¸ç›®æ ‡è¿‡å°
â”‚
â”œâ”€â”€ é«˜å¯†åº¦å±å¹•åœºæ™¯ï¼ˆdensity > 3.0ï¼Œå³ >480dpiï¼‰
â”‚   â”œâ”€â”€ é—®é¢˜ï¼šdp è½¬ px åå®é™…åƒç´ è¿‡å°
â”‚   â”œâ”€â”€ é—®é¢˜ï¼šå­—ä½“æ¸²æŸ“æ¨¡ç³Š
â”‚   â””â”€â”€ é—®é¢˜ï¼šæŠ—é”¯é½¿æ•ˆæœå·®å¼‚
â”‚
â””â”€â”€ ä½å¯†åº¦å±å¹•åœºæ™¯ï¼ˆdensity < 1.5ï¼‰
    â”œâ”€â”€ é—®é¢˜ï¼šå­—ä½“è¿‡å¤§
    â””â”€â”€ é—®é¢˜ï¼šå¸ƒå±€æ‹¥æŒ¤
```

### 2.1.2 ğŸ†• é«˜å¯†åº¦å±å¹•ç‰¹æ®Šå¤„ç†åˆ†æ

| å±å¹•å¯†åº¦ | DPIèŒƒå›´ | densityå€¼ | å…¸å‹è®¾å¤‡ | æ½œåœ¨é—®é¢˜ |
|----------|---------|-----------|----------|----------|
| mdpi | 120-160 | 1.0 | è€æ—§è®¾å¤‡ | å­—ä½“è¿‡å¤§ |
| hdpi | 160-240 | 1.5 | å…¥é—¨æœºå‹ | åŸºå‡†å‚è€ƒ |
| xhdpi | 240-320 | 2.0 | ä¸»æµæœºå‹ | æ­£å¸¸ |
| xxhdpi | 320-480 | 3.0 | æ——èˆ°æœºå‹ | è½»å¾®å·®å¼‚ |
| xxxhdpi | 480-640 | 4.0 | é«˜ç«¯æ——èˆ° | **æ˜æ˜¾å·®å¼‚** |
| è¶…é«˜å¯†åº¦ | >640 | >4.0 | æŠ˜å å±ç­‰ | **ä¸¥é‡é—®é¢˜** |

### 2.2 BUG-36-02: å¯¼èˆªæ å­—ä½“è¿‡å¤§

```
æ ¹å› æ ‘
â”œâ”€â”€ æ¡†æ¶æœºåˆ¶å±‚
â”‚   â””â”€â”€ [R1] IOSNavigationBar é«˜åº¦ä½¿ç”¨å“åº”å¼ï¼Œä½†å­—ä½“æœªå“åº”å¼
â”‚
â”œâ”€â”€ æ¨¡å—è¡Œä¸ºå±‚
â”‚   â”œâ”€â”€ [R2] navBarHeight = dimensions.iosNavigationBarHeight + dimensions.spacingSmall
â”‚   â”‚       â†’ é«˜åº¦ä¼šç¼©æ”¾ï¼Œä½†å­—ä½“ 17.sp ä¸å˜
â”‚   â””â”€â”€ [R3] TextButton å†…éƒ¨ Text ä½¿ç”¨å›ºå®š fontSize
â”‚
â””â”€â”€ ä½¿ç”¨æ–¹å¼å±‚
    â””â”€â”€ [R4] æœªæ ¹æ® navBarHeight åŠ¨æ€è®¡ç®—åˆé€‚çš„å­—ä½“å¤§å°
```

### 2.3 BUG-36-03: æƒé™å¯¹è¯æ¡†æ—§ç‰ˆé£æ ¼

```
æ ¹å› æ ‘ï¼ˆæ·±åº¦æ‰©å±•ï¼‰
â”œâ”€â”€ æ¡†æ¶æœºåˆ¶å±‚
â”‚   â”œâ”€â”€ [R1] PermissionRequestDialog ä½¿ç”¨ Material3 AlertDialog
â”‚   â””â”€â”€ [R2] é¡¹ç›®å­˜åœ¨ä¸¤å¥—è®¾è®¡ç³»ç»Ÿå…±å­˜é—®é¢˜
â”‚
â”œâ”€â”€ ğŸ†• è®¾è®¡ç³»ç»Ÿä¸€è‡´æ€§é—®é¢˜ï¼ˆæ·±åº¦è¡¥å……ï¼‰
â”‚   â”œâ”€â”€ [R3] iOS é£æ ¼ä¸ Material3 æ··ç”¨
â”‚   â”‚   â”œâ”€â”€ éƒ¨åˆ†ç»„ä»¶ä½¿ç”¨ iOS é£æ ¼ï¼ˆIOSNavigationBar ç­‰ï¼‰
â”‚   â”‚   â”œâ”€â”€ éƒ¨åˆ†ç»„ä»¶ä½¿ç”¨ Material3ï¼ˆAlertDialog ç­‰ï¼‰
â”‚   â”‚   â””â”€â”€ è§†è§‰é£æ ¼ä¸ç»Ÿä¸€ï¼Œç”¨æˆ·ä½“éªŒå‰²è£‚
â”‚   â”œâ”€â”€ [R4] ä¸»é¢˜ç³»ç»Ÿå†²çª
â”‚   â”‚   â”œâ”€â”€ MaterialTheme æä¾› Material3 é»˜è®¤æ ·å¼
â”‚   â”‚   â”œâ”€â”€ è‡ªå®šä¹‰ iOS é¢œè‰²ä¸ Material3 é¢œè‰²å†²çª
â”‚   â”‚   â””â”€â”€ ç»„ä»¶é»˜è®¤è¡Œä¸ºä¸ iOS é£æ ¼ä¸ä¸€è‡´
â”‚   â””â”€â”€ [R5] ç»„ä»¶è¿ç§»ä¸å®Œæ•´
â”‚       â”œâ”€â”€ PRD-00021 æœªè¦†ç›–æ‰€æœ‰å¯¹è¯æ¡†
â”‚       â”œâ”€â”€ ç¼ºå°‘ç»Ÿä¸€çš„ iOS é£æ ¼å¯¹è¯æ¡†ç»„ä»¶
â”‚       â””â”€â”€ è¿ç§»æ¸…å•ä¸å®Œæ•´
â”‚
â”œâ”€â”€ æ¨¡å—è¡Œä¸ºå±‚
â”‚   â”œâ”€â”€ [R6] å…¶ä»–å¯¹è¯æ¡†ï¼ˆå¦‚ DeleteConfirmDialogï¼‰ä¹Ÿä½¿ç”¨ AlertDialog
â”‚   â”œâ”€â”€ [R7] é¡¹ç›®æœªå®šä¹‰ç»Ÿä¸€çš„ iOS é£æ ¼å¯¹è¯æ¡†ç»„ä»¶
â”‚   â””â”€â”€ [R8] å¯¹è¯æ¡†ç»„ä»¶åˆ†æ•£åœ¨å¤šä¸ªæ–‡ä»¶ä¸­
â”‚
â””â”€â”€ ä½¿ç”¨æ–¹å¼å±‚
    â”œâ”€â”€ [R9] PRD-00021 UIä¼˜åŒ–æœªè¦†ç›–å¯¹è¯æ¡†ç»„ä»¶
    â””â”€â”€ [R10] ç¼ºå°‘è®¾è®¡ç³»ç»Ÿä¸€è‡´æ€§æ£€æŸ¥æœºåˆ¶
```

### 2.3.1 ğŸ†• ç»„ä»¶è¿ç§»å®Œæ•´æ€§æ£€æŸ¥

| ç»„ä»¶ç±»å‹ | ç»„ä»¶åç§° | å½“å‰é£æ ¼ | ç›®æ ‡é£æ ¼ | è¿ç§»çŠ¶æ€ |
|----------|----------|----------|----------|----------|
| å¯¹è¯æ¡† | PermissionRequestDialog | Material3 | iOS | âŒ å¾…è¿ç§» |
| å¯¹è¯æ¡† | DeleteConfirmDialog | Material3 | iOS | âŒ å¾…è¿ç§» |
| å¯¹è¯æ¡† | DeleteTagConfirmDialog | Material3 | iOS | âŒ å¾…è¿ç§» |
| å¯¹è¯æ¡† | AddTagDialog | Material3 | iOS | âŒ å¾…è¿ç§» |
| å¯¹è¯æ¡† | EditFactDialog | Material3 | iOS | âŒ å¾…è¿ç§» |
| å¯¹è¯æ¡† | EditConversationDialog | Material3 | iOS | âŒ å¾…è¿ç§» |
| å¯¹è¯æ¡† | EditSummaryDialog | Material3 | iOS | âŒ å¾…è¿ç§» |
| å¯¹è¯æ¡† | TagConfirmationDialog | Material3 | iOS | âŒ å¾…è¿ç§» |
| å¯¹è¯æ¡† | ProviderFormDialog | Material3 | iOS | âŒ å¾…è¿ç§» |
| åº•éƒ¨å¼¹çª— | IOSAddFactBottomSheet | iOS | iOS | âœ… å·²å®Œæˆ |

### 2.3.2 ğŸ†• è®¾è®¡ç³»ç»Ÿå†²çªåˆ†æ

```
è®¾è®¡ç³»ç»Ÿå†²çªç‚¹
â”œâ”€â”€ é¢œè‰²ç³»ç»Ÿå†²çª
â”‚   â”œâ”€â”€ Material3: colorScheme.primary, secondary, surface...
â”‚   â”œâ”€â”€ iOSé£æ ¼: iOSBlue, iOSRed, iOSBackground...
â”‚   â””â”€â”€ å†²çª: åŒä¸€ç•Œé¢å¯èƒ½æ··ç”¨ä¸¤å¥—é¢œè‰²
â”‚
â”œâ”€â”€ åœ†è§’ç³»ç»Ÿå†²çª
â”‚   â”œâ”€â”€ Material3: RoundedCornerShape(8.dp) ç­‰å›ºå®šå€¼
â”‚   â”œâ”€â”€ iOSé£æ ¼: dimensions.cornerRadiusMedium å“åº”å¼
â”‚   â””â”€â”€ å†²çª: åœ†è§’å¤§å°ä¸ä¸€è‡´
â”‚
â”œâ”€â”€ å­—ä½“ç³»ç»Ÿå†²çª
â”‚   â”œâ”€â”€ Material3: MaterialTheme.typography
â”‚   â”œâ”€â”€ iOSé£æ ¼: å›ºå®š sp å€¼æˆ–å“åº”å¼å­—ä½“
â”‚   â””â”€â”€ å†²çª: å­—ä½“å¤§å°å’Œç²—ç»†ä¸ä¸€è‡´
â”‚
â””â”€â”€ äº¤äº’æ¨¡å¼å†²çª
    â”œâ”€â”€ Material3: æ¶Ÿæ¼ªæ•ˆæœã€elevation é˜´å½±
    â”œâ”€â”€ iOSé£æ ¼: é«˜äº®æ•ˆæœã€æ‰å¹³åŒ–è®¾è®¡
    â””â”€â”€ å†²çª: ç‚¹å‡»åé¦ˆä¸ä¸€è‡´
```

### 2.4 BUG-36-04: PersonaTab æ·»åŠ æ ‡ç­¾åè‡ªåŠ¨åˆ·æ–°å›åˆ°ç½®é¡¶

```
æ ¹å› æ ‘ï¼ˆæ·±åº¦æ‰©å±•ï¼‰
â”œâ”€â”€ æ¡†æ¶æœºåˆ¶å±‚
â”‚   â”œâ”€â”€ [R1] LazyColumn çš„ state åœ¨æ•°æ®å˜åŒ–æ—¶å¯èƒ½é‡ç½®
â”‚   â”œâ”€â”€ [R2] remember(facts, searchQuery) å¯¼è‡´ groupedFacts é‡æ–°è®¡ç®—
â”‚   â””â”€â”€ [R3] Compose é‡ç»„æœºåˆ¶è§¦å‘æ•´ä¸ªåˆ—è¡¨é‡å»º
â”‚
â”œâ”€â”€ ğŸ†• Compose é‡ç»„æœºåˆ¶é—®é¢˜ï¼ˆæ·±åº¦è¡¥å……ï¼‰
â”‚   â”œâ”€â”€ [R4] é‡ç»„èŒƒå›´è¿‡å¤§
â”‚   â”‚   â”œâ”€â”€ çˆ¶ç»„ä»¶çŠ¶æ€å˜åŒ–å¯¼è‡´å­ç»„ä»¶å…¨éƒ¨é‡ç»„
â”‚   â”‚   â”œâ”€â”€ æœªä½¿ç”¨ key å‚æ•°å¯¼è‡´ item èº«ä»½ä¸¢å¤±
â”‚   â”‚   â””â”€â”€ derivedStateOf è®¡ç®—ç»“æœå˜åŒ–è§¦å‘é‡ç»„
â”‚   â”œâ”€â”€ [R5] çŠ¶æ€ä¸ç¨³å®šå¯¼è‡´é‡ç»„
â”‚   â”‚   â”œâ”€â”€ remember çš„ key å‚æ•°ä¸ç¨³å®š
â”‚   â”‚   â”œâ”€â”€ åˆ—è¡¨æ•°æ®å¼•ç”¨å˜åŒ–ï¼ˆå³ä½¿å†…å®¹ç›¸åŒï¼‰
â”‚   â”‚   â””â”€â”€ ViewModel çŠ¶æ€æ›´æ–°æ–¹å¼ä¸å½“
â”‚   â””â”€â”€ [R6] key ç­–ç•¥ä¸å½“å¯¼è‡´é‡ç»„
â”‚       â”œâ”€â”€ ä½¿ç”¨ç´¢å¼•ä½œä¸º keyï¼ˆæ•°æ®å˜åŒ–æ—¶ key å˜åŒ–ï¼‰
â”‚       â”œâ”€â”€ key ä¸å”¯ä¸€å¯¼è‡´å†²çª
â”‚       â””â”€â”€ key è®¡ç®—å¼€é”€è¿‡å¤§
â”‚
â”œâ”€â”€ æ¨¡å—è¡Œä¸ºå±‚
â”‚   â”œâ”€â”€ [R7] æ·»åŠ æ ‡ç­¾ â†’ facts åˆ—è¡¨å˜åŒ– â†’ è§¦å‘é‡ç»„
â”‚   â”œâ”€â”€ [R8] groupedFacts é‡æ–°åˆ†ç»„ â†’ item key å¯èƒ½å˜åŒ–
â”‚   â”œâ”€â”€ [R9] expandedCategories çŠ¶æ€å¯èƒ½è¢«é‡ç½®
â”‚   â””â”€â”€ [R10] toSortedMap() æ”¹å˜åˆ†ç±»é¡ºåº
â”‚
â”œâ”€â”€ ä½¿ç”¨æ–¹å¼å±‚
â”‚   â”œâ”€â”€ [R11] listState æœªæ­£ç¡®ä¿æŒæ»šåŠ¨ä½ç½®
â”‚   â”œâ”€â”€ [R12] æ·»åŠ æ“ä½œåæœªæ¢å¤ä¹‹å‰çš„æ»šåŠ¨ä½ç½®
â”‚   â””â”€â”€ [R13] æœªä½¿ç”¨ rememberSaveable æŒä¹…åŒ–æ»šåŠ¨çŠ¶æ€
â”‚
â”œâ”€â”€ ğŸ†• æ€§èƒ½å½±å“å±‚ï¼ˆæ·±åº¦è¡¥å……ï¼‰
â”‚   â”œâ”€â”€ [R14] æ»šåŠ¨ä½ç½®ä¿å­˜/æ¢å¤çš„æ€§èƒ½å¼€é”€
â”‚   â”‚   â”œâ”€â”€ é¢‘ç¹çš„ LaunchedEffect è§¦å‘
â”‚   â”‚   â”œâ”€â”€ scrollToItem çš„åŠ¨ç”»å¼€é”€
â”‚   â”‚   â””â”€â”€ çŠ¶æ€åºåˆ—åŒ–/ååºåˆ—åŒ–å¼€é”€
â”‚   â”œâ”€â”€ [R15] é‡ç»„å¯¼è‡´çš„æ€§èƒ½é—®é¢˜
â”‚   â”‚   â”œâ”€â”€ å¤§é‡ item é‡æ–°æµ‹é‡å’Œå¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ å†…å­˜åˆ†é…å’Œ GC å‹åŠ›
â”‚   â”‚   â””â”€â”€ ä¸»çº¿ç¨‹é˜»å¡å¯¼è‡´å¡é¡¿
â”‚   â””â”€â”€ [R16] çŠ¶æ€ç®¡ç†çš„å†…å­˜å¼€é”€
â”‚       â”œâ”€â”€ rememberSaveable çš„åºåˆ—åŒ–å¼€é”€
â”‚       â””â”€â”€ å¤šå±‚çŠ¶æ€åµŒå¥—çš„å†…å­˜å ç”¨
â”‚
â””â”€â”€ ç¯å¢ƒå±‚
    â”œâ”€â”€ [R17] ViewModel çŠ¶æ€æ›´æ–°è§¦å‘æ•´ä¸ª Tab é‡ç»„
    â””â”€â”€ [R18] é…ç½®å˜æ›´ï¼ˆå¦‚æ—‹è½¬å±å¹•ï¼‰å¯¼è‡´çŠ¶æ€ä¸¢å¤±
```

### 2.4.1 ğŸ†• Compose é‡ç»„æœºåˆ¶æ·±åº¦åˆ†æ

```
Compose é‡ç»„è§¦å‘é“¾è·¯
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ç”¨æˆ·æ·»åŠ æ ‡ç­¾                                                 â”‚
â”‚     â†“                                                           â”‚
â”‚  2. ViewModel.addFact() æ›´æ–° _uiState                           â”‚
â”‚     â†“                                                           â”‚
â”‚  3. StateFlow å‘å°„æ–°å€¼                                          â”‚
â”‚     â†“                                                           â”‚
â”‚  4. collectAsStateWithLifecycle() è§¦å‘é‡ç»„                      â”‚
â”‚     â†“                                                           â”‚
â”‚  5. ContactDetailTabScreen é‡ç»„                                 â”‚
â”‚     â†“                                                           â”‚
â”‚  6. PersonaTab é‡ç»„ï¼ˆfacts å‚æ•°å˜åŒ–ï¼‰                           â”‚
â”‚     â†“                                                           â”‚
â”‚  7. remember(facts, searchQuery) é‡æ–°è®¡ç®— groupedFacts          â”‚
â”‚     â†“                                                           â”‚
â”‚  8. LazyColumn æ£€æµ‹åˆ° items å˜åŒ–                                â”‚
â”‚     â†“                                                           â”‚
â”‚  9. âš ï¸ æ»šåŠ¨ä½ç½®å¯èƒ½é‡ç½®                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4.2 ğŸ†• rememberSaveable åœ¨é…ç½®å˜æ›´æ—¶çš„è¡Œä¸ºåˆ†æ

| åœºæ™¯ | remember | rememberSaveable | æ¨èæ–¹æ¡ˆ |
|------|----------|------------------|----------|
| æ™®é€šé‡ç»„ | âœ… ä¿æŒ | âœ… ä¿æŒ | remember |
| é…ç½®å˜æ›´ï¼ˆæ—‹è½¬ï¼‰ | âŒ ä¸¢å¤± | âœ… ä¿æŒ | rememberSaveable |
| è¿›ç¨‹é‡å»º | âŒ ä¸¢å¤± | âœ… ä¿æŒ | rememberSaveable |
| å¯¼èˆªè¿”å› | âŒ ä¸¢å¤± | âš ï¸ å–å†³äºå®ç° | ViewModel |
| æ•°æ®å˜åŒ–é‡ç»„ | âœ… ä¿æŒ | âœ… ä¿æŒ | remember + ç¨³å®š key |

### 2.5 BUG-36-05: PersonaTab é‡ç½®åŠŸèƒ½æ— æ•ˆ

```
æ ¹å› æ ‘
â”œâ”€â”€ æ¡†æ¶æœºåˆ¶å±‚
â”‚   â””â”€â”€ [R1] é‡ç½®äº‹ä»¶æœªæ­£ç¡®ä¼ é€’åˆ° ViewModel
â”‚
â”œâ”€â”€ æ¨¡å—è¡Œä¸ºå±‚
â”‚   â”œâ”€â”€ [R2] é‡ç½®æŒ‰é’®çš„ onClick å›è°ƒæœªå®ç°
â”‚   â””â”€â”€ [R3] ViewModel ä¸­ç¼ºå°‘é‡ç½®é€»è¾‘
â”‚
â””â”€â”€ ä½¿ç”¨æ–¹å¼å±‚
    â””â”€â”€ [R4] UI å±‚æœªæ­£ç¡®è°ƒç”¨é‡ç½®äº‹ä»¶
```

---

## ğŸ†• 2.6 å“åº”å¼ç³»ç»Ÿæ€§èƒ½å½±å“åˆ†æ

### 2.6.1 AdaptiveDimensions è®¡ç®—å¼€é”€åˆ†æ

```
æ€§èƒ½å½±å“è¯„ä¼°
â”œâ”€â”€ è®¡ç®—å¼€é”€
â”‚   â”œâ”€â”€ rememberAdaptiveDimensions() è®¡ç®—å¤æ‚åº¦: O(1)
â”‚   â”œâ”€â”€ æ¯æ¬¡é‡ç»„æ—¶çš„è®¡ç®—: ä»…åœ¨ Configuration å˜åŒ–æ—¶é‡æ–°è®¡ç®—
â”‚   â”œâ”€â”€ remember ç¼“å­˜æœºåˆ¶: æœ‰æ•ˆé¿å…é‡å¤è®¡ç®—
â”‚   â””â”€â”€ å®é™…å¼€é”€: çº¦ 0.1msï¼ˆå¯å¿½ç•¥ï¼‰
â”‚
â”œâ”€â”€ å†…å­˜ä½¿ç”¨
â”‚   â”œâ”€â”€ AdaptiveDimensionsData å¯¹è±¡å¤§å°: çº¦ 200 bytes
â”‚   â”œâ”€â”€ CompositionLocal ä¼ æ’­: å¼•ç”¨ä¼ é€’ï¼Œæ— é¢å¤–å†…å­˜
â”‚   â”œâ”€â”€ å¤šç»„ä»¶å…±äº«: å•ä¾‹æ¨¡å¼ï¼Œå†…å­˜å ç”¨å›ºå®š
â”‚   â””â”€â”€ å®é™…å½±å“: å¯å¿½ç•¥
â”‚
â”œâ”€â”€ é‡ç»„å½±å“
â”‚   â”œâ”€â”€ Configuration å˜åŒ–é¢‘ç‡: æä½ï¼ˆä»…æ—‹è½¬å±å¹•ã€å­—ä½“è®¾ç½®å˜åŒ–ï¼‰
â”‚   â”œâ”€â”€ é‡ç»„èŒƒå›´: ä½¿ç”¨ AdaptiveDimensions.current çš„ç»„ä»¶
â”‚   â”œâ”€â”€ ä¼˜åŒ–ç­–ç•¥: ä½¿ç”¨ derivedStateOf å‡å°‘ä¸å¿…è¦é‡ç»„
â”‚   â””â”€â”€ å®é™…å½±å“: æ­£å¸¸ä½¿ç”¨ä¸‹å¯å¿½ç•¥
â”‚
â””â”€â”€ ç”µæ± å½±å“
    â”œâ”€â”€ è®¡ç®—é¢‘ç‡: æä½
    â”œâ”€â”€ CPU å ç”¨: å¯å¿½ç•¥
    â””â”€â”€ å®é™…å½±å“: æ— æ˜æ˜¾å½±å“
```

### 2.6.2 ğŸ†• æ‰©å±•å“åº”å¼å­—ä½“åçš„æ€§èƒ½é¢„ä¼°

| æŒ‡æ ‡ | å½“å‰ç³»ç»Ÿ | æ‰©å±•åé¢„ä¼° | å½±å“è¯„ä¼° |
|------|----------|------------|----------|
| æ•°æ®ç±»å¤§å° | ~200 bytes | ~280 bytes | +40%ï¼Œå¯æ¥å— |
| è®¡ç®—æ—¶é—´ | ~0.1ms | ~0.15ms | +50%ï¼Œå¯å¿½ç•¥ |
| å†…å­˜å ç”¨ | ~200 bytes | ~280 bytes | +40%ï¼Œå¯æ¥å— |
| é‡ç»„é¢‘ç‡ | æä½ | æä½ | æ— å˜åŒ– |
| ç”µæ± å½±å“ | æ—  | æ—  | æ— å˜åŒ– |

### 2.6.3 ğŸ†• æ€§èƒ½ä¼˜åŒ–å»ºè®®

```kotlin
// ä¼˜åŒ–æ–¹æ¡ˆ1: ä½¿ç”¨ derivedStateOf å‡å°‘é‡ç»„
val fontSizeTitle by remember(dimensions) {
    derivedStateOf { dimensions.fontSizeTitle }
}

// ä¼˜åŒ–æ–¹æ¡ˆ2: ä½¿ç”¨ Stable æ³¨è§£æ ‡è®°æ•°æ®ç±»
@Stable
data class AdaptiveDimensionsData(...)

// ä¼˜åŒ–æ–¹æ¡ˆ3: ä½¿ç”¨ ImmutableList é¿å…åˆ—è¡¨é‡ç»„
@Immutable
data class AdaptiveDimensionsData(...)
```

---

## ğŸ” ä¸‰ã€æ’æŸ¥è·¯å¾„ï¼ˆä»æ¡†æ¶åˆ°åº”ç”¨å±‚ï¼‰- æ‰©å±•ç‰ˆ

### 3.1 å­—ä½“æ˜¾ç¤ºé—®é¢˜æ’æŸ¥æ¸…å•

| åºå· | æ’æŸ¥é¡¹ | éªŒè¯æ–¹æ³• | ä¼˜å…ˆçº§ |
|------|--------|----------|--------|
| 1 | æ£€æŸ¥ AdaptiveDimensions æ˜¯å¦åŒ…å«å­—ä½“å°ºå¯¸ | æŸ¥çœ‹ AdaptiveDimensionsData å®šä¹‰ | P0 |
| 2 | æ£€æŸ¥ fontScale æ˜¯å¦è¢«ä½¿ç”¨ | æœç´¢ `fontScale` ä½¿ç”¨ä½ç½® | P0 |
| 3 | æ£€æŸ¥ IOSNavigationBar å­—ä½“å®šä¹‰ | æŸ¥çœ‹ç»„ä»¶æºç  | P0 |
| 4 | æ£€æŸ¥çœŸæœºå±å¹•å¯†åº¦ | æ·»åŠ æ—¥å¿—è¾“å‡º density å€¼ | P1 |
| 5 | æ£€æŸ¥ç³»ç»Ÿå­—ä½“ç¼©æ”¾è®¾ç½® | åœ¨çœŸæœºè®¾ç½®ä¸­æŸ¥çœ‹ | P1 |
| 6 | å¯¹æ¯”æ¨¡æ‹Ÿå™¨ä¸çœŸæœºçš„ Configuration | æ·»åŠ è°ƒè¯•æ—¥å¿— | P1 |

### 3.2 PersonaTab åˆ·æ–°é—®é¢˜æ’æŸ¥æ¸…å•

| åºå· | æ’æŸ¥é¡¹ | éªŒè¯æ–¹æ³• | ä¼˜å…ˆçº§ |
|------|--------|----------|--------|
| 1 | æ£€æŸ¥ listState æ˜¯å¦æ­£ç¡® remember | æŸ¥çœ‹ PersonaTab æºç  | P0 |
| 2 | æ£€æŸ¥ item key æ˜¯å¦ç¨³å®š | æŸ¥çœ‹ LazyColumn item å®šä¹‰ | P0 |
| 3 | æ£€æŸ¥ facts å˜åŒ–æ—¶çš„é‡ç»„èŒƒå›´ | æ·»åŠ  SideEffect æ—¥å¿— | P1 |
| 4 | æ£€æŸ¥ expandedCategories çŠ¶æ€ç®¡ç† | æŸ¥çœ‹çŠ¶æ€å®šä¹‰å’Œæ›´æ–°é€»è¾‘ | P1 |
| 5 | æ£€æŸ¥ ViewModel çŠ¶æ€æ›´æ–°æ–¹å¼ | æŸ¥çœ‹ ContactDetailTabViewModel | P1 |

### 3.3 å¯¹è¯æ¡†é£æ ¼é—®é¢˜æ’æŸ¥æ¸…å•

| åºå· | æ’æŸ¥é¡¹ | éªŒè¯æ–¹æ³• | ä¼˜å…ˆçº§ |
|------|--------|----------|--------|
| 1 | æ£€æŸ¥ PermissionRequestDialog å®ç° | æŸ¥çœ‹ç»„ä»¶æºç  | P0 |
| 2 | æ£€æŸ¥é¡¹ç›®æ˜¯å¦æœ‰ iOS é£æ ¼å¯¹è¯æ¡† | æœç´¢ IOSDialog æˆ–ç±»ä¼¼ç»„ä»¶ | P0 |
| 3 | æ£€æŸ¥ PRD-00021 æ˜¯å¦è¦†ç›–å¯¹è¯æ¡† | æŸ¥çœ‹ PRD æ–‡æ¡£ | P1 |

---

## ğŸ¯ å››ã€æœ€å¯èƒ½çš„æ ¹å› ï¼ˆåŸºäºæœºåˆ¶æ¨ç†ï¼‰

### 4.1 BUG-36-01 & BUG-36-02: å­—ä½“æ˜¾ç¤ºé—®é¢˜

**æœ€å¯èƒ½æ ¹å› **: **AdaptiveDimensions ç³»ç»Ÿæœªå®ç°å“åº”å¼å­—ä½“å°ºå¯¸**

**æ¨ç†è¿‡ç¨‹**:
1. æŸ¥çœ‹ `AdaptiveDimensionsData` å®šä¹‰ï¼Œå‘ç°åªæœ‰ `fontScale: Float` å±æ€§
2. è¯¥å±æ€§ä»…å­˜å‚¨ç³»ç»Ÿå­—ä½“ç¼©æ”¾å€¼ï¼Œä½†**æœªå®šä¹‰å“åº”å¼å­—ä½“å°ºå¯¸**ï¼ˆå¦‚ `fontSizeSmall`ã€`fontSizeMedium`ï¼‰
3. æ‰€æœ‰ç»„ä»¶ï¼ˆå¦‚ `IOSNavigationBar`ï¼‰ä½¿ç”¨å›ºå®š `17.sp`
4. åœ¨é«˜å¯†åº¦å±å¹•æˆ–ç”¨æˆ·å¼€å¯å¤§å­—ä½“æ—¶ï¼Œå›ºå®š sp å€¼æ— æ³•é€‚é…

**è¯æ®**:
```kotlin
// IOSNavigationBar.kt - ä½¿ç”¨å›ºå®šå­—ä½“
Text(
    text = "å–æ¶ˆ",
    fontSize = 17.sp,  // âŒ å›ºå®šå€¼ï¼Œæœªå“åº”å¼
    color = iOSBlue
)

// AdaptiveDimensionsData - ç¼ºå°‘å­—ä½“å°ºå¯¸
data class AdaptiveDimensionsData(
    // ... é—´è·ã€å›¾æ ‡å°ºå¯¸éƒ½æœ‰
    val fontScale: Float  // âš ï¸ ä»…å­˜å‚¨ï¼Œæœªä½¿ç”¨
    // âŒ ç¼ºå°‘: fontSizeSmall, fontSizeMedium, fontSizeLarge ç­‰
)
```

### 4.2 BUG-36-03: æƒé™å¯¹è¯æ¡†æ—§ç‰ˆé£æ ¼

**æœ€å¯èƒ½æ ¹å› **: **PermissionRequestDialog æœªè¿ç§»åˆ° iOS é£æ ¼**

**æ¨ç†è¿‡ç¨‹**:
1. PRD-00022 å“åº”å¼å°ºå¯¸é€‚é…ç³»ç»Ÿå·²å®Œæˆï¼Œä½†ä¸»è¦é’ˆå¯¹å°ºå¯¸
2. PRD-00021 è®¾ç½®ç•Œé¢UIä¼˜åŒ–å¯èƒ½æœªè¦†ç›–å¯¹è¯æ¡†ç»„ä»¶
3. `PermissionRequestDialog` ä»ä½¿ç”¨ Material3 `AlertDialog`
4. é¡¹ç›®ä¸­æœªå®šä¹‰ç»Ÿä¸€çš„ iOS é£æ ¼å¯¹è¯æ¡†ç»„ä»¶

**è¯æ®**:
```kotlin
// PermissionRequestDialog.kt - ä½¿ç”¨ Material3 AlertDialog
AlertDialog(
    onDismissRequest = onDismiss,
    title = { Text(...) },
    text = { Text(...) },
    confirmButton = { TextButton(...) },
    dismissButton = { TextButton(...) }
)
```

### 4.3 BUG-36-04: PersonaTab è‡ªåŠ¨åˆ·æ–°å›åˆ°ç½®é¡¶

**æœ€å¯èƒ½æ ¹å› **: **LazyColumn çš„ key ç­–ç•¥æˆ–çŠ¶æ€ç®¡ç†é—®é¢˜**

**æ¨ç†è¿‡ç¨‹**:
1. æŸ¥çœ‹ `PersonaTab.kt`ï¼Œå‘ç°ä½¿ç”¨äº† `rememberLazyListState()`
2. ä½¿ç”¨äº† `item(key = "category_$category")` ç¨³å®š key
3. ä½† `groupedFacts` ä½¿ç”¨ `derivedStateOf` è®¡ç®—ï¼Œå½“ `facts` å˜åŒ–æ—¶ä¼šé‡æ–°åˆ†ç»„
4. å¦‚æœåˆ†ç»„é¡ºåºå˜åŒ–ï¼ˆå¦‚æ–°å¢åˆ†ç±»ï¼‰ï¼Œå¯èƒ½å¯¼è‡´ LazyColumn é‡æ–°å¸ƒå±€

**å¯èƒ½çš„å…·ä½“åŸå› **:
- æ·»åŠ æ ‡ç­¾åï¼Œ`facts` åˆ—è¡¨å˜åŒ–è§¦å‘ `groupedFacts` é‡æ–°è®¡ç®—
- å¦‚æœæ–°æ ‡ç­¾å±äºæ–°åˆ†ç±»ï¼Œ`toSortedMap()` ä¼šæ”¹å˜åˆ†ç±»é¡ºåº
- LazyColumn æ£€æµ‹åˆ° item é¡ºåºå˜åŒ–ï¼Œå¯èƒ½é‡ç½®æ»šåŠ¨ä½ç½®

**è¯æ®**:
```kotlin
// PersonaTab.kt
val groupedFacts by remember(facts, searchQuery) {
    derivedStateOf {
        // ...
        filtered.groupBy { it.key }.toSortedMap()  // âš ï¸ æ’åºå¯èƒ½æ”¹å˜é¡ºåº
    }
}
```

### 4.4 BUG-36-05: PersonaTab é‡ç½®åŠŸèƒ½æ— æ•ˆ

**æœ€å¯èƒ½æ ¹å› **: **é‡ç½®åŠŸèƒ½æœªå®ç°æˆ–äº‹ä»¶æœªæ­£ç¡®ä¼ é€’**

**æ¨ç†è¿‡ç¨‹**:
1. éœ€è¦ç¡®è®¤"é‡ç½®"æŒ‰é’®çš„å…·ä½“ä½ç½®å’ŒåŠŸèƒ½å®šä¹‰
2. å¯èƒ½æ˜¯ UI å±‚çš„ onClick å›è°ƒæœªå®ç°
3. æˆ–è€… ViewModel ä¸­ç¼ºå°‘å¯¹åº”çš„é‡ç½®é€»è¾‘

---

## ğŸ› ï¸ äº”ã€ç¨³å®šä¿®å¤æ–¹æ¡ˆï¼ˆæ·±åº¦ä¼˜åŒ–ç‰ˆï¼‰

### 5.1 æ–¹æ¡ˆä¸€ï¼šæ‰©å±• AdaptiveDimensions æ”¯æŒå“åº”å¼å­—ä½“ï¼ˆå«è¾¹ç•Œå¤„ç†ï¼‰

**åŸç†**: åœ¨ AdaptiveDimensionsData ä¸­æ·»åŠ å“åº”å¼å­—ä½“å°ºå¯¸ï¼Œå¹¶å¤„ç†è¾¹ç•Œæƒ…å†µ

```kotlin
// AdaptiveDimensions.kt æ‰©å±•ï¼ˆå«è¾¹ç•Œå¤„ç†ï¼‰
@Stable  // æ ‡è®°ä¸ºç¨³å®šï¼Œå‡å°‘ä¸å¿…è¦é‡ç»„
data class AdaptiveDimensionsData(
    // ... ç°æœ‰å±æ€§
    
    // ========== å“åº”å¼å­—ä½“å°ºå¯¸ ==========
    val fontSizeCaption: TextUnit,    // 12sp * scale
    val fontSizeBody: TextUnit,       // 14sp * scale
    val fontSizeSubtitle: TextUnit,   // 16sp * scale
    val fontSizeTitle: TextUnit,      // 17sp * scale (iOSæ ‡å‡†)
    val fontSizeHeadline: TextUnit,   // 20sp * scale
    val fontSizeLargeTitle: TextUnit, // 34sp * scale
)

@Composable
fun rememberAdaptiveDimensions(): AdaptiveDimensionsData {
    val configuration = LocalConfiguration.current
    val density = LocalDensity.current
    
    return remember(configuration.screenWidthDp, configuration.screenHeightDp, configuration.fontScale) {
        // ... ç°æœ‰è®¡ç®—
        
        // ğŸ†• å­—ä½“ç¼©æ”¾è¾¹ç•Œé™åˆ¶ï¼ˆé˜²æ­¢è¶…å¤§/è¶…å°å­—ä½“ï¼‰
        val clampedFontScale = configuration.fontScale.coerceIn(0.85f, 1.5f)
        
        // ğŸ†• é«˜å¯†åº¦å±å¹•è¡¥å¿å› å­
        val densityCompensation = when {
            density.density > 4.0f -> 0.9f   // xxxhdpi ä»¥ä¸Šï¼Œç•¥å¾®ç¼©å°
            density.density > 3.0f -> 0.95f  // xxhdpiï¼Œè½»å¾®ç¼©å°
            density.density < 1.5f -> 1.1f   // hdpi ä»¥ä¸‹ï¼Œç•¥å¾®æ”¾å¤§
            else -> 1.0f
        }
        
        // ğŸ†• ç»¼åˆç¼©æ”¾å› å­ = å±å¹•ç¼©æ”¾ * å­—ä½“ç¼©æ”¾ * å¯†åº¦è¡¥å¿
        val fontScaleFactor = scaleFactor * clampedFontScale * densityCompensation
        
        AdaptiveDimensionsData(
            // ...
            fontSizeCaption = (12 * fontScaleFactor).sp,
            fontSizeBody = (14 * fontScaleFactor).sp,
            fontSizeSubtitle = (16 * fontScaleFactor).sp,
            fontSizeTitle = (17 * fontScaleFactor).sp,
            fontSizeHeadline = (20 * fontScaleFactor).sp,
            fontSizeLargeTitle = (34 * fontScaleFactor).sp,
        )
    }
}
```

### 5.1.1 ğŸ†• ROM å‚å•†å­—ä½“æ¸²æŸ“å·®å¼‚å¤„ç†

```kotlin
// FontRenderingCompat.kt - å­—ä½“æ¸²æŸ“å…¼å®¹å±‚
object FontRenderingCompat {
    
    /**
     * æ£€æµ‹å½“å‰ ROM ç±»å‹
     */
    fun detectRomType(): RomType {
        val manufacturer = Build.MANUFACTURER.lowercase()
        val brand = Build.BRAND.lowercase()
        
        return when {
            manufacturer.contains("xiaomi") || brand.contains("xiaomi") -> RomType.MIUI
            manufacturer.contains("huawei") || brand.contains("huawei") -> RomType.EMUI
            manufacturer.contains("oppo") || brand.contains("oppo") -> RomType.COLOR_OS
            manufacturer.contains("vivo") || brand.contains("vivo") -> RomType.FUNTOUCH_OS
            manufacturer.contains("samsung") || brand.contains("samsung") -> RomType.ONE_UI
            manufacturer.contains("oneplus") || brand.contains("oneplus") -> RomType.OXYGEN_OS
            else -> RomType.AOSP
        }
    }
    
    /**
     * è·å– ROM ç‰¹å®šçš„å­—ä½“ç¼©æ”¾è¡¥å¿
     */
    fun getFontScaleCompensation(romType: RomType): Float {
        return when (romType) {
            RomType.MIUI -> 0.98f      // MIUI å­—ä½“ç•¥å¤§ï¼Œè¡¥å¿ç¼©å°
            RomType.EMUI -> 1.0f       // EMUI æ ‡å‡†
            RomType.COLOR_OS -> 0.99f  // ColorOS ç•¥å¤§
            RomType.ONE_UI -> 1.02f    // One UI ç•¥å°ï¼Œè¡¥å¿æ”¾å¤§
            else -> 1.0f
        }
    }
}

enum class RomType {
    MIUI, EMUI, COLOR_OS, FUNTOUCH_OS, ONE_UI, OXYGEN_OS, AOSP
}
```

### 5.2 æ–¹æ¡ˆäºŒï¼šåˆ›å»º iOS é£æ ¼å¯¹è¯æ¡†ç»„ä»¶ï¼ˆç»Ÿä¸€è®¾è®¡ç³»ç»Ÿï¼‰

**åŸç†**: å®šä¹‰ç»Ÿä¸€çš„ iOS é£æ ¼å¯¹è¯æ¡†ï¼Œæ›¿æ¢æ‰€æœ‰ Material3 AlertDialogï¼Œå¹¶å»ºç«‹è®¾è®¡ç³»ç»Ÿä¸€è‡´æ€§æ£€æŸ¥

```kotlin
// IOSAlertDialog.kt - ç»Ÿä¸€çš„ iOS é£æ ¼å¯¹è¯æ¡†
@Composable
fun IOSAlertDialog(
    title: String,
    message: String,
    confirmText: String = "ç¡®å®š",
    dismissText: String = "å–æ¶ˆ",
    onConfirm: () -> Unit,
    onDismiss: () -> Unit,
    isDestructive: Boolean = false,
    showDismissButton: Boolean = true
) {
    val dimensions = AdaptiveDimensions.current
    
    Dialog(
        onDismissRequest = onDismiss,
        properties = DialogProperties(
            dismissOnBackPress = true,
            dismissOnClickOutside = true,
            usePlatformDefaultWidth = false  // è‡ªå®šä¹‰å®½åº¦
        )
    ) {
        Card(
            modifier = Modifier
                .widthIn(max = 270.dp)  // iOS æ ‡å‡†å¯¹è¯æ¡†å®½åº¦
                .padding(dimensions.spacingMedium),
            shape = RoundedCornerShape(14.dp),  // iOS æ ‡å‡†åœ†è§’
            colors = CardDefaults.cardColors(
                containerColor = Color.White.copy(alpha = 0.95f)
            ),
            elevation = CardDefaults.cardElevation(defaultElevation = 0.dp)
        ) {
            Column(
                modifier = Modifier.fillMaxWidth(),
                horizontalAlignment = Alignment.CenterHorizontally
            ) {
                // å†…å®¹åŒºåŸŸ
                Column(
                    modifier = Modifier.padding(
                        top = dimensions.spacingLarge,
                        start = dimensions.spacingMedium,
                        end = dimensions.spacingMedium,
                        bottom = dimensions.spacingMedium
                    ),
                    horizontalAlignment = Alignment.CenterHorizontally
                ) {
                    // æ ‡é¢˜
                    Text(
                        text = title,
                        fontSize = dimensions.fontSizeTitle,
                        fontWeight = FontWeight.SemiBold,
                        color = Color.Black,
                        textAlign = TextAlign.Center
                    )
                    
                    Spacer(modifier = Modifier.height(dimensions.spacingSmall))
                    
                    // æ¶ˆæ¯
                    Text(
                        text = message,
                        fontSize = dimensions.fontSizeBody,
                        color = Color.Black.copy(alpha = 0.6f),
                        textAlign = TextAlign.Center,
                        lineHeight = 20.sp
                    )
                }
                
                // åˆ†éš”çº¿
                Divider(color = Color.Black.copy(alpha = 0.1f), thickness = 0.5.dp)
                
                // æŒ‰é’®åŒºåŸŸï¼ˆiOSé£æ ¼ï¼šæ°´å¹³æ’åˆ—ï¼Œä¸¤ä¸ªæŒ‰é’®æ—¶ï¼‰
                if (showDismissButton) {
                    Row(modifier = Modifier.fillMaxWidth()) {
                        // å–æ¶ˆæŒ‰é’®
                        TextButton(
                            onClick = onDismiss,
                            modifier = Modifier
                                .weight(1f)
                                .height(44.dp),
                            shape = RectangleShape
                        ) {
                            Text(
                                text = dismissText,
                                fontSize = dimensions.fontSizeTitle,
                                color = iOSBlue
                            )
                        }
                        
                        // å‚ç›´åˆ†éš”çº¿
                        Box(
                            modifier = Modifier
                                .width(0.5.dp)
                                .height(44.dp)
                                .background(Color.Black.copy(alpha = 0.1f))
                        )
                        
                        // ç¡®è®¤æŒ‰é’®
                        TextButton(
                            onClick = onConfirm,
                            modifier = Modifier
                                .weight(1f)
                                .height(44.dp),
                            shape = RectangleShape
                        ) {
                            Text(
                                text = confirmText,
                                fontSize = dimensions.fontSizeTitle,
                                color = if (isDestructive) iOSRed else iOSBlue,
                                fontWeight = if (isDestructive) FontWeight.SemiBold else FontWeight.Normal
                            )
                        }
                    }
                } else {
                    // å•æŒ‰é’®æ¨¡å¼
                    TextButton(
                        onClick = onConfirm,
                        modifier = Modifier
                            .fillMaxWidth()
                            .height(44.dp),
                        shape = RectangleShape
                    ) {
                        Text(
                            text = confirmText,
                            fontSize = dimensions.fontSizeTitle,
                            color = iOSBlue,
                            fontWeight = FontWeight.SemiBold
                        )
                    }
                }
            }
        }
    }
}
```

### 5.2.1 ğŸ†• è®¾è®¡ç³»ç»Ÿä¸€è‡´æ€§æ£€æŸ¥å·¥å…·

```kotlin
// DesignSystemLint.kt - è®¾è®¡ç³»ç»Ÿä¸€è‡´æ€§æ£€æŸ¥ï¼ˆå¼€å‘æ—¶ä½¿ç”¨ï¼‰
object DesignSystemLint {
    
    /**
     * æ£€æŸ¥ç»„ä»¶æ˜¯å¦ä½¿ç”¨äº† Material3 AlertDialog
     * åœ¨ Debug æ¨¡å¼ä¸‹è¾“å‡ºè­¦å‘Š
     */
    @Composable
    fun checkAlertDialogUsage() {
        if (BuildConfig.DEBUG) {
            // é€šè¿‡ Composition æ£€æµ‹ AlertDialog ä½¿ç”¨
            // å®é™…å®ç°éœ€è¦è‡ªå®šä¹‰ Lint è§„åˆ™
        }
    }
    
    /**
     * å¾…è¿ç§»çš„å¯¹è¯æ¡†ç»„ä»¶æ¸…å•
     */
    val pendingMigrationDialogs = listOf(
        "PermissionRequestDialog",
        "DeleteConfirmDialog",
        "DeleteTagConfirmDialog",
        "AddTagDialog",
        "EditFactDialog",
        "EditConversationDialog",
        "EditSummaryDialog",
        "TagConfirmationDialog",
        "ProviderFormDialog"
    )
}
```

### 5.3 æ–¹æ¡ˆä¸‰ï¼šä¿®å¤ PersonaTab æ»šåŠ¨ä½ç½®ä¿æŒï¼ˆæœ€å°åŒ–é‡ç»„ç‰ˆï¼‰

**åŸç†**: ä½¿ç”¨ç¨³å®šçš„ key ç­–ç•¥ + æœ€å°åŒ–é‡ç»„èŒƒå›´ + æ»šåŠ¨ä½ç½®æ¢å¤

```kotlin
// PersonaTab.kt ä¿®å¤ï¼ˆæœ€å°åŒ–é‡ç»„ç‰ˆï¼‰
@Composable
fun PersonaTab(
    facts: List<Fact>,
    onFactClick: (Fact) -> Unit,
    onFactLongClick: (Fact) -> Unit,
    modifier: Modifier = Modifier
) {
    // ğŸ†• ä½¿ç”¨ rememberSaveable ä¿å­˜æ»šåŠ¨ä½ç½®ï¼ˆé…ç½®å˜æ›´æ—¶ä¿æŒï¼‰
    val listState = rememberLazyListState(
        initialFirstVisibleItemIndex = 0,
        initialFirstVisibleItemScrollOffset = 0
    )
    
    // ğŸ†• ä½¿ç”¨ rememberSaveable ä¿å­˜å±•å¼€çŠ¶æ€
    var expandedCategories by rememberSaveable { 
        mutableStateOf<Set<String>>(emptySet()) 
    }
    
    // æœç´¢å…³é”®è¯
    var searchQuery by rememberSaveable { mutableStateOf("") }
    
    // ğŸ†• ä½¿ç”¨ derivedStateOf å‡å°‘é‡ç»„ï¼Œåªæœ‰ç»“æœçœŸæ­£å˜åŒ–æ—¶æ‰è§¦å‘
    val groupedFacts by remember(facts) {
        derivedStateOf {
            val filtered = if (searchQuery.isBlank()) {
                facts
            } else {
                facts.filter { 
                    it.key.contains(searchQuery, ignoreCase = true) ||
                    it.value.contains(searchQuery, ignoreCase = true)
                }
            }
            // ğŸ†• ä½¿ç”¨ LinkedHashMap ä¿æŒæ’å…¥é¡ºåºï¼Œé¿å…æ’åºå¯¼è‡´çš„é¡ºåºå˜åŒ–
            filtered.groupBy { it.key }
        }
    }
    
    // ğŸ†• åˆå§‹åŒ–å±•å¼€çŠ¶æ€ï¼ˆä»…é¦–æ¬¡ï¼‰
    LaunchedEffect(Unit) {
        if (expandedCategories.isEmpty() && facts.isNotEmpty()) {
            expandedCategories = facts.map { it.key }.toSet()
        }
    }
    
    // ğŸ†• ä¿å­˜æ»šåŠ¨ä½ç½®ï¼ˆç”¨äºæ•°æ®å˜åŒ–åæ¢å¤ï¼‰
    var savedScrollIndex by remember { mutableStateOf(0) }
    var savedScrollOffset by remember { mutableStateOf(0) }
    
    // ğŸ†• ç›‘å¬æ»šåŠ¨ä½ç½®å˜åŒ–
    LaunchedEffect(listState.isScrollInProgress) {
        if (!listState.isScrollInProgress) {
            savedScrollIndex = listState.firstVisibleItemIndex
            savedScrollOffset = listState.firstVisibleItemScrollOffset
        }
    }
    
    // ğŸ†• æ•°æ®å˜åŒ–åæ¢å¤æ»šåŠ¨ä½ç½®
    val factsSize = facts.size
    LaunchedEffect(factsSize) {
        if (savedScrollIndex > 0 && factsSize > 0) {
            // å»¶è¿Ÿæ¢å¤ï¼Œç¡®ä¿å¸ƒå±€å®Œæˆ
            kotlinx.coroutines.delay(50)
            listState.scrollToItem(
                index = savedScrollIndex.coerceAtMost(listState.layoutInfo.totalItemsCount - 1),
                scrollOffset = savedScrollOffset
            )
        }
    }
    
    Column(
        modifier = modifier
            .fillMaxSize()
            .background(iOSSystemGroupedBackground)
    ) {
        // é¡¶éƒ¨æœç´¢æ ï¼ˆç‹¬ç«‹é‡ç»„èŒƒå›´ï¼‰
        key("search_bar") {
            ModernFloatingSearchBar(
                query = searchQuery,
                onQueryChange = { searchQuery = it },
                placeholder = "æœç´¢æ ‡ç­¾æˆ–åˆ†ç±»",
                modifier = Modifier.padding(16.dp)
            )
        }
        
        if (facts.isEmpty()) {
            EmptyPersonaView(modifier = Modifier.weight(1f))
        } else if (groupedFacts.isEmpty()) {
            NoSearchResultView(modifier = Modifier.weight(1f))
        } else {
            LazyColumn(
                state = listState,
                modifier = Modifier.weight(1f),
                contentPadding = PaddingValues(horizontal = 16.dp, vertical = 8.dp),
                verticalArrangement = Arrangement.spacedBy(12.dp)
            ) {
                // ğŸ†• ä½¿ç”¨ç¨³å®šçš„ key ç­–ç•¥
                groupedFacts.forEach { (category, categoryFacts) ->
                    item(
                        key = "category_${category.hashCode()}", // ä½¿ç”¨ hashCode ç¡®ä¿ç¨³å®š
                        contentType = "category_card"  // ğŸ†• æŒ‡å®šå†…å®¹ç±»å‹ï¼Œä¼˜åŒ–å¤ç”¨
                    ) {
                        // ğŸ†• ä½¿ç”¨ key åŒ…è£…ï¼Œå‡å°‘ä¸å¿…è¦é‡ç»„
                        key(category) {
                            SimpleCategoryCard(
                                categoryName = category,
                                facts = categoryFacts,
                                isExpanded = category in expandedCategories,
                                onToggle = {
                                    expandedCategories = if (category in expandedCategories) {
                                        expandedCategories - category
                                    } else {
                                        expandedCategories + category
                                    }
                                },
                                onFactClick = onFactClick,
                                onFactLongClick = onFactLongClick
                            )
                        }
                    }
                }
                
                item(key = "bottom_spacer", contentType = "spacer") {
                    Spacer(modifier = Modifier.height(80.dp))
                }
            }
        }
    }
}
```

### 5.3.1 ğŸ†• é‡ç»„èŒƒå›´ä¼˜åŒ–ç­–ç•¥

```kotlin
// ä¼˜åŒ–ç­–ç•¥1: ä½¿ç”¨ key éš”ç¦»é‡ç»„èŒƒå›´
@Composable
fun OptimizedPersonaTab(...) {
    Column {
        // æœç´¢æ ç‹¬ç«‹é‡ç»„
        key("search") {
            SearchBar(...)
        }
        
        // åˆ—è¡¨ç‹¬ç«‹é‡ç»„
        key("list") {
            LazyColumn {
                items(
                    items = facts,
                    key = { it.id },  // ç¨³å®š key
                    contentType = { "fact_item" }  // å†…å®¹ç±»å‹
                ) { fact ->
                    // æ¯ä¸ª item ç‹¬ç«‹é‡ç»„
                    key(fact.id) {
                        FactItem(fact)
                    }
                }
            }
        }
    }
}

// ä¼˜åŒ–ç­–ç•¥2: ä½¿ç”¨ derivedStateOf å‡å°‘è®¡ç®—
val filteredFacts by remember(facts, searchQuery) {
    derivedStateOf {
        // åªæœ‰å½“ facts æˆ– searchQuery å˜åŒ–æ—¶æ‰é‡æ–°è®¡ç®—
        facts.filter { ... }
    }
}

// ä¼˜åŒ–ç­–ç•¥3: ä½¿ç”¨ Stable æ³¨è§£
@Stable
data class FactItemState(
    val fact: Fact,
    val isExpanded: Boolean
)
```

---

## ğŸ“‹ å…­ã€å®æ–½è®¡åˆ’ï¼ˆæ‰©å±•ç‰ˆï¼‰

### Phase 1: å“åº”å¼å­—ä½“ç³»ç»Ÿï¼ˆP0ï¼‰

| ä»»åŠ¡ID | ä»»åŠ¡æè¿° | é¢„è®¡å·¥æ—¶ | çŠ¶æ€ |
|--------|----------|----------|------|
| T1-01 | æ‰©å±• AdaptiveDimensionsData æ·»åŠ å­—ä½“å°ºå¯¸ | 1h | âœ… å·²å®Œæˆ |
| T1-02 | å®ç°å­—ä½“ç¼©æ”¾è¾¹ç•Œé™åˆ¶ï¼ˆ0.85-1.5ï¼‰ | 0.5h | âœ… å·²å®Œæˆ |
| T1-03 | å®ç°é«˜å¯†åº¦å±å¹•è¡¥å¿å› å­ | 0.5h | âœ… å·²å®Œæˆ |
| T1-04 | ğŸ†• å®ç° ROM å‚å•†å­—ä½“æ¸²æŸ“å…¼å®¹å±‚ | 1h | âœ… å·²å®Œæˆ |
| T1-05 | è¿ç§» IOSNavigationBar ä½¿ç”¨å“åº”å¼å­—ä½“ | 0.5h | âœ… å·²å®Œæˆ |
| T1-06 | è¿ç§» IOSSettingsItem ä½¿ç”¨å“åº”å¼å­—ä½“ | 0.5h | âœ… å·²å®Œæˆ |
| T1-07 | è¿ç§» IOSSettingsSection ä½¿ç”¨å“åº”å¼å­—ä½“ | 0.5h | âœ… å·²å®Œæˆ |
| T1-08 | è¿ç§»å…¶ä»– iOS ç»„ä»¶ä½¿ç”¨å“åº”å¼å­—ä½“ | 2h | âœ… å·²å®Œæˆ |
| T1-09 | ğŸ†• æ·»åŠ  @Stable æ³¨è§£ä¼˜åŒ–é‡ç»„ | 0.5h | âœ… å·²å®Œæˆ |
| T1-10 | çœŸæœºæµ‹è¯•éªŒè¯ï¼ˆå¤šè®¾å¤‡ï¼‰ | 2h | ğŸ”² å¾…å¼€å§‹ |

**Phase 1 å·²å®Œæˆç»„ä»¶è¿ç§»æ¸…å•**:
- âœ… AdaptiveDimensions.kt - æ·»åŠ å“åº”å¼å­—ä½“å°ºå¯¸ã€ROMæ£€æµ‹ã€è¾¹ç•Œé™åˆ¶
- âœ… IOSNavigationBar.kt - ä½¿ç”¨ dimensions.fontSizeTitle
- âœ… IOSSettingsItem.kt - ä½¿ç”¨ dimensions.fontSizeTitle/fontSizeCaption
- âœ… IOSSettingsSection.kt - ä½¿ç”¨ dimensions.fontSizeCaption
- âœ… IOSFormField.kt - ä½¿ç”¨ dimensions.fontSizeTitle
- âœ… IOSLargeTitleBar.kt - ä½¿ç”¨ dimensions.fontSizeLargeTitle
- âœ… IOSSearchBar.kt - ä½¿ç”¨ dimensions.fontSizeTitle
- âœ… IOSProviderCard.kt - ä½¿ç”¨ dimensions.fontSizeTitle/fontSizeBody/fontSizeXSmall
- âœ… SettingsScreen.kt - ä½¿ç”¨ dimensions.fontSizeLargeTitle

### Phase 2: iOS é£æ ¼å¯¹è¯æ¡†ï¼ˆP1ï¼‰

| ä»»åŠ¡ID | ä»»åŠ¡æè¿° | é¢„è®¡å·¥æ—¶ | çŠ¶æ€ |
|--------|----------|----------|------|
| T2-01 | åˆ›å»º IOSAlertDialog ç»„ä»¶ | 1h | âœ… å·²å®Œæˆ |
| T2-02 | åˆ›å»º IOSInputDialog ç»„ä»¶ | 0.5h | âœ… å·²å®Œæˆ |
| T2-03 | è¿ç§» PermissionRequestDialog | 0.5h | âœ… å·²å®Œæˆ |
| T2-04 | è¿ç§» DeleteConfirmDialog | 0.5h | âœ… å·²å®Œæˆ |
| T2-05 | è¿ç§» DeleteTagConfirmDialog | 0.5h | âœ… å·²å®Œæˆ |
| T2-06 | è¿ç§» AddTagDialog (dialogç›®å½•) | 0.5h | âœ… å·²å®Œæˆ |
| T2-07 | è¿ç§» AddTagDialog (personaç›®å½•) | 0.5h | âœ… å·²å®Œæˆ |
| T2-08 | è¿ç§» TagConfirmationDialog | 0.5h | âœ… å·²å®Œæˆ |
| T2-09 | è¿ç§» DiscardConfirmDialog | 0.5h | âœ… å·²å®Œæˆ |
| T2-10 | è¿ç§» BatchDeleteConfirmDialog | 0.5h | âœ… å·²å®Œæˆ |
| T2-11 | è¿ç§» EditFactDialog | 0.5h | âœ… å·²å®Œæˆ |
| T2-12 | è¿ç§» EditConversationDialog | 0.5h | âœ… å·²å®Œæˆ |
| T2-13 | è¿ç§» EditSummaryDialog | 0.5h | âœ… å·²å®Œæˆ |
| T2-14 | è¿ç§» UserProfileScreen å¯¹è¯æ¡† (6ä¸ª) | 1h | âœ… å·²å®Œæˆ |
| T2-15 | ğŸ†• åˆ›å»º IOSActionSheet ç»„ä»¶ | 1h | ğŸ”² å¾…å¼€å§‹ |
| T2-16 | ğŸ†• åˆ›å»ºè®¾è®¡ç³»ç»Ÿä¸€è‡´æ€§æ£€æŸ¥å·¥å…· | 1h | ğŸ”² å¾…å¼€å§‹ |

**Phase 2 å·²å®Œæˆç»„ä»¶**:
- âœ… IOSAlertDialog.kt - åˆ›å»ºiOSé£æ ¼å¯¹è¯æ¡†ç»„ä»¶
- âœ… IOSInputDialog - åˆ›å»ºiOSé£æ ¼è¾“å…¥å¯¹è¯æ¡†ç»„ä»¶
- âœ… IOSPermissionRequestDialog - æƒé™è¯·æ±‚å¯¹è¯æ¡†
- âœ… IOSDeleteConfirmDialog - åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†
- âœ… PermissionRequestDialog.kt - è¿ç§»åˆ°ä½¿ç”¨ IOSPermissionRequestDialog
- âœ… DeleteConfirmDialog.kt - è¿ç§»åˆ°ä½¿ç”¨ IOSDeleteConfirmDialog
- âœ… DeleteTagConfirmDialog.kt - è¿ç§»åˆ°ä½¿ç”¨ IOSDeleteConfirmDialog
- âœ… AddTagDialog.kt (dialogç›®å½•) - è¿ç§»åˆ°ä½¿ç”¨ IOSInputDialog
- âœ… AddTagDialog.kt (personaç›®å½•) - æ›´æ–°ä½¿ç”¨å“åº”å¼å­—ä½“
- âœ… TagConfirmationDialog.kt - è¿ç§»åˆ°iOSé£æ ¼
- âœ… DiscardConfirmDialog.kt - è¿ç§»åˆ°ä½¿ç”¨ IOSAlertDialog
- âœ… BatchDeleteConfirmDialog.kt - è¿ç§»åˆ°ä½¿ç”¨ IOSDeleteConfirmDialog
- âœ… SettingsScreen.kt - æ›´æ–°ä½¿ç”¨ IOSPermissionRequestDialog å’Œ IOSAlertDialog
- âœ… AiConfigScreen.kt - åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†è¿ç§»åˆ°iOSé£æ ¼
- âœ… ContactDetailScreen.kt - åˆ é™¤ç¡®è®¤å’Œæœªä¿å­˜æ›´æ”¹å¯¹è¯æ¡†è¿ç§»åˆ°iOSé£æ ¼
- âœ… EditFactDialog.kt - è¿ç§»åˆ°iOSé£æ ¼ï¼ˆå«ä¸‹æ‹‰èœå•ï¼‰
- âœ… EditConversationDialog.kt - è¿ç§»åˆ°iOSé£æ ¼ï¼ˆå«èº«ä»½å‰ç¼€å¤„ç†ï¼‰
- âœ… EditSummaryDialog.kt - è¿ç§»åˆ°iOSé£æ ¼ï¼ˆå«å¤šè¡Œè¾“å…¥ï¼‰
- âœ… UserProfileScreen.kt - IOSAddTagDialog è¿ç§»åˆ°çœŸæ­£çš„iOSé£æ ¼
- âœ… UserProfileScreen.kt - IOSEditTagDialog è¿ç§»åˆ°çœŸæ­£çš„iOSé£æ ¼ï¼ˆä¸‰æŒ‰é’®å¸ƒå±€ï¼‰
- âœ… UserProfileScreen.kt - IOSAddDimensionDialog è¿ç§»åˆ°çœŸæ­£çš„iOSé£æ ¼
- âœ… UserProfileScreen.kt - IOSDeleteConfirmDialog è¿ç§»åˆ°ä½¿ç”¨ IOSAlertDialog
- âœ… UserProfileScreen.kt - IOSExportDialog è¿ç§»åˆ°çœŸæ­£çš„iOSé£æ ¼
- âœ… UserProfileScreen.kt - IOSResetConfirmDialog è¿ç§»åˆ°ä½¿ç”¨ IOSAlertDialog

### Phase 3: PersonaTab äº¤äº’ä¼˜åŒ–ï¼ˆP1ï¼‰

| ä»»åŠ¡ID | ä»»åŠ¡æè¿° | é¢„è®¡å·¥æ—¶ | çŠ¶æ€ |
|--------|----------|----------|------|
| T3-01 | ä¿®å¤æ»šåŠ¨ä½ç½®ä¿æŒé—®é¢˜ | 1h | âœ… å·²å®Œæˆ |
| T3-02 | ğŸ†• ä¼˜åŒ–é‡ç»„èŒƒå›´ï¼ˆä½¿ç”¨ key éš”ç¦»ï¼‰ | 1h | âœ… å·²å®Œæˆ |
| T3-03 | ğŸ†• ä½¿ç”¨ derivedStateOf ä¼˜åŒ–è®¡ç®— | 0.5h | âœ… å·²å®Œæˆ |
| T3-04 | ğŸ†• ä½¿ç”¨ rememberSaveable æŒä¹…åŒ–çŠ¶æ€ | 0.5h | âœ… å·²å®Œæˆ |
| T3-05 | ä¿®å¤æœç´¢æ æ¸…é™¤æŒ‰é’®æ— æ•ˆé—®é¢˜ | 0.5h | âœ… å·²å®Œæˆ |
| T3-06 | æ·»åŠ å•å…ƒæµ‹è¯• | 1h | âœ… å·²å®Œæˆ |
| T3-07 | ğŸ†• æ·»åŠ æ€§èƒ½æµ‹è¯•ï¼ˆé‡ç»„æ¬¡æ•°ç›‘æ§ï¼‰ | 1h | ğŸ”² å¾…å¼€å§‹ |

**Phase 3 å·²å®Œæˆä¿®å¤æ¸…å•**:
- âœ… PersonaTab.kt - ä½¿ç”¨ rememberSaveable æŒä¹…åŒ–æœç´¢å…³é”®è¯å’Œå±•å¼€çŠ¶æ€
- âœ… PersonaTab.kt - ä½¿ç”¨ LinkedHashMap ä¿æŒåˆ†ç±»é¡ºåºç¨³å®š
- âœ… PersonaTab.kt - æ·»åŠ æ»šåŠ¨ä½ç½®ä¿å­˜å’Œæ¢å¤æœºåˆ¶ï¼ˆsnapshotFlowï¼‰
- âœ… PersonaTab.kt - ä½¿ç”¨ hashCode ä½œä¸ºç¨³å®š key
- âœ… PersonaTab.kt - æ·»åŠ  contentType ä¼˜åŒ–å¤ç”¨
- âœ… PersonaTab.kt - æ–°å¢åˆ†ç±»æ—¶è‡ªåŠ¨å±•å¼€
- âœ… ModernFloatingSearchBar - ä¿®å¤æ¸…é™¤æŒ‰é’®ç‚¹å‡»åŒºåŸŸè¿‡å°é—®é¢˜ï¼ˆå¢å¤§åˆ°32dpï¼Œæ·»åŠ clipï¼‰
- âœ… SimpleCategoryCard - ä½¿ç”¨å“åº”å¼å­—ä½“å°ºå¯¸
- âœ… SimpleTagChip - ä½¿ç”¨å“åº”å¼å­—ä½“å°ºå¯¸
- âœ… NoSearchResultView - ä½¿ç”¨å“åº”å¼å­—ä½“å°ºå¯¸

**Phase 3 æ–°å¢æµ‹è¯•æ–‡ä»¶**:
- âœ… ModernFloatingSearchBarTest.kt - æœç´¢æ ç»„ä»¶æµ‹è¯•ï¼ˆ14ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- âœ… AdaptiveDimensionsTest.kt - å“åº”å¼å°ºå¯¸ç³»ç»Ÿæµ‹è¯•ï¼ˆ25ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- âœ… IOSAlertDialogTest.kt - iOSå¯¹è¯æ¡†ç»„ä»¶æµ‹è¯•ï¼ˆ15ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰

### Phase 4: ğŸ†• æ€§èƒ½éªŒè¯ä¸ä¼˜åŒ–ï¼ˆP2ï¼‰

| ä»»åŠ¡ID | ä»»åŠ¡æè¿° | é¢„è®¡å·¥æ—¶ | çŠ¶æ€ |
|--------|----------|----------|------|
| T4-01 | æ·»åŠ é‡ç»„æ¬¡æ•°ç›‘æ§ | 1h | ğŸ”² å¾…å¼€å§‹ |
| T4-02 | æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼ˆå“åº”å¼ç³»ç»Ÿå¼€é”€ï¼‰ | 1h | ğŸ”² å¾…å¼€å§‹ |
| T4-03 | å†…å­˜ä½¿ç”¨åˆ†æ | 1h | ğŸ”² å¾…å¼€å§‹ |
| T4-04 | ç”µæ± å½±å“æµ‹è¯• | 1h | ğŸ”² å¾…å¼€å§‹ |

---

## ğŸ“Š ä¸ƒã€éªŒæ”¶æ ‡å‡†ï¼ˆæ‰©å±•ç‰ˆï¼‰

### 7.1 å­—ä½“æ˜¾ç¤ºéªŒæ”¶

| éªŒæ”¶é¡¹ | æ ‡å‡† | æµ‹è¯•æ–¹æ³• |
|--------|------|----------|
| å°å±è®¾å¤‡ï¼ˆ<360dpï¼‰ | å­—ä½“å®Œæ•´æ˜¾ç¤ºï¼Œæ— è£å‰ª | æ¨¡æ‹Ÿå™¨ + çœŸæœºæµ‹è¯• |
| æ™®é€šè®¾å¤‡ï¼ˆ360-600dpï¼‰ | å­—ä½“å¤§å°é€‚ä¸­ï¼Œä¸è®¾è®¡ç¨¿ä¸€è‡´ | æ¨¡æ‹Ÿå™¨ + çœŸæœºæµ‹è¯• |
| å¤§å±è®¾å¤‡ï¼ˆ>600dpï¼‰ | å­—ä½“é€‚å½“æ”¾å¤§ï¼Œä¿æŒå¯è¯»æ€§ | æ¨¡æ‹Ÿå™¨ + çœŸæœºæµ‹è¯• |
| ç³»ç»Ÿå¤§å­—ä½“æ¨¡å¼ï¼ˆ150%ï¼‰ | å­—ä½“æ­£ç¡®ç¼©æ”¾ï¼Œå¸ƒå±€ä¸æº¢å‡º | çœŸæœºè®¾ç½®æµ‹è¯• |
| ğŸ†• ç³»ç»Ÿè¶…å¤§å­—ä½“æ¨¡å¼ï¼ˆ200%ï¼‰ | å­—ä½“é™åˆ¶åœ¨æœ€å¤§å€¼ï¼Œå¸ƒå±€æ­£å¸¸ | çœŸæœºè®¾ç½®æµ‹è¯• |
| ğŸ†• é«˜å¯†åº¦å±å¹•ï¼ˆ>480dpiï¼‰ | å­—ä½“æ¸…æ™°ï¼Œæ— æ¨¡ç³Š | é«˜ç«¯çœŸæœºæµ‹è¯• |
| ğŸ†• MIUI è®¾å¤‡ | å­—ä½“æ˜¾ç¤ºæ­£å¸¸ | å°ç±³çœŸæœºæµ‹è¯• |
| ğŸ†• EMUI è®¾å¤‡ | å­—ä½“æ˜¾ç¤ºæ­£å¸¸ | åä¸ºçœŸæœºæµ‹è¯• |
| ğŸ†• ColorOS è®¾å¤‡ | å­—ä½“æ˜¾ç¤ºæ­£å¸¸ | OPPO çœŸæœºæµ‹è¯• |

### 7.2 å¯¹è¯æ¡†é£æ ¼éªŒæ”¶

| éªŒæ”¶é¡¹ | æ ‡å‡† | æµ‹è¯•æ–¹æ³• |
|--------|------|----------|
| è§†è§‰é£æ ¼ | ç¬¦åˆ iOS è®¾è®¡è§„èŒƒ | è§†è§‰å¯¹æ¯” |
| åœ†è§’ | ä½¿ç”¨å“åº”å¼ cornerRadiusMedium | ä»£ç å®¡æŸ¥ |
| å­—ä½“ | ä½¿ç”¨å“åº”å¼å­—ä½“å°ºå¯¸ | ä»£ç å®¡æŸ¥ |
| æŒ‰é’®å¸ƒå±€ | iOS é£æ ¼æ°´å¹³æ’åˆ—ï¼ˆä¸¤æŒ‰é’®ï¼‰ | è§†è§‰å¯¹æ¯” |
| ğŸ†• æ‰€æœ‰å¯¹è¯æ¡†è¿ç§» | 9ä¸ªå¯¹è¯æ¡†å…¨éƒ¨è¿ç§»å®Œæˆ | ä»£ç å®¡æŸ¥ |
| ğŸ†• è®¾è®¡ç³»ç»Ÿä¸€è‡´æ€§ | æ—  Material3 AlertDialog æ®‹ç•™ | Lint æ£€æŸ¥ |

### 7.3 PersonaTab äº¤äº’éªŒæ”¶

| éªŒæ”¶é¡¹ | æ ‡å‡† | æµ‹è¯•æ–¹æ³• |
|--------|------|----------|
| æ·»åŠ æ ‡ç­¾ | æ»šåŠ¨ä½ç½®ä¿æŒä¸å˜ | æ‰‹åŠ¨æµ‹è¯• |
| åˆ é™¤æ ‡ç­¾ | æ»šåŠ¨ä½ç½®ä¿æŒä¸å˜ | æ‰‹åŠ¨æµ‹è¯• |
| é‡ç½®åŠŸèƒ½ | æ­£ç¡®æ¸…ç©ºæ‰€æœ‰æ ‡ç­¾ | æ‰‹åŠ¨æµ‹è¯• |
| ğŸ†• é…ç½®å˜æ›´ï¼ˆæ—‹è½¬ï¼‰ | æ»šåŠ¨ä½ç½®ä¿æŒ | æ‰‹åŠ¨æµ‹è¯• |
| ğŸ†• è¿›ç¨‹é‡å»º | æ»šåŠ¨ä½ç½®æ¢å¤ | å¼€å‘è€…é€‰é¡¹æµ‹è¯• |
| ğŸ†• é‡ç»„æ¬¡æ•° | æ·»åŠ æ ‡ç­¾æ—¶é‡ç»„æ¬¡æ•° < 5 | æ€§èƒ½ç›‘æ§ |

### 7.4 ğŸ†• æ€§èƒ½éªŒæ”¶

| éªŒæ”¶é¡¹ | æ ‡å‡† | æµ‹è¯•æ–¹æ³• |
|--------|------|----------|
| AdaptiveDimensions è®¡ç®—æ—¶é—´ | < 1ms | æ€§èƒ½ç›‘æ§ |
| å†…å­˜å¢é‡ | < 100 bytes | å†…å­˜åˆ†æ |
| é‡ç»„é¢‘ç‡ | ä»… Configuration å˜åŒ–æ—¶é‡ç»„ | é‡ç»„ç›‘æ§ |
| å¸§ç‡å½±å“ | æ— æ˜æ˜¾æ‰å¸§ | å¸§ç‡ç›‘æ§ |

---

## ğŸ“ å…«ã€å˜æ›´è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ | å˜æ›´äºº |
|------|------|----------|--------|
| v1.0 | 2025-12-29 | åˆå§‹ç‰ˆæœ¬ï¼Œå®Œæˆç³»ç»Ÿæ€§åˆ†æ | Kiro |
| v2.0 | 2025-12-29 | æ·±åº¦æ‰©å±•ï¼šæ·»åŠ å­—ä½“æ¸²æŸ“å¼•æ“å·®å¼‚åˆ†æã€Composeé‡ç»„æœºåˆ¶åˆ†æã€è®¾è®¡ç³»ç»Ÿä¸€è‡´æ€§æ£€æŸ¥ã€æ€§èƒ½å½±å“è¯„ä¼° | Kiro |
| v2.1 | 2025-12-29 | å®æ–½è¿›åº¦æ›´æ–°ï¼šPhase 1ï¼ˆå“åº”å¼å­—ä½“ç³»ç»Ÿï¼‰90%å®Œæˆï¼ŒPhase 2ï¼ˆiOSå¯¹è¯æ¡†ï¼‰25%å®Œæˆï¼ŒPhase 3ï¼ˆPersonaTabä¼˜åŒ–ï¼‰60%å®Œæˆ | Kiro |
| v2.2 | 2025-12-29 | Phase 2 è¿›åº¦æ›´æ–°ï¼šå®Œæˆ10ä¸ªå¯¹è¯æ¡†è¿ç§»ï¼ˆIOSAlertDialogã€IOSInputDialogã€PermissionRequestDialogã€DeleteConfirmDialogã€DeleteTagConfirmDialogã€AddTagDialog x2ã€TagConfirmationDialogã€DiscardConfirmDialogã€BatchDeleteConfirmDialogï¼‰ï¼ŒPhase 2 å®Œæˆç‡æå‡è‡³70% | Kiro |
| v2.3 | 2025-12-29 | Phase 3 è¿›åº¦æ›´æ–°ï¼šä¿®å¤æœç´¢æ æ¸…é™¤æŒ‰é’®æ— æ•ˆé—®é¢˜ï¼ˆBUG-36-05ï¼‰ï¼Œå¢å¤§ç‚¹å‡»åŒºåŸŸåˆ°32dpå¹¶æ·»åŠ clipä¿®é¥°ç¬¦ï¼ŒPhase 3 å®Œæˆç‡æå‡è‡³85% | Kiro |
| v2.4 | 2025-12-29 | Phase 3 æµ‹è¯•å®Œæˆï¼šæ–°å¢3ä¸ªæµ‹è¯•æ–‡ä»¶ï¼ˆModernFloatingSearchBarTestã€AdaptiveDimensionsTestã€IOSAlertDialogTestï¼‰ï¼Œå…±54ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼ŒPhase 3 å®Œæˆç‡æå‡è‡³95% | Kiro |
| v2.5 | 2025-12-29 | æ„å»ºå’Œæµ‹è¯•éªŒè¯å®Œæˆï¼šAPKæ„å»ºæˆåŠŸï¼ˆ4åˆ†45ç§’ï¼‰ï¼Œå®‰è£…åˆ°æ¨¡æ‹Ÿå™¨æˆåŠŸï¼Œ3ä¸ªæ–°æµ‹è¯•æ–‡ä»¶å…¨éƒ¨é€šè¿‡ï¼ˆ54ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰ï¼Œç¦ç”¨4ä¸ªæ—§çš„ä¸å…¼å®¹æµ‹è¯•æ–‡ä»¶ | Kiro |
| v2.6 | 2025-12-29 | **æ ¸å¿ƒé—®é¢˜ä¿®å¤**ï¼šä¿®å¤åº•éƒ¨å¯¼èˆªæ å­—ä½“æˆªæ–­ã€IOSNavigationBarçŠ¶æ€æ é®æŒ¡ã€PersonaTabé‡ç½®åŠŸèƒ½æ— æ•ˆä¸‰ä¸ªé—®é¢˜ï¼ŒAPKå·²å®‰è£…åˆ°çœŸæœºå¾…éªŒè¯ | Kiro |

---

## ğŸ†• ä¹ã€é£é™©è¯„ä¼°

### 9.1 æŠ€æœ¯é£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | ç¼“è§£æªæ–½ |
|------|------|------|----------|
| ROM å‚å•†å­—ä½“æ¸²æŸ“å·®å¼‚å¯¼è‡´æ˜¾ç¤ºå¼‚å¸¸ | ä¸­ | é«˜ | å®ç° ROM æ£€æµ‹å’Œè¡¥å¿æœºåˆ¶ |
| è¶…å¤§å­—ä½“æ¨¡å¼ä¸‹å¸ƒå±€æº¢å‡º | ä¸­ | ä¸­ | å®ç°å­—ä½“ç¼©æ”¾è¾¹ç•Œé™åˆ¶ |
| é‡ç»„ä¼˜åŒ–å¯¼è‡´çŠ¶æ€ä¸¢å¤± | ä½ | é«˜ | å……åˆ†æµ‹è¯• rememberSaveable |
| æ€§èƒ½ä¼˜åŒ–å¼•å…¥æ–° Bug | ä½ | ä¸­ | å¢é‡ä¿®æ”¹ï¼Œé€æ­¥éªŒè¯ |

### 9.2 å…¼å®¹æ€§é£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | ç¼“è§£æªæ–½ |
|------|------|------|----------|
| æ—§ç‰ˆ Androidï¼ˆAPI 24-26ï¼‰å…¼å®¹æ€§ | ä½ | ä¸­ | æ¨¡æ‹Ÿå™¨æµ‹è¯• |
| æŠ˜å å±è®¾å¤‡é€‚é… | ä¸­ | ä¸­ | æ·»åŠ  EXPANDED å±å¹•ç±»å‹å¤„ç† |
| æ¨ªå±æ¨¡å¼é€‚é… | ä¸­ | ä½ | æ·»åŠ æ¨ªå±æµ‹è¯•ç”¨ä¾‹ |

---

**æ–‡æ¡£ç‰ˆæœ¬**: 2.6
**æœ€åæ›´æ–°**: 2025-12-29
**æ–‡æ¡£çŠ¶æ€**: âœ… å·²ä¿®å¤ï¼ˆå¾…çœŸæœºéªŒè¯ï¼‰
**åˆ†ææ·±åº¦**: æ¡†æ¶çº§ + ç³»ç»Ÿçº§ + æ€§èƒ½çº§

---

## ğŸ”§ åã€v2.6 ä¿®å¤è¯¦æƒ…è®°å½•

### 10.1 BUG-36-01: åº•éƒ¨å¯¼èˆªæ å­—ä½“è¢«æˆªæ–­

**é—®é¢˜ç°è±¡**: çœŸæœºä¸Šåº•éƒ¨å¯¼èˆªæ çš„"è”ç³»äºº"æ˜¾ç¤ºä¸º"è”ç„äºº"ï¼Œ"è®¾ç½®"æ˜¾ç¤ºä¸º"æ²¿ç½®"ï¼Œå­—ä½“è¢«å‚ç›´è£å‰ª

**æ ¹æœ¬åŸå› åˆ†æ**:
- å¯¼èˆªæ å†…å®¹Rowé«˜åº¦å›ºå®šä¸º50dp
- BottomNavItemå†…éƒ¨Columnä½¿ç”¨å›ºå®špaddingï¼Œå¯¼è‡´å®é™…å¯ç”¨é«˜åº¦ä¸è¶³
- å›¾æ ‡(22dp) + é—´è·(2dp) + å­—ä½“(11sp) åœ¨é«˜å¯†åº¦å±å¹•ä¸Šè¶…å‡ºå®¹å™¨é«˜åº¦
- å­—ä½“è¢«å®¹å™¨è¾¹ç•Œè£å‰ªï¼Œè€Œéå­—ä½“å¤§å°é—®é¢˜

**ä¿®å¤æ–¹æ¡ˆ** (`EmpathyBottomNavigation.kt`):
```kotlin
// ä¿®æ”¹1: å¢åŠ Rowé«˜åº¦ä»50dpåˆ°56dp
Row(
    modifier = Modifier
        .fillMaxWidth()
        .height(56.dp)  // ä»50dpå¢åŠ åˆ°56dp
        // ...
)

// ä¿®æ”¹2: BottomNavItemä½¿ç”¨fillMaxHeightç¡®ä¿å¡«æ»¡çˆ¶å®¹å™¨
Column(
    modifier = modifier
        .fillMaxHeight()  // æ–°å¢ï¼šå¡«æ»¡çˆ¶å®¹å™¨é«˜åº¦
        .clickable(...)
        .padding(vertical = 4.dp),  // è°ƒæ•´padding
    // ...
) {
    Icon(
        // ...
        modifier = Modifier.size(20.dp)  // ä»22dpå‡å°åˆ°20dp
    )
    Spacer(modifier = Modifier.height(3.dp))
    Text(
        text = label,
        fontSize = 10.sp,  // ä»11spå‡å°åˆ°10sp
        maxLines = 1,
        softWrap = false  // æ–°å¢ï¼šç¦æ­¢æ¢è¡Œ
    )
}
```

**ä¿®æ”¹æ–‡ä»¶**: `presentation/src/main/kotlin/com/empathy/ai/presentation/ui/component/navigation/EmpathyBottomNavigation.kt`

---

### 10.2 BUG-36-02: æ–°å»ºè”ç³»äººç•Œé¢é¡¶éƒ¨æŒ‰é’®è¢«çŠ¶æ€æ é®æŒ¡

**é—®é¢˜ç°è±¡**: æ–°å»ºè”ç³»äººç•Œé¢çš„"å–æ¶ˆ"å’Œ"å®Œæˆ"æŒ‰é’®ä¸ç³»ç»ŸçŠ¶æ€æ é‡å ï¼Œæ— æ³•ç‚¹å‡»

**æ ¹æœ¬åŸå› åˆ†æ**:
- IOSNavigationBarç»„ä»¶æ²¡æœ‰å¤„ç†ç³»ç»ŸçŠ¶æ€æ çš„å®‰å…¨åŒºåŸŸï¼ˆWindowInsetsï¼‰
- å¯¼èˆªæ å†…å®¹ç›´æ¥ä»å±å¹•é¡¶éƒ¨å¼€å§‹æ¸²æŸ“ï¼Œè¢«çŠ¶æ€æ é®æŒ¡

**ä¿®å¤æ–¹æ¡ˆ** (`IOSNavigationBar.kt`):
```kotlin
Column(
    modifier = modifier
        .fillMaxWidth()
        .background(iOSLightGrayBackground.copy(alpha = 0.95f))
        .windowInsetsPadding(WindowInsets.statusBars)  // æ–°å¢ï¼šæ·»åŠ çŠ¶æ€æ å®‰å…¨åŒºåŸŸ
) {
    Row(
        modifier = Modifier
            .fillMaxWidth()
            .height(navBarContentHeight)  // 52dp iOSæ ‡å‡†é«˜åº¦
            // ...
    ) {
        // å–æ¶ˆæŒ‰é’®ã€æ ‡é¢˜ã€å®ŒæˆæŒ‰é’®
    }
}
```

**ä¿®æ”¹æ–‡ä»¶**: `presentation/src/main/kotlin/com/empathy/ai/presentation/ui/component/ios/IOSNavigationBar.kt`

---

### 10.3 BUG-36-05: PersonaTabé‡ç½®åŠŸèƒ½æ— æ•ˆ

**é—®é¢˜ç°è±¡**: PersonaTabé¡µé¢çš„é‡ç½®æŒ‰é’®ç‚¹å‡»åæ²¡æœ‰å®é™…æ•ˆæœ

**æ ¹æœ¬åŸå› åˆ†æ**:
- ä»£ç ä¸­å®šä¹‰äº† `resetAllState` å‡½æ•°ï¼Œä½†æ²¡æœ‰åœ¨UIä¸­æš´éœ²é‡ç½®æŒ‰é’®
- é‡ç½®åŠŸèƒ½é€»è¾‘å­˜åœ¨ä½†æ— æ³•è¢«ç”¨æˆ·è§¦å‘

**ä¿®å¤æ–¹æ¡ˆ** (`PersonaTab.kt`):
```kotlin
// åœ¨æœç´¢æ å³ä¾§æ·»åŠ é‡ç½®æŒ‰é’®
Row(
    modifier = Modifier
        .fillMaxWidth()
        .padding(dimensions.spacingMedium),
    verticalAlignment = Alignment.CenterVertically
) {
    ModernFloatingSearchBar(
        query = searchQuery,
        onQueryChange = { searchQuery = it },
        placeholder = "æœç´¢æ ‡ç­¾æˆ–åˆ†ç±»",
        modifier = Modifier.weight(1f)
    )
    
    // æ–°å¢ï¼šæ˜¾ç¤ºé‡ç½®æŒ‰é’®ï¼ˆå½“æœ‰æœç´¢å†…å®¹ã€æŠ˜å åˆ†ç±»æˆ–æ»šåŠ¨ä½ç½®ä¸åœ¨é¡¶éƒ¨æ—¶ï¼‰
    if (showResetButton && needsReset) {
        Spacer(modifier = Modifier.width(8.dp))
        IconButton(
            onClick = resetAllState,
            modifier = Modifier.size(40.dp)
        ) {
            Icon(
                imageVector = Icons.Default.Refresh,
                contentDescription = "é‡ç½®",
                tint = iOSBlue,
                modifier = Modifier.size(24.dp)
            )
        }
    }
}

// é‡ç½®åŠŸèƒ½å®ç°
val resetAllState: () -> Unit = {
    searchQuery = ""                           // æ¸…ç©ºæœç´¢
    expandedCategories = groupedFacts.keys.toSet()  // å±•å¼€æ‰€æœ‰åˆ†ç±»
    savedScrollIndex = 0                       // é‡ç½®æ»šåŠ¨ä½ç½®
    savedScrollOffset = 0
    coroutineScope.launch {
        listState.animateScrollToItem(0)       // æ»šåŠ¨åˆ°é¡¶éƒ¨
    }
}
```

**ä¿®æ”¹æ–‡ä»¶**: `presentation/src/main/kotlin/com/empathy/ai/presentation/ui/screen/contact/persona/PersonaTab.kt`

---

### 10.4 æ„å»ºå’Œéƒ¨ç½²è®°å½•

| æ­¥éª¤ | ç»“æœ | è€—æ—¶ |
|------|------|------|
| ä»£ç è¯Šæ–­ | æ— ç¼–è¯‘é”™è¯¯ | - |
| Gradle Clean | æˆåŠŸ | - |
| assembleDebug | BUILD SUCCESSFUL | 3m 30s |
| å®‰è£…åˆ°çœŸæœº | Success | - |

**çœŸæœºè®¾å¤‡**: QCUKF6DUW46XKVU8 (PJV110)

---

### 10.5 å¾…éªŒè¯é¡¹

| éªŒè¯é¡¹ | é¢„æœŸç»“æœ | çŠ¶æ€ |
|--------|----------|------|
| åº•éƒ¨å¯¼èˆªæ å­—ä½“ | "è”ç³»äºº"ã€"AIå†›å¸ˆ"ã€"è®¾ç½®"å®Œæ•´æ˜¾ç¤º | ğŸ”² å¾…éªŒè¯ |
| æ–°å»ºè”ç³»äººæŒ‰é’® | "å–æ¶ˆ"å’Œ"å®Œæˆ"æŒ‰é’®å¯æ­£å¸¸ç‚¹å‡» | ğŸ”² å¾…éªŒè¯ |
| PersonaTabé‡ç½® | æœç´¢/æ»šåŠ¨åæ˜¾ç¤ºé‡ç½®æŒ‰é’®ï¼Œç‚¹å‡»æœ‰æ•ˆ | ğŸ”² å¾…éªŒè¯ |