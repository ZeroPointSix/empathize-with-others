# BUG-00071：事实流对话与总结编辑点击无响应

## 问题概述
【问题分类】功能缺失  
【优先级】P1-高  
【发现版本】v1.1.0 (dev)  
【发现时间】2026-01-15  

---

## 问题描述

### 现象描述
在联系人详情的「事实流」页面中，点击对话记录或 AI 总结没有任何响应，无法进入编辑流程。

### 期望行为
1. 点击时光轴中的对话记录 → 打开对话编辑弹窗  
2. 点击时光轴中的 AI 总结 → 打开总结编辑弹窗  
3. 清单模式下行为一致  
4. 事实类型仍保持点击进入事实编辑  

### 实际行为
1. 点击对话记录无响应  
2. 点击 AI 总结无响应  
3. 只有事实类型（UserFact）点击可进入编辑  

---

## 问题分析

### 影响范围
- 事实流页面（时光轴/清单）
- 对话与总结的编辑入口

### 根因定位
1. 事实流使用现代视图组件：`ModernTimelineView` / `ModernListView`  
2. 这两类组件对「对话/总结」只调用 `onItemClick`  
3. `FactStreamTab` 未传入 `onItemClick`，导致点击对话/总结无回调  
4. `onConversationEdit` / `onSummaryEdit` 参数未在现代视图中使用  

**现有数据流（断点）**
```
点击对话/总结
  ↓
ModernTimelineView.onItemClick
  ↓
FactStreamTab.onItemClick == null
  ↓
无任何响应
```

---

## 修复方案

### 修改思路
在 `FactStreamTab` 内统一处理点击路由：  
- `Conversation` → `onConversationEdit(logId)`  
- `AiSummary` → `onSummaryEdit(summaryId)`  
- 其他类型 → `onItemClick`（如有）  
- `UserFact` 仍由 `onFactEdit` 在 Modern 组件内部处理  

### 交互约定
编辑入口采用**点击触发**（不使用长按）。

---

## 测试步骤
1. 进入联系人详情 → 切换到「事实流」  
2. 时光轴模式：点击一条对话记录 → 进入编辑弹窗  
3. 时光轴模式：点击一条 AI 总结 → 进入编辑弹窗  
4. 清单模式：点击一条对话记录 → 进入编辑弹窗  
5. 清单模式：点击一条 AI 总结 → 进入编辑弹窗  
6. 点击事实类型仍进入事实编辑  

---

## 验收标准
1. 对话记录点击可进入编辑  
2. AI 总结点击可进入编辑  
3. 事实编辑功能不受影响  
4. 时光轴与清单模式行为一致  

---

## 相关文件
- `presentation/src/main/kotlin/com/empathy/ai/presentation/ui/screen/contact/factstream/FactStreamTab.kt`
- `presentation/src/main/kotlin/com/empathy/ai/presentation/ui/component/factstream/ModernTimelineView.kt`
- `presentation/src/main/kotlin/com/empathy/ai/presentation/ui/component/factstream/ModernListView.kt`
- `presentation/src/main/kotlin/com/empathy/ai/presentation/ui/screen/contact/ContactDetailTabScreen.kt`
- `presentation/src/main/kotlin/com/empathy/ai/presentation/ui/component/dialog/EditConversationDialog.kt`
- `presentation/src/main/kotlin/com/empathy/ai/presentation/ui/component/dialog/EditSummaryDialog.kt`

---

## 变更日志
| 日期 | 版本 | 变更内容 | 作者 |
|------|------|----------|------|
| 2026-01-15 | v1.0 | 创建问题与修复方案文档 | Codex |
