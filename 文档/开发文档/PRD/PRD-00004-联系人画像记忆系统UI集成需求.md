# PRD-00004: è”ç³»äººç”»åƒè®°å¿†ç³»ç»ŸUIé›†æˆéœ€æ±‚ v2.0

> **æ–‡æ¡£ç±»å‹**: äº§å“éœ€æ±‚æ–‡æ¡£ (PRD)  
> **ç‰ˆæœ¬**: 2.0 (æƒ…æ„ŸåŒ–æ™ºèƒ½å¡ç‰‡è®¾è®¡)  
> **åˆ›å»ºæ—¥æœŸ**: 2025-12-14  
> **æ›´æ–°æ—¥æœŸ**: 2025-12-14  
> **è´Ÿè´£äºº**: Kiro  
> **çŠ¶æ€**: ğŸ“‹ å¾…å¼€å‘  
> **ä¼˜å…ˆçº§**: ğŸ”´ é«˜  
> **ç›®æ ‡å—ä¼—**: UI/UXç”ŸæˆAIã€å‰ç«¯ä»£ç ç”ŸæˆAIã€è‡ªåŠ¨åŒ–æµ‹è¯•AI

---

## ğŸ¯ æ ¸å¿ƒç†å¿µ

è¯¥ç•Œé¢ä¸ä»…æ˜¯ä¸€ä¸ªé™æ€çš„æ•°æ®å±•ç¤ºå·¥å…·ï¼Œæ›´æ˜¯ä¸€ä¸ª**"æ´»ä½“æ¡£æ¡ˆ"**å’Œ**"AIå†›å¸ˆçš„æƒ…æŠ¥ä¸­å¿ƒ"**ã€‚

**è®¾è®¡å“²å­¦**ï¼š
- **æƒ…æ„Ÿæ¸©åº¦**ï¼šè®©ç”¨æˆ·æ„Ÿåˆ°äº²åˆ‡ã€è¢«ç†è§£ã€æœ‰æ¸©åº¦
- **ä¸“ä¸šæ™ºèƒ½**ï¼šæ¸…æ™°å±•ç¤ºAIçš„åˆ†æèƒ½åŠ›å’Œæ´å¯Ÿæ·±åº¦
- **åŠ¨æ€å“åº”**ï¼šç•Œé¢å…ƒç´ æ ¹æ®å…³ç³»çŠ¶æ€å®æ—¶å˜åŒ–
- **æ²‰æµ¸ä½“éªŒ**ï¼šä»èƒŒæ™¯å…‰æ™•åˆ°åŠ¨ç”»è¿‡æ¸¡ï¼Œæ¯ä¸ªåƒç´ éƒ½åœ¨è®²è¿°å…³ç³»çš„æ•…äº‹

**æ ¸å¿ƒé—®é¢˜**ï¼š
- ç”¨æˆ·è¿›å…¥é¡µé¢çš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼š"æˆ‘ä»¬ç°åœ¨æ€ä¹ˆæ ·äº†ï¼Ÿ"
- ç”¨æˆ·æµè§ˆå†å²çš„éœ€æ±‚ï¼š"æˆ‘ä»¬ç»å†äº†ä»€ä¹ˆï¼Ÿ"
- ç”¨æˆ·ç®¡ç†ä¿¡æ¯çš„éœ€æ±‚ï¼š"AIæ˜¯æ€ä¹ˆç†è§£TAçš„ï¼Ÿ"

---

## ğŸ“‹ éœ€æ±‚èƒŒæ™¯

### å½“å‰çŠ¶å†µ

**âœ… å·²å®ç°çš„åç«¯åŠŸèƒ½**ï¼š
1. **è‡ªåŠ¨è®°å½•äº’åŠ¨** - `MemoryLogger` è‡ªåŠ¨è®°å½•æ¯æ¬¡AIåˆ†æ
2. **æ™ºèƒ½ä¸Šä¸‹æ–‡æ„å»º** - `ContextBuilder` æ„å»ºåŒ…å«å†å²è®°å¿†çš„ä¸Šä¸‹æ–‡
3. **æ¯æ—¥è‡ªåŠ¨æ€»ç»“** - `SummarizeDailyConversationsUseCase` å®šæ—¶æ€»ç»“
4. **å…³ç³»è¿›å±•è¿½è¸ª** - `RelationshipScore`ã€`Fact` æ¨¡å‹å®Œæ•´å®ç°
5. **æ•°æ®æ¸…ç†ç®¡ç†** - `DataCleanupManager` è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®
6. **é”™è¯¯æ¢å¤æœºåˆ¶** - `FailedTaskRecovery` å¤„ç†å¤±è´¥çš„æ€»ç»“ä»»åŠ¡

**âŒ å‰ç«¯UIç¼ºå¤±**ï¼š
- ç”¨æˆ·çœ‹ä¸åˆ°ç³»ç»Ÿè‡ªåŠ¨è®°å½•çš„å¯¹è¯å†å²
- ç”¨æˆ·çœ‹ä¸åˆ°AIç”Ÿæˆçš„æ¯æ—¥æ€»ç»“
- ç”¨æˆ·çœ‹ä¸åˆ°å…³ç³»è¿›å±•çš„å˜åŒ–è¶‹åŠ¿
- ç•Œé¢ç¼ºä¹æƒ…æ„ŸåŒ–è¡¨è¾¾ï¼Œæ— æ³•ä¼ é€’å…³ç³»çš„æ¸©åº¦
- æ•°æ®å±•ç¤ºæ–¹å¼å•ä¸€ï¼Œæ— æ³•æ»¡è¶³ä¸åŒåœºæ™¯çš„éœ€æ±‚

### é—®é¢˜æè¿°

è™½ç„¶åç«¯åŠŸèƒ½å®Œæ•´ï¼Œä½†ç”¨æˆ·æ— æ³•æ„ŸçŸ¥å’Œä½¿ç”¨è¿™äº›å¼ºå¤§çš„è®°å¿†åŠŸèƒ½ï¼Œå¯¼è‡´ï¼š
1. **åŠŸèƒ½éšè—**ï¼šç”¨æˆ·ä¸çŸ¥é“ç³»ç»Ÿåœ¨åå°åšäº†ä»€ä¹ˆ
2. **ä»·å€¼æœªä½“ç°**ï¼šè®°å¿†ç³»ç»Ÿçš„æ ¸å¿ƒä»·å€¼æ— æ³•ä¼ é€’ç»™ç”¨æˆ·
3. **æƒ…æ„Ÿç¼ºå¤±**ï¼šç•Œé¢å†·å†°å†°ï¼Œæ— æ³•ä¼ é€’å…³ç³»çš„æ¸©åº¦å’Œå˜åŒ–
4. **ä½“éªŒå‰²è£‚**ï¼šå‰åç«¯åŠŸèƒ½ä¸åŒ¹é…ï¼Œç”¨æˆ·ä½“éªŒä¸å®Œæ•´

---

## ğŸ¨ å…¨å±€è®¾è®¡è¯­è¨€ (Global Design Language)

åœ¨è¿›å…¥å…·ä½“é¡µé¢å‰ï¼ŒAIéœ€ç†è§£è´¯ç©¿æ‰€æœ‰é¡µé¢çš„é€šç”¨è®¾è®¡è§„åˆ™ã€‚

### 0.1. è§†è§‰é£æ ¼ï¼šæƒ…æ„ŸåŒ–ç£¨ç ‚ç»ç’ƒ (Emotional Glassmorphism)

**æ ¸å¿ƒæè´¨**ï¼š
- ç•Œé¢å…ƒç´ ï¼ˆå¡ç‰‡ã€å¼¹çª—ã€æ ‡ç­¾ï¼‰æ™®éé‡‡ç”¨**ç£¨ç ‚ç»ç’ƒï¼ˆGlassmorphismï¼‰**æ•ˆæœ
- åŠé€æ˜èƒŒæ™¯ + æŸ”å’Œçš„èƒŒæ™¯æ¨¡ç³Š + ç»†å¾®çš„ç™½è‰²è¾¹æ¡†å…‰æ™•
- è¥é€ é€šé€ã€ç°ä»£ä¸”ä¸åšé‡çš„è´¨æ„Ÿ

**èƒŒæ™¯æ°›å›´**ï¼š
- é¡µé¢èƒŒæ™¯ä¸æ˜¯çº¯ç™½æˆ–çº¯é»‘ï¼Œè€Œæ˜¯**æŸ”å’Œçš„åŠ¨æ€æ¸å˜å…‰æ™•**
- ğŸ”´ **å…³é”®è¡Œä¸º**ï¼šèƒŒæ™¯å…‰æ™•çš„è‰²è°ƒå¿…é¡»æ˜¯**å¯ç¼–ç¨‹çš„ (Programmable)**
- æ ¹æ®è”ç³»äººçš„"å…³ç³»å¥åº·åº¦/äº²å¯†åº¦"å¾—åˆ†è‡ªåŠ¨å˜åŒ–ï¼š
  - **é«˜äº²å¯†åº¦ï¼ˆ81-100ï¼‰**ï¼šæš–æ©™è‰²/ç²‰è‰²æ¸å˜
  - **è‰¯å¥½å…³ç³»ï¼ˆ61-80ï¼‰**ï¼šæŸ”å’Œçš„é»„ç»¿è‰²æ¸å˜
  - **ä¸€èˆ¬å…³ç³»ï¼ˆ31-60ï¼‰**ï¼šä¸­æ€§çš„è“ç°è‰²æ¸å˜
  - **å†·æ·¡å…³ç³»ï¼ˆ0-30ï¼‰**ï¼šå†·è“è‰²/æ·±ç°è‰²æ¸å˜

**æŠ€æœ¯å®ç°**ï¼š
```kotlin
@Composable
fun EmotionalBackground(relationshipScore: Int) {
    val backgroundColor = remember(relationshipScore) {
        when {
            relationshipScore >= 81 -> listOf(
                Color(0xFFFF6B9D), // ç²‰è‰²
                Color(0xFFFFA06B)  // æš–æ©™è‰²
            )
            relationshipScore >= 61 -> listOf(
                Color(0xFFFFC371), // æŸ”å’Œé»„è‰²
                Color(0xFF7FD8BE)  // æŸ”å’Œç»¿è‰²
            )
            relationshipScore >= 31 -> listOf(
                Color(0xFF89B5E0), // ä¸­æ€§è“è‰²
                Color(0xFFB8C5D6)  // ä¸­æ€§ç°è‰²
            )
            else -> listOf(
                Color(0xFF6B8CAE), // å†·è“è‰²
                Color(0xFF8B9DAF)  // æ·±ç°è‰²
            )
        }
    }
    
    Box(
        modifier = Modifier
            .fillMaxSize()
            .background(
                Brush.radialGradient(
                    colors = backgroundColor,
                    center = Offset(0.5f, 0.3f),
                    radius = 1000f
                )
            )
    )
}
```

### 0.2. äº¤äº’éšå–»ï¼šæ™ºèƒ½å¡ç‰‡ä¸æµä½“åˆ‡æ¢

**å†…å®¹å®¹å™¨**ï¼š
- ä¿¡æ¯ä¸»è¦é€šè¿‡ä¸åŒå½¢æ€çš„**"å¡ç‰‡"**æ‰¿è½½
- å¡ç‰‡é‡‡ç”¨ç£¨ç ‚ç»ç’ƒæ•ˆæœï¼Œå¸¦æœ‰ç»†å¾®çš„é˜´å½±å’Œè¾¹æ¡†å…‰æ™•

**çŠ¶æ€è¿‡æ¸¡**ï¼š
- ğŸ”´ **ç¦æ­¢ç¡¬åˆ‡ï¼ˆHard Cutï¼‰**
- å¿…é¡»é‡‡ç”¨**æµä½“å˜å½¢åŠ¨ç”» (Morphing Animation)**
- å…ƒç´ åº”å¹³æ»‘åœ°å±•å¼€ã€æ”¶ç¼©æˆ–é‡æ–°æ’åˆ—ä½ç½®
- åˆ‡æ¢æ—¶é—´ï¼š200-300msï¼Œä½¿ç”¨ç¼“åŠ¨æ›²çº¿ï¼ˆEaseInOutCubicï¼‰

**æŠ€æœ¯å®ç°**ï¼š
```kotlin
// ä½¿ç”¨ AnimatedContent å®ç°æµä½“åˆ‡æ¢
AnimatedContent(
    targetState = viewMode,
    transitionSpec = {
        fadeIn(animationSpec = tween(300)) +
            scaleIn(initialScale = 0.95f, animationSpec = tween(300)) with
            fadeOut(animationSpec = tween(300)) +
            scaleOut(targetScale = 0.95f, animationSpec = tween(300))
    }
) { mode ->
    when (mode) {
        ViewMode.Timeline -> TimelineView()
        ViewMode.List -> ListView()
    }
}
```

---

## ğŸ“± ç•Œé¢ä¸€ï¼šæ¦‚è§ˆ (Overview)

### åŠ¨æœº (Motivation)

ç”¨æˆ·è¿›å…¥è¯¥é¡µé¢çš„ç¬¬ä¸€çœ¼ï¼Œéœ€è¦ç«‹åˆ»å»ºç«‹æƒ…æ„Ÿè¿æ¥ï¼Œå¹¶å¿«é€Ÿè·å–å½“å‰å…³ç³»æœ€æ ¸å¿ƒçš„çŠ¶æ€æŒ‡æ ‡ã€‚

**ç”¨æˆ·å¿ƒä¸­çš„é¦–è¦é—®é¢˜**ï¼š"æˆ‘ä»¬ç°åœ¨æ€ä¹ˆæ ·äº†ï¼Ÿ"

### ä¸»è¦å…ƒç´ ä¸æ•ˆæœ

#### 1.1. åŠ¨æ€æƒ…æ„Ÿå¤´éƒ¨ (Dynamic Emotional Header)

**ä¸»è¦ç»„ä»¶**ï¼š
- è¶…å¤§åœ†å½¢ç”¨æˆ·å¤´åƒï¼ˆç›´å¾„120dpï¼‰
- å§“åï¼ˆTypography.headlineLargeï¼‰
- ç›¸è¯†æ—¶é•¿ï¼ˆå¦‚"å·²ç›¸è¯† 105 å¤©"ï¼‰

**è§†è§‰æ•ˆæœ**ï¼š
- å¤´åƒåæ–¹çš„èƒŒæ™¯åŒºåŸŸæ˜¯å…¨å±€èƒŒæ™¯å…‰æ™•æœ€å¼ºçƒˆçš„åœ°æ–¹
- å½¢æˆä¸€ä¸ªèšç„¦çš„èƒ½é‡åœºï¼Œå¸å¼•ç”¨æˆ·æ³¨æ„åŠ›

**äº¤äº’è¡Œä¸º (Sticky Header)**ï¼š
- å½“ç”¨æˆ·å‘ä¸Šæ»šåŠ¨æŸ¥çœ‹ä¸‹æ–¹å†…å®¹æ—¶ï¼Œå¤´éƒ¨åŒºåŸŸåº”å¹³æ»‘æ”¶ç¼©
- æœ€ç»ˆå˜ä¸ºä¸€ä¸ªåŒ…å«å§“åå’Œè¿”å›æŒ‰é’®çš„çª„æ¡ï¼ˆé«˜åº¦56dpï¼‰ï¼Œå›ºå®šåœ¨å±å¹•é¡¶éƒ¨
- èƒŒæ™¯å…‰æ™•æ­¤æ—¶åº”æ·¡åŒ–æˆ–æ¶ˆå¤±

**æŠ€æœ¯å®ç°**ï¼š
```kotlin
@Composable
fun DynamicEmotionalHeader(
    contact: ContactProfile,
    scrollState: LazyListState
) {
    val headerHeight by remember {
        derivedStateOf {
            val offset = scrollState.firstVisibleItemScrollOffset
            (200.dp - (offset * 0.5f).dp).coerceAtLeast(56.dp)
        }
    }
    
    Box(
        modifier = Modifier
            .fillMaxWidth()
            .height(headerHeight)
            .background(
                Brush.verticalGradient(
                    colors = getEmotionalColors(contact.relationshipScore),
                    startY = 0f,
                    endY = headerHeight.value
                )
            )
    ) {
        // å¤´åƒã€å§“åã€ç›¸è¯†æ—¶é•¿
    }
}
```

#### 1.2. æ ¸å¿ƒæ ‡ç­¾é€Ÿè§ˆ (Top Tags)

**å†…å®¹**ï¼š
- ä»…å±•ç¤º 3-5 ä¸ªæƒé‡æœ€é«˜çš„æ ‡ç­¾
- ä¾‹å¦‚ï¼š"å–œæ¬¢åƒè¾£"ã€"çŒ«å¥´"ã€"å·¥ä½œç‹‚"

**æ ·å¼**ï¼š
- é‡‡ç”¨**é«˜é¥±å’Œåº¦çš„å®å¿ƒèƒ¶å›Šæ ·å¼**ï¼Œå¼ºè°ƒç¡®å®šæ€§
- èƒŒæ™¯è‰²æ ¹æ®æ ‡ç­¾ç±»å‹å˜åŒ–ï¼ˆå…´è¶£çˆ±å¥½ã€æ€§æ ¼ç‰¹å¾ã€ç¦å¿Œè¯é¢˜ï¼‰

**æŠ€æœ¯å®ç°**ï¼š
```kotlin
@Composable
fun TopTagsSection(tags: List<Fact>) {
    LazyRow(
        horizontalArrangement = Arrangement.spacedBy(8.dp),
        contentPadding = PaddingValues(horizontal = 16.dp)
    ) {
        items(tags.take(5)) { tag ->
            SolidTagChip(
                text = tag.value,
                confidence = tag.confidence,
                backgroundColor = getTagColor(tag.key)
            )
        }
    }
}
```

#### 1.3. æœ€æ–°åŠ¨æ€å¡ç‰‡ (Latest Fact Hook)

**åŠ¨æœº**ï¼š
- å±•ç¤ºæœ€è¿‘ä¸€æ¬¡å…³é”®äº’åŠ¨æˆ–AIçš„æœ€æ–°æ´å¯Ÿ
- ä½œä¸ºæƒ…æ„Ÿé’©å­ï¼Œå¸å¼•ç”¨æˆ·ç»§ç»­æ¢ç´¢

**æ ·å¼**ï¼š
- ä¸€ä¸ªæ¨ªå‘çš„ç£¨ç ‚ç»ç’ƒå¡ç‰‡
- å·¦ä¾§å¿…é¡»æœ‰ä¸€ä¸ªå°çš„è£…é¥°æ€§å›¾æ ‡ï¼ˆå¦‚çˆ±å¿ƒâ¤ï¸æˆ–é—ªç”µâš¡ï¼‰
- å¼ºè°ƒè¿™æ˜¯ä¸€æ¡"åŠ¨æ€"è€Œéé™æ€æ•°æ®

**æŠ€æœ¯å®ç°**ï¼š
```kotlin
@Composable
fun LatestFactHookCard(latestFact: Fact?) {
    if (latestFact != null) {
        GlassmorphicCard(
            modifier = Modifier
                .fillMaxWidth()
                .padding(16.dp)
        ) {
            Row(
                modifier = Modifier.padding(16.dp),
                horizontalArrangement = Arrangement.spacedBy(12.dp)
            ) {
                Icon(
                    imageVector = Icons.Default.Favorite,
                    contentDescription = null,
                    tint = Color(0xFFFF6B9D),
                    modifier = Modifier.size(24.dp)
                )
                Column {
                    Text(
                        text = "æœ€æ–°å‘ç°",
                        style = MaterialTheme.typography.labelMedium,
                        color = MaterialTheme.colorScheme.primary
                    )
                    Text(
                        text = latestFact.value,
                        style = MaterialTheme.typography.bodyMedium
                    )
                    Text(
                        text = formatRelativeTime(latestFact.timestamp),
                        style = MaterialTheme.typography.bodySmall,
                        color = MaterialTheme.colorScheme.onSurfaceVariant
                    )
                }
            }
        }
    }
}
```

---

*ï¼ˆæ–‡æ¡£ç»§ç»­ï¼Œè¯·æŸ¥çœ‹åç»­éƒ¨åˆ†ï¼‰*

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æœ€åæ›´æ–°**: 2025-12-14  
**æ›´æ–°è€…**: Kiro

## ğŸ“± ç•Œé¢äºŒï¼šäº‹å®æµ (Fact Stream) - æ ¸å¿ƒåŠŸèƒ½åŒº

### åŠ¨æœº (Motivation)

æ‹çˆ±å…³ç³»æ˜¯ç”±æ— æ•°ç»†èŠ‚å’Œäº‹ä»¶å †ç Œè€Œæˆçš„ã€‚ç”¨æˆ·æ—¢éœ€è¦ï¼š
- **æ²‰æµ¸å¼åœ°"å›å‘³"è¿‡å»**ï¼ˆå™äº‹éœ€æ±‚ï¼‰
- **é«˜æ•ˆåœ°"æŸ¥æ‰¾"ç‰¹å®šä¿¡æ¯**ï¼ˆæ£€ç´¢éœ€æ±‚ï¼‰

å•ä¸€è§†å›¾æ— æ³•æ»¡è¶³è¿™ä¸¤ç§æˆªç„¶ä¸åŒçš„å¿ƒæ™ºæ¨¡å‹ã€‚

### è§£å†³æ–¹æ¡ˆï¼šåŒè§†å›¾åˆ‡æ¢æ¨¡å¼

#### é¡¶éƒ¨æ§ä»¶ (Top Controls)

**å¿…é¡»åŒ…å«**ï¼š
1. **åˆ†æ®µæ§åˆ¶å™¨ (Segmented Control)**ï¼šåœ¨"æ—¶å…‰è½´"å’Œ"æ¸…å•åˆ—è¡¨"ä¹‹é—´åˆ‡æ¢
2. **ç­›é€‰/æ›´å¤šèœå•å…¥å£**ï¼šç”¨äºåç»­çš„é«˜çº§æ£€ç´¢

**æŠ€æœ¯å®ç°**ï¼š
```kotlin
@Composable
fun FactStreamTopBar(
    viewMode: ViewMode,
    onViewModeChange: (ViewMode) -> Unit,
    onFilterClick: () -> Unit
) {
    Row(
        modifier = Modifier
            .fillMaxWidth()
            .padding(16.dp),
        horizontalArrangement = Arrangement.SpaceBetween,
        verticalAlignment = Alignment.CenterVertically
    ) {
        // åˆ†æ®µæ§åˆ¶å™¨
        SegmentedControl(
            items = listOf("æ—¶å…‰è½´", "æ¸…å•"),
            selectedIndex = if (viewMode == ViewMode.Timeline) 0 else 1,
            onItemSelected = { index ->
                onViewModeChange(if (index == 0) ViewMode.Timeline else ViewMode.List)
            }
        )
        
        // ç­›é€‰æŒ‰é’®
        IconButton(onClick = onFilterClick) {
            Icon(Icons.Default.FilterList, "ç­›é€‰")
        }
    }
}
```

### è§†å›¾æ¨¡å¼ Aï¼šæ—¶å…‰è½´ (Timeline View) - æ²‰æµ¸å™äº‹

**è®¾è®¡ç›®æ ‡**ï¼š
- ç¾è§‚ã€æƒ…æ„ŸåŒ–
- åƒæµè§ˆç²¾ç¾æ‰‹è´¦æˆ–ç¤¾äº¤åª’ä½“ä¸€æ ·å›é¡¾å†å²

**å¸ƒå±€ç»“æ„**ï¼š
- ç±»ä¼¼ Pinterest çš„ç€‘å¸ƒæµå¸ƒå±€ï¼Œå¼ºè°ƒè§†è§‰å¤šæ ·æ€§
- ä½¿ç”¨ `StaggeredGridCells` å®ç°

#### å…³é”®è§†è§‰ç‰¹å¾

**1. æƒ…ç»ªèŠ‚ç‚¹ (Emotional Nodes)**

- å·¦ä¾§çš„æ—¶é—´è½´çº¿æ¡ä¸Šï¼Œä»£è¡¨äº‹ä»¶çš„èŠ‚ç‚¹ä¸å†æ˜¯æ¯ç‡¥çš„åœ†ç‚¹
- æ ¹æ®è¯¥äº‹ä»¶AIåˆ†æå‡ºçš„æƒ…ç»ªæ˜¾ç¤ºçš„**å¾®å‹Emoji**ï¼š
  - â¤ï¸ ä»£è¡¨ç”œèœœäº’åŠ¨
  - â›ˆï¸ ä»£è¡¨å†²çª
  - ğŸ ä»£è¡¨ç¤¼ç‰©äº¤æ¢
  - ğŸ½ï¸ ä»£è¡¨çº¦ä¼šç”¨é¤
  - ğŸ’¬ ä»£è¡¨æ·±åº¦å¯¹è¯

**æŠ€æœ¯å®ç°**ï¼š
```kotlin
@Composable
fun EmotionalTimelineNode(emotion: EmotionType) {
    val emoji = when (emotion) {
        EmotionType.SWEET -> "â¤ï¸"
        EmotionType.CONFLICT -> "â›ˆï¸"
        EmotionType.GIFT -> "ğŸ"
        EmotionType.DATE -> "ğŸ½ï¸"
        EmotionType.DEEP_TALK -> "ğŸ’¬"
        else -> "â­•"
    }
    
    Box(
        modifier = Modifier
            .size(32.dp)
            .background(
                color = MaterialTheme.colorScheme.surface.copy(alpha = 0.9f),
                shape = CircleShape
            )
            .border(
                width = 2.dp,
                color = MaterialTheme.colorScheme.primary.copy(alpha = 0.3f),
                shape = CircleShape
            ),
        contentAlignment = Alignment.Center
    ) {
        Text(
            text = emoji,
            fontSize = 16.sp
        )
    }
}
```

**2. å¤šæ ·åŒ–å¡ç‰‡ (Diverse Cards)**

**å›¾æ–‡å¡ç‰‡**ï¼š
- å±•ç¤ºç…§ç‰‡å’Œç®€çŸ­æè¿°ï¼Œç±»ä¼¼æœ‹å‹åœˆåŠ¨æ€
- é‡‡ç”¨ç£¨ç ‚ç»ç’ƒæ•ˆæœ

**AIæ€»ç»“å¡ç‰‡**ï¼š
- å…·æœ‰ç‰¹æ®Šçš„è§†è§‰é£æ ¼ï¼ˆæ›´å¼ºçš„ç£¨ç ‚æ„Ÿæˆ–ç‰¹æ®Šçš„æ¸å˜èƒŒæ™¯ï¼‰
- ç”¨äºå±•ç¤ºAIå¯¹ä¸€æ®µæ—¶é—´çš„å¤ç›˜ï¼ˆå¦‚"ä»Šæ—¥æƒ…æ„Ÿæ™´é›¨è¡¨"ï¼‰
- å¸¦æœ‰AIå›¾æ ‡æ ‡è¯†

**é‡Œç¨‹ç¢‘æ¨ªå¹… (Milestone Banner)**ï¼š
- å®½åº¦è´¯ç©¿å±å¹•çš„é†’ç›®å¡ç‰‡
- ç”¨äºæ ‡è®°é‡å¤§äº‹ä»¶ï¼ˆå¦‚"ç¬¬ä¸€æ¬¡æ—…è¡Œ"ã€"ç›¸è¯†100å¤©"ï¼‰
- å¸¦æœ‰æ˜Ÿæ ‡â­æˆ–å¥–æ¯ğŸ†å›¾æ ‡

**æŠ€æœ¯å®ç°**ï¼š
```kotlin
@Composable
fun TimelineCard(item: TimelineItem) {
    when (item) {
        is TimelineItem.PhotoMoment -> PhotoMomentCard(item)
        is TimelineItem.AiSummary -> AiSummaryCard(item)
        is TimelineItem.Milestone -> MilestoneCard(item)
        is TimelineItem.Conversation -> ConversationCard(item)
    }
}

@Composable
fun AiSummaryCard(summary: DailySummary) {
    GlassmorphicCard(
        modifier = Modifier
            .fillMaxWidth()
            .padding(8.dp),
        backgroundColor = MaterialTheme.colorScheme.primaryContainer.copy(alpha = 0.3f)
    ) {
        Column(modifier = Modifier.padding(16.dp)) {
            Row(
                horizontalArrangement = Arrangement.spacedBy(8.dp),
                verticalAlignment = Alignment.CenterVertically
            ) {
                Icon(
                    imageVector = Icons.Default.Psychology,
                    contentDescription = "AIåˆ†æ",
                    tint = MaterialTheme.colorScheme.primary
                )
                Text(
                    text = "AI æƒ…æ„Ÿæ™´é›¨è¡¨",
                    style = MaterialTheme.typography.titleSmall,
                    color = MaterialTheme.colorScheme.primary
                )
            }
            Spacer(modifier = Modifier.height(8.dp))
            Text(
                text = summary.content,
                style = MaterialTheme.typography.bodyMedium
            )
        }
    }
}

@Composable
fun MilestoneCard(milestone: Milestone) {
    Card(
        modifier = Modifier
            .fillMaxWidth()
            .padding(vertical = 8.dp),
        colors = CardDefaults.cardColors(
            containerColor = MaterialTheme.colorScheme.tertiaryContainer
        )
    ) {
        Row(
            modifier = Modifier
                .fillMaxWidth()
                .padding(16.dp),
            horizontalArrangement = Arrangement.spacedBy(12.dp),
            verticalAlignment = Alignment.CenterVertically
        ) {
            Text(
                text = "ğŸ†",
                fontSize = 32.sp
            )
            Column {
                Text(
                    text = milestone.title,
                    style = MaterialTheme.typography.titleMedium,
                    fontWeight = FontWeight.Bold
                )
                Text(
                    text = milestone.description,
                    style = MaterialTheme.typography.bodySmall
                )
            }
        }
    }
}
```

### è§†å›¾æ¨¡å¼ Bï¼šæ¸…å•åˆ—è¡¨ (List View) - é«˜æ•ˆæ£€ç´¢

**è®¾è®¡ç›®æ ‡**ï¼š
- æ¸…æ™°ã€ç»“æ„åŒ–ã€é«˜ä¿¡æ¯å¯†åº¦
- ä¾¿äºå¿«é€Ÿæ‰«æå’Œå®šä½

**å¸ƒå±€ç»“æ„**ï¼š
- ä¸¥æ ¼çš„å•åˆ—åˆ—è¡¨ç»“æ„ï¼Œç±»ä¼¼æ•°æ®åº“è§†å›¾

#### åˆ—è¡¨é¡¹ç»„æˆ (Row Anatomy)

**å·¦ä¾§**ï¼šæ—¥æœŸï¼ˆMM-DDï¼‰  
**ä¸­é—´ï¼ˆä¸»ä½“ï¼‰**ï¼š[ç±»åˆ«å›¾æ ‡] + æ ‡é¢˜æ–‡æœ¬  
**å³ä¾§ï¼ˆè¾…åŠ©ï¼‰**ï¼šæ ‡ç­¾èƒ¶å›Š

**æŠ€æœ¯å®ç°**ï¼š
```kotlin
@Composable
fun ListViewRow(item: ConversationLog) {
    Row(
        modifier = Modifier
            .fillMaxWidth()
            .clickable { /* æŸ¥çœ‹è¯¦æƒ… */ }
            .padding(horizontal = 16.dp, vertical = 12.dp),
        horizontalArrangement = Arrangement.spacedBy(12.dp),
        verticalAlignment = Alignment.CenterVertically
    ) {
        // å·¦ä¾§ï¼šæ—¥æœŸ
        Text(
            text = formatDate(item.timestamp, "MM-DD"),
            style = MaterialTheme.typography.labelMedium,
            color = MaterialTheme.colorScheme.onSurfaceVariant,
            modifier = Modifier.width(48.dp)
        )
        
        // ä¸­é—´ï¼šå›¾æ ‡ + æ ‡é¢˜
        Row(
            modifier = Modifier.weight(1f),
            horizontalArrangement = Arrangement.spacedBy(8.dp),
            verticalAlignment = Alignment.CenterVertically
        ) {
            Icon(
                imageVector = getCategoryIcon(item.category),
                contentDescription = null,
                modifier = Modifier.size(20.dp),
                tint = MaterialTheme.colorScheme.primary
            )
            Text(
                text = item.userInput.take(30) + "...",
                style = MaterialTheme.typography.bodyMedium,
                maxLines = 1,
                overflow = TextOverflow.Ellipsis
            )
        }
        
        // å³ä¾§ï¼šæ ‡ç­¾
        if (item.isSummarized) {
            Chip(
                text = "å·²æ€»ç»“",
                backgroundColor = MaterialTheme.colorScheme.primaryContainer,
                textColor = MaterialTheme.colorScheme.onPrimaryContainer
            )
        }
    }
}
```

#### è¾…åŠ©åŠŸèƒ½ï¼šå¿«é€Ÿç­›é€‰

æ­¤æ¨¡å¼ä¸‹ï¼Œé¡¶éƒ¨åº”æ˜¾éœ²å‡ºå¿«é€Ÿç­›é€‰æŒ‰é’®ï¼ˆChipsï¼‰ï¼š
- "åªçœ‹AI"
- "åªçœ‹å†²çª"
- "åªçœ‹çº¦ä¼š"

ç‚¹å‡»å¯å³æ—¶è¿‡æ»¤åˆ—è¡¨ã€‚

**æŠ€æœ¯å®ç°**ï¼š
```kotlin
@Composable
fun QuickFilterChips(
    selectedFilters: Set<FilterType>,
    onFilterToggle: (FilterType) -> Unit
) {
    LazyRow(
        horizontalArrangement = Arrangement.spacedBy(8.dp),
        contentPadding = PaddingValues(horizontal = 16.dp, vertical = 8.dp)
    ) {
        items(FilterType.values()) { filter ->
            FilterChip(
                selected = filter in selectedFilters,
                onClick = { onFilterToggle(filter) },
                label = { Text(filter.displayName) },
                leadingIcon = {
                    Icon(
                        imageVector = filter.icon,
                        contentDescription = null,
                        modifier = Modifier.size(16.dp)
                    )
                }
            )
        }
    }
}
```

---

## ğŸ“± ç•Œé¢ä¸‰ï¼šæ ‡ç­¾ç”»åƒ (Persona Tags)

### åŠ¨æœº (Motivation)

å°†AIå¯¹è”ç³»äººçš„ç†è§£"å¯è§†åŒ–"ã€‚è¿™æ˜¯ç”¨æˆ·ä¸AIå»ºç«‹ä¿¡ä»»çš„å…³é”®ç•Œé¢â€”â€”ç”¨æˆ·éœ€è¦çŸ¥é“AIçš„åˆ¤æ–­ä¾æ®ï¼Œå¹¶æœ‰æƒè¿›è¡Œä¿®æ­£ã€‚

**æ ¸å¿ƒéœ€æ±‚**ï¼šè§†è§‰åŒ–"ç½®ä¿¡åº¦"å·®å¼‚ã€‚

### æ ‡ç­¾åˆ†ç±»

AIå¿…é¡»ç†è§£æ ‡ç­¾æ¥æºåˆ†ä¸ºä¸¤ç±»ï¼Œå¹¶åœ¨UIä¸Šåšå‡ºæ˜ç¡®åŒºåˆ†ï¼š

#### 3.1. ç”¨æˆ·ç¡®è®¤æ ‡ç­¾ (User Confirmed Tags)

**å®šä¹‰**ï¼š
- ç”±ç”¨æˆ·æ‰‹åŠ¨æ·»åŠ ï¼Œæˆ–ç”¨æˆ·å¯¹AIçš„çŒœæµ‹ç‚¹äº†"ç¡®è®¤"çš„æ ‡ç­¾
- æ˜¯é“ä¸€èˆ¬çš„äº‹å®

**è§†è§‰æ ·å¼**ï¼š
- **é«˜é¥±å’Œåº¦å®å¿ƒèƒŒæ™¯è‰²**ï¼ˆå¦‚æ·±ç²‰è‰²ã€æ·±æ©™è‰²ï¼‰
- æ–‡æœ¬å³ä¾§å¿…é¡»å¸¦æœ‰ä¸€ä¸ªå°çš„**å®å¿ƒå¯¹å‹¾å›¾æ ‡ (âœ“)**
- è§†è§‰æ„Ÿå—æ˜¯ç¨³å›ºçš„ã€ç¡®å®šçš„

**æŠ€æœ¯å®ç°**ï¼š
```kotlin
@Composable
fun ConfirmedTag(tag: Fact) {
    Surface(
        shape = RoundedCornerShape(16.dp),
        color = MaterialTheme.colorScheme.primary,
        modifier = Modifier.padding(4.dp)
    ) {
        Row(
            modifier = Modifier.padding(horizontal = 12.dp, vertical = 6.dp),
            horizontalArrangement = Arrangement.spacedBy(4.dp),
            verticalAlignment = Alignment.CenterVertically
        ) {
            Text(
                text = tag.value,
                style = MaterialTheme.typography.labelMedium,
                color = MaterialTheme.colorScheme.onPrimary
            )
            Icon(
                imageVector = Icons.Default.Check,
                contentDescription = "å·²ç¡®è®¤",
                modifier = Modifier.size(14.dp),
                tint = MaterialTheme.colorScheme.onPrimary
            )
        }
    }
}
```

#### 3.2. AIæ¨æµ‹æ ‡ç­¾ (AI Guessed Tags)

**å®šä¹‰**ï¼š
- AIé€šè¿‡åˆ†æèŠå¤©è®°å½•æˆ–äº‹å®æµæ¨æ–­å‡ºçš„æ½œåœ¨ç‰¹å¾
- å°šæœªç»ç”¨æˆ·ç¡®è®¤

**è§†è§‰æ ·å¼**ï¼š
- **åŠé€æ˜/ç£¨ç ‚ç»ç’ƒèƒŒæ™¯**ï¼Œæˆ–è€…ä»…æœ‰ç»†è¾¹æ¡†æè¾¹ (Outlined)
- æ²¡æœ‰å¯¹å‹¾å›¾æ ‡ï¼Œæˆ–è€…å¸¦æœ‰ä¸€ä¸ª**é—®å·/è™šçº¿åœ†åœˆå›¾æ ‡ (?)**
- **åŠ¨æ€æ•ˆæœï¼ˆå¯é€‰ï¼‰**ï¼šå¸¦æœ‰æå…¶è½»å¾®çš„"å‘¼å¸"åŠ¨æ•ˆï¼ˆé€æ˜åº¦ç¼“æ…¢å˜åŒ–ï¼‰
- æš—ç¤ºå…¶ä¸ç¡®å®šæ€§å’Œ"æ€è€ƒä¸­"çš„çŠ¶æ€

**äº¤äº’é¢„æœŸ**ï¼š
- ç‚¹å‡»è¿™ç±»æ ‡ç­¾åº”å¼¹å‡ºä¸€ä¸ªé€‰é¡¹
- è®©ç”¨æˆ·é€‰æ‹©"ç¡®è®¤ï¼ˆå˜ä¸ºå®å¿ƒï¼‰"æˆ–"é©³å›ï¼ˆåˆ é™¤ï¼‰"

**æŠ€æœ¯å®ç°**ï¼š
```kotlin
@Composable
fun GuessedTag(
    tag: Fact,
    onConfirm: () -> Unit,
    onReject: () -> Unit
) {
    var showDialog by remember { mutableStateOf(false) }
    
    // å‘¼å¸åŠ¨æ•ˆ
    val alpha by rememberInfiniteTransition().animateFloat(
        initialValue = 0.6f,
        targetValue = 0.9f,
        animationSpec = infiniteRepeatable(
            animation = tween(2000, easing = LinearEasing),
            repeatMode = RepeatMode.Reverse
        )
    )
    
    Surface(
        shape = RoundedCornerShape(16.dp),
        color = MaterialTheme.colorScheme.surfaceVariant.copy(alpha = alpha),
        border = BorderStroke(
            width = 1.dp,
            color = MaterialTheme.colorScheme.outline.copy(alpha = 0.5f)
        ),
        modifier = Modifier
            .padding(4.dp)
            .clickable { showDialog = true }
    ) {
        Row(
            modifier = Modifier.padding(horizontal = 12.dp, vertical = 6.dp),
            horizontalArrangement = Arrangement.spacedBy(4.dp),
            verticalAlignment = Alignment.CenterVertically
        ) {
            Text(
                text = tag.value,
                style = MaterialTheme.typography.labelMedium,
                color = MaterialTheme.colorScheme.onSurfaceVariant
            )
            Icon(
                imageVector = Icons.Default.HelpOutline,
                contentDescription = "AIæ¨æµ‹",
                modifier = Modifier.size(14.dp),
                tint = MaterialTheme.colorScheme.onSurfaceVariant.copy(alpha = 0.6f)
            )
        }
    }
    
    if (showDialog) {
        TagConfirmationDialog(
            tag = tag,
            onConfirm = {
                onConfirm()
                showDialog = false
            },
            onReject = {
                onReject()
                showDialog = false
            },
            onDismiss = { showDialog = false }
        )
    }
}

@Composable
fun TagConfirmationDialog(
    tag: Fact,
    onConfirm: () -> Unit,
    onReject: () -> Unit,
    onDismiss: () -> Unit
) {
    AlertDialog(
        onDismissRequest = onDismiss,
        title = { Text("ç¡®è®¤æ ‡ç­¾") },
        text = {
            Column {
                Text("AI æ¨æµ‹ï¼š${tag.value}")
                Spacer(modifier = Modifier.height(8.dp))
                Text(
                    text = "ç½®ä¿¡åº¦ï¼š${(tag.confidence * 100).toInt()}%",
                    style = MaterialTheme.typography.bodySmall,
                    color = MaterialTheme.colorScheme.onSurfaceVariant
                )
            }
        },
        confirmButton = {
            TextButton(onClick = onConfirm) {
                Text("ç¡®è®¤")
            }
        },
        dismissButton = {
            Row {
                TextButton(onClick = onReject) {
                    Text("é©³å›", color = MaterialTheme.colorScheme.error)
                }
                TextButton(onClick = onDismiss) {
                    Text("å–æ¶ˆ")
                }
            }
        }
    )
}
```

### 3.3. å¸ƒå±€ç»“æ„

æ ‡ç­¾åº”æŒ‰ç…§é€»è¾‘ç»´åº¦è¿›è¡Œåˆ†ç±»å±•ç¤ºï¼Œä½¿ç”¨æ¸…æ™°çš„å°æ ‡é¢˜åˆ†éš”ï¼š

- **åŸºæœ¬å±æ€§**ï¼šå¹´é¾„ã€èŒä¸šã€å±…ä½åœ°ç­‰
- **å…´è¶£çˆ±å¥½**ï¼šå–œæ¬¢çš„é£Ÿç‰©ã€è¿åŠ¨ã€å¨±ä¹ç­‰
- **æ€§æ ¼ç‰¹å¾**ï¼šå¤–å‘/å†…å‘ã€ä¹è§‚/æ‚²è§‚ç­‰
- **ä»·å€¼è§‚**ï¼šå¯¹å·¥ä½œã€å®¶åº­ã€é‡‘é’±çš„æ€åº¦
- **ç¦å¿Œè¯é¢˜**ï¼šä¸è¦æåŠçš„æ•æ„Ÿè¯é¢˜

**æŠ€æœ¯å®ç°**ï¼š
```kotlin
@Composable
fun PersonaTagsSection(facts: List<Fact>) {
    val groupedFacts = facts.groupBy { it.key }
    
    LazyColumn(
        modifier = Modifier.fillMaxSize(),
        contentPadding = PaddingValues(16.dp),
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        groupedFacts.forEach { (category, tags) ->
            item {
                Text(
                    text = getCategoryDisplayName(category),
                    style = MaterialTheme.typography.titleSmall,
                    color = MaterialTheme.colorScheme.primary,
                    modifier = Modifier.padding(bottom = 8.dp)
                )
            }
            
            item {
                FlowRow(
                    horizontalArrangement = Arrangement.spacedBy(8.dp),
                    verticalArrangement = Arrangement.spacedBy(8.dp)
                ) {
                    tags.forEach { tag ->
                        if (tag.source == "MANUAL" || tag.confidence >= 0.8f) {
                            ConfirmedTag(tag)
                        } else {
                            GuessedTag(
                                tag = tag,
                                onConfirm = { /* ç¡®è®¤æ ‡ç­¾ */ },
                                onReject = { /* é©³å›æ ‡ç­¾ */ }
                            )
                        }
                    }
                }
            }
        }
    }
}
```

---

*ï¼ˆæ–‡æ¡£ç»§ç»­ï¼Œè¯·æŸ¥çœ‹åç»­éƒ¨åˆ†ï¼‰*

## ğŸ“± ç•Œé¢å››ï¼šèµ„æ–™åº“ (Data Vault)

### åŠ¨æœº (Motivation)

æä¾›é€æ˜åº¦ï¼Œå±•ç¤ºAIåˆ†æçš„åŸææ–™æ¥æºï¼Œå¹¶æä¾›ä¸Šä¼ æ–°æ•°æ®çš„å…¥å£ã€‚

### æ ·å¼

ç±»ä¼¼äºç°ä»£æ–‡ä»¶ç®¡ç†å™¨çš„ç½‘æ ¼è§†å›¾ (Grid View)ã€‚

### å…ƒç´ 

ä½¿ç”¨æ–‡ä»¶å¤¹å›¾æ ‡ä»£è¡¨ä¸åŒç±»å‹çš„æ•°æ®æºï¼š
- ğŸ’¬ èŠå¤©è®°å½•
- ğŸ¤ è¯­éŸ³è®°å½•
- ğŸ“· å›¾ç‰‡/è§†é¢‘

### çŠ¶æ€æŒ‡ç¤ºå™¨

æ¯ä¸ªæ–‡ä»¶å¤¹æˆ–æ–‡ä»¶è§’æ ‡éœ€æ¸…æ™°æ˜¾ç¤ºå…¶å¤„ç†çŠ¶æ€ï¼š
- âœ… **ç»¿è‰²å¯¹å‹¾**ï¼šå·²åˆ†æå®Œæˆï¼Œæ•°æ®å·²åˆå…¥äº‹å®æµå’Œç”»åƒ
- ğŸ•’ **é»„è‰²/ç°è‰²æ—¶é’Ÿæˆ–åŠ è½½åœˆ**ï¼šæ­£åœ¨æ’é˜Ÿæˆ–åˆ†æä¸­
- âŒ **çº¢è‰²å‰å·**ï¼šåˆ†æå¤±è´¥

**æŠ€æœ¯å®ç°**ï¼š
```kotlin
@Composable
fun DataVaultScreen(
    conversationCount: Int,
    summaryCount: Int,
    onNavigateToConversations: () -> Unit,
    onNavigateToSummaries: () -> Unit
) {
    LazyVerticalGrid(
        columns = GridCells.Fixed(2),
        contentPadding = PaddingValues(16.dp),
        horizontalArrangement = Arrangement.spacedBy(16.dp),
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        item {
            DataSourceCard(
                icon = "ğŸ’¬",
                title = "èŠå¤©è®°å½•",
                count = conversationCount,
                status = DataStatus.COMPLETED,
                onClick = onNavigateToConversations
            )
        }
        
        item {
            DataSourceCard(
                icon = "ğŸ“Š",
                title = "æ¯æ—¥æ€»ç»“",
                count = summaryCount,
                status = DataStatus.COMPLETED,
                onClick = onNavigateToSummaries
            )
        }
        
        item {
            DataSourceCard(
                icon = "ğŸ¤",
                title = "è¯­éŸ³è®°å½•",
                count = 0,
                status = DataStatus.NOT_AVAILABLE,
                onClick = { /* æœªå®ç° */ }
            )
        }
        
        item {
            DataSourceCard(
                icon = "ğŸ“·",
                title = "å›¾ç‰‡/è§†é¢‘",
                count = 0,
                status = DataStatus.NOT_AVAILABLE,
                onClick = { /* æœªå®ç° */ }
            )
        }
    }
}

@Composable
fun DataSourceCard(
    icon: String,
    title: String,
    count: Int,
    status: DataStatus,
    onClick: () -> Unit
) {
    Card(
        modifier = Modifier
            .fillMaxWidth()
            .aspectRatio(1f)
            .clickable(enabled = status != DataStatus.NOT_AVAILABLE, onClick = onClick),
        colors = CardDefaults.cardColors(
            containerColor = MaterialTheme.colorScheme.surfaceVariant.copy(
                alpha = if (status == DataStatus.NOT_AVAILABLE) 0.3f else 1f
            )
        )
    ) {
        Box(
            modifier = Modifier.fillMaxSize(),
            contentAlignment = Alignment.Center
        ) {
            Column(
                horizontalAlignment = Alignment.CenterHorizontally,
                verticalArrangement = Arrangement.spacedBy(8.dp)
            ) {
                Text(
                    text = icon,
                    fontSize = 48.sp
                )
                Text(
                    text = title,
                    style = MaterialTheme.typography.titleMedium
                )
                Text(
                    text = "$count æ¡",
                    style = MaterialTheme.typography.bodySmall,
                    color = MaterialTheme.colorScheme.onSurfaceVariant
                )
            }
            
            // çŠ¶æ€è§’æ ‡
            Box(
                modifier = Modifier
                    .align(Alignment.TopEnd)
                    .padding(8.dp)
            ) {
                StatusBadge(status)
            }
        }
    }
}

@Composable
fun StatusBadge(status: DataStatus) {
    val (icon, color) = when (status) {
        DataStatus.COMPLETED -> "âœ…" to Color.Green
        DataStatus.PROCESSING -> "ğŸ•’" to Color.Yellow
        DataStatus.FAILED -> "âŒ" to Color.Red
        DataStatus.NOT_AVAILABLE -> "âšª" to Color.Gray
    }
    
    Text(
        text = icon,
        fontSize = 20.sp,
        modifier = Modifier
            .background(
                color = color.copy(alpha = 0.2f),
                shape = CircleShape
            )
            .padding(4.dp)
    )
}
```

---

## ğŸ¨ é€šç”¨UIç»„ä»¶åº“

### ç£¨ç ‚ç»ç’ƒå¡ç‰‡ (Glassmorphic Card)

```kotlin
@Composable
fun GlassmorphicCard(
    modifier: Modifier = Modifier,
    backgroundColor: Color = MaterialTheme.colorScheme.surface.copy(alpha = 0.7f),
    content: @Composable () -> Unit
) {
    Surface(
        modifier = modifier,
        shape = RoundedCornerShape(16.dp),
        color = backgroundColor,
        border = BorderStroke(
            width = 1.dp,
            color = Color.White.copy(alpha = 0.2f)
        ),
        shadowElevation = 8.dp
    ) {
        Box(
            modifier = Modifier
                .background(
                    Brush.verticalGradient(
                        colors = listOf(
                            Color.White.copy(alpha = 0.1f),
                            Color.Transparent
                        )
                    )
                )
        ) {
            content()
        }
    }
}
```

### åˆ†æ®µæ§åˆ¶å™¨ (Segmented Control)

```kotlin
@Composable
fun SegmentedControl(
    items: List<String>,
    selectedIndex: Int,
    onItemSelected: (Int) -> Unit,
    modifier: Modifier = Modifier
) {
    Surface(
        modifier = modifier,
        shape = RoundedCornerShape(12.dp),
        color = MaterialTheme.colorScheme.surfaceVariant
    ) {
        Row(modifier = Modifier.padding(4.dp)) {
            items.forEachIndexed { index, item ->
                val isSelected = index == selectedIndex
                Surface(
                    modifier = Modifier
                        .weight(1f)
                        .clickable { onItemSelected(index) },
                    shape = RoundedCornerShape(8.dp),
                    color = if (isSelected) {
                        MaterialTheme.colorScheme.primary
                    } else {
                        Color.Transparent
                    }
                ) {
                    Text(
                        text = item,
                        modifier = Modifier.padding(vertical = 8.dp, horizontal = 16.dp),
                        textAlign = TextAlign.Center,
                        style = MaterialTheme.typography.labelLarge,
                        color = if (isSelected) {
                            MaterialTheme.colorScheme.onPrimary
                        } else {
                            MaterialTheme.colorScheme.onSurfaceVariant
                        }
                    )
                }
            }
        }
    }
}
```

---

## ğŸš€ å®æ–½è®¡åˆ’

### é˜¶æ®µ1ï¼šå…¨å±€è®¾è®¡ç³»ç»Ÿï¼ˆ2-3å¤©ï¼‰

- [ ] å®ç°æƒ…æ„ŸåŒ–èƒŒæ™¯å…‰æ™•ç³»ç»Ÿ
- [ ] åˆ›å»ºç£¨ç ‚ç»ç’ƒå¡ç‰‡ç»„ä»¶
- [ ] å®ç°æµä½“åˆ‡æ¢åŠ¨ç”»
- [ ] åˆ›å»ºåˆ†æ®µæ§åˆ¶å™¨ç»„ä»¶

### é˜¶æ®µ2ï¼šç•Œé¢ä¸€ - æ¦‚è§ˆï¼ˆ2-3å¤©ï¼‰

- [ ] å®ç°åŠ¨æ€æƒ…æ„Ÿå¤´éƒ¨
- [ ] å®ç°æ ¸å¿ƒæ ‡ç­¾é€Ÿè§ˆ
- [ ] å®ç°æœ€æ–°åŠ¨æ€å¡ç‰‡
- [ ] é›†æˆåˆ°ContactDetailScreen

### é˜¶æ®µ3ï¼šç•Œé¢äºŒ - äº‹å®æµï¼ˆ3-4å¤©ï¼‰

- [ ] å®ç°æ—¶å…‰è½´è§†å›¾ï¼ˆç€‘å¸ƒæµå¸ƒå±€ï¼‰
- [ ] å®ç°æƒ…ç»ªèŠ‚ç‚¹ç³»ç»Ÿ
- [ ] å®ç°å¤šæ ·åŒ–å¡ç‰‡ï¼ˆå›¾æ–‡ã€AIæ€»ç»“ã€é‡Œç¨‹ç¢‘ï¼‰
- [ ] å®ç°æ¸…å•åˆ—è¡¨è§†å›¾
- [ ] å®ç°å¿«é€Ÿç­›é€‰åŠŸèƒ½
- [ ] å®ç°åŒè§†å›¾åˆ‡æ¢

### é˜¶æ®µ4ï¼šç•Œé¢ä¸‰ - æ ‡ç­¾ç”»åƒï¼ˆ2-3å¤©ï¼‰

- [ ] å®ç°ç”¨æˆ·ç¡®è®¤æ ‡ç­¾ç»„ä»¶
- [ ] å®ç°AIæ¨æµ‹æ ‡ç­¾ç»„ä»¶ï¼ˆå«å‘¼å¸åŠ¨æ•ˆï¼‰
- [ ] å®ç°æ ‡ç­¾ç¡®è®¤å¯¹è¯æ¡†
- [ ] å®ç°æ ‡ç­¾åˆ†ç±»å¸ƒå±€
- [ ] é›†æˆæ ‡ç­¾ç®¡ç†åŠŸèƒ½

### é˜¶æ®µ5ï¼šç•Œé¢å›› - èµ„æ–™åº“ï¼ˆ1-2å¤©ï¼‰

- [ ] å®ç°æ•°æ®æºå¡ç‰‡
- [ ] å®ç°çŠ¶æ€è§’æ ‡
- [ ] å®ç°ç½‘æ ¼å¸ƒå±€
- [ ] æ·»åŠ å¯¼èˆªåŠŸèƒ½

### é˜¶æ®µ6ï¼šViewModelå’Œæ•°æ®é›†æˆï¼ˆ2-3å¤©ï¼‰

- [ ] åˆ›å»ºContactDetailViewModelå¢å¼ºç‰ˆ
- [ ] åˆ›å»ºMemoryTimelineViewModel
- [ ] å®ç°æ•°æ®åŠ è½½é€»è¾‘
- [ ] å®ç°çŠ¶æ€ç®¡ç†

### é˜¶æ®µ7ï¼šæµ‹è¯•å’Œä¼˜åŒ–ï¼ˆ2-3å¤©ï¼‰

- [ ] å•å…ƒæµ‹è¯•
- [ ] UIæµ‹è¯•
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆåŠ¨ç”»æµç•…åº¦ï¼‰
- [ ] ç”¨æˆ·ä½“éªŒä¼˜åŒ–

**æ€»è®¡é¢„ä¼°å·¥ä½œé‡**ï¼š14-21å¤©

---

## ğŸ“Š æ•°æ®æ¨¡å‹æ˜ å°„

### åç«¯æ•°æ® â†’ å‰ç«¯å±•ç¤º

| åç«¯æ¨¡å‹ | å‰ç«¯ç»„ä»¶ | è§†è§‰è¡¨ç° |
|---------|---------|---------|
| `ContactProfile.relationshipScore` | èƒŒæ™¯å…‰æ™•é¢œè‰² | 81-100: æš–è‰², 61-80: é»„ç»¿, 31-60: è“ç°, 0-30: å†·è“ |
| `Fact.source = "MANUAL"` | å®å¿ƒæ ‡ç­¾ + âœ“ | é«˜é¥±å’Œåº¦èƒŒæ™¯è‰² |
| `Fact.source = "AI_INFERRED"` | ç£¨ç ‚æ ‡ç­¾ + ? | åŠé€æ˜èƒŒæ™¯ + å‘¼å¸åŠ¨æ•ˆ |
| `Fact.confidence` | æ ‡ç­¾é€æ˜åº¦ | 0.8-1.0: å®å¿ƒ, 0.5-0.8: åŠé€æ˜, <0.5: è™šçº¿è¾¹æ¡† |
| `ConversationLog.isSummarized` | åˆ—è¡¨é¡¹æ ‡ç­¾ | "å·²æ€»ç»“"ç»¿è‰² / "æœªæ€»ç»“"ç°è‰² |
| `DailySummary.keyEvents` | æ—¶å…‰è½´èŠ‚ç‚¹ | æ ¹æ®äº‹ä»¶ç±»å‹æ˜¾ç¤ºä¸åŒEmoji |
| `DailySummary.relationshipScore` | åˆ†æ•°å¾½ç«  | é¢œè‰²ç¼–ç  + è¶‹åŠ¿ç®­å¤´ |

---

## ğŸ¯ æˆåŠŸæŒ‡æ ‡

### æƒ…æ„ŸåŒ–ä½“éªŒ

- [ ] èƒŒæ™¯å…‰æ™•èƒ½æ ¹æ®å…³ç³»åˆ†æ•°å®æ—¶å˜åŒ–
- [ ] æ ‡ç­¾çš„è§†è§‰å·®å¼‚èƒ½æ¸…æ™°ä¼ è¾¾ç½®ä¿¡åº¦
- [ ] åŠ¨ç”»è¿‡æ¸¡æµç•…ï¼Œæ— å¡é¡¿ï¼ˆ60fpsï¼‰
- [ ] ç”¨æˆ·èƒ½æ„Ÿå—åˆ°ç•Œé¢çš„"æ¸©åº¦"

### åŠŸèƒ½å®Œæ•´æ€§

- [ ] æ‰€æœ‰åç«¯æ•°æ®éƒ½æœ‰å¯¹åº”çš„UIå±•ç¤º
- [ ] åŒè§†å›¾åˆ‡æ¢æµç•…è‡ªç„¶
- [ ] æ ‡ç­¾ç¡®è®¤/é©³å›åŠŸèƒ½æ­£å¸¸
- [ ] æ•°æ®ç­›é€‰åŠŸèƒ½å‡†ç¡®

### ç”¨æˆ·ä½“éªŒ

- [ ] é¡µé¢åŠ è½½æ—¶é—´ < 1ç§’
- [ ] æ“ä½œå“åº”æ—¶é—´ < 300ms
- [ ] åŠ¨ç”»æ—¶é•¿ 200-300ms
- [ ] æ— æ˜æ˜¾çš„æ€§èƒ½é—®é¢˜

---

## ğŸ“š æŠ€æœ¯å®ç°è¦ç‚¹

### 1. æ€§èƒ½ä¼˜åŒ–

**èƒŒæ™¯å…‰æ™•ä¼˜åŒ–**ï¼š
- ä½¿ç”¨ `remember` ç¼“å­˜æ¸å˜è‰²è®¡ç®—
- é¿å…åœ¨æ»šåŠ¨æ—¶é‡æ–°è®¡ç®—

**åˆ—è¡¨ä¼˜åŒ–**ï¼š
- ä½¿ç”¨ `LazyColumn` çš„ `key` å‚æ•°
- é¿å…åœ¨ `items` ä¸­åˆ›å»ºæ–°å¯¹è±¡

**åŠ¨ç”»ä¼˜åŒ–**ï¼š
- ä½¿ç”¨ `animateFloatAsState` è€Œé `animate*`
- é™åˆ¶åŒæ—¶è¿è¡Œçš„åŠ¨ç”»æ•°é‡

### 2. çŠ¶æ€ç®¡ç†

```kotlin
data class ContactDetailUiState(
    val contact: ContactProfile? = null,
    val viewMode: ViewMode = ViewMode.Timeline,
    val selectedFilters: Set<FilterType> = emptySet(),
    val conversations: List<ConversationLog> = emptyList(),
    val summaries: List<DailySummary> = emptyList(),
    val facts: List<Fact> = emptyList(),
    val isLoading: Boolean = false,
    val error: String? = null
)

sealed class ContactDetailUiEvent {
    data class LoadContact(val contactId: String) : ContactDetailUiEvent()
    data class SwitchViewMode(val mode: ViewMode) : ContactDetailUiEvent()
    data class ToggleFilter(val filter: FilterType) : ContactDetailUiEvent()
    data class ConfirmTag(val factId: Long) : ContactDetailUiEvent()
    data class RejectTag(val factId: Long) : ContactDetailUiEvent()
}
```

### 3. ä¾èµ–æ³¨å…¥

```kotlin
@HiltViewModel
class ContactDetailViewModel @Inject constructor(
    private val contactRepository: ContactRepository,
    private val conversationRepository: ConversationRepository,
    private val dailySummaryRepository: DailySummaryRepository
) : ViewModel() {
    // ViewModelå®ç°
}
```

---

## ğŸ“ æ€»ç»“ (For AI)

è¿™ä¸ªUIçš„æ ¸å¿ƒåœ¨äº**"å…³ç³»çŠ¶æ€çš„å¯è§†åŒ–"**ã€‚

ä»èƒŒæ™¯å…‰çš„é¢œè‰²ï¼Œåˆ°æ—¶é—´è½´ä¸Šçš„EmojièŠ‚ç‚¹ï¼Œå†åˆ°æ ‡ç­¾çš„é€æ˜åº¦ï¼Œ**æ¯ä¸€ä¸ªåƒç´ éƒ½åœ¨ä¼ é€’å…³äºè¿™æ®µå…³ç³»çš„æƒ…æ„Ÿå’Œç¡®å®šæ€§ä¿¡æ¯**ã€‚

åœ¨ç”Ÿæˆæˆ–ç†è§£æ­¤UIæ—¶ï¼Œè¯·åŠ¡å¿…å°†è¿™äº›**åŠ¨æ€çš„ã€åŸºäºæ•°æ®çš„è§†è§‰å˜åŒ–**ä½œä¸ºæœ€é«˜ä¼˜å…ˆçº§ã€‚

### å…³é”®è®¾è®¡åŸåˆ™

1. **æƒ…æ„Ÿä¼˜å…ˆ**ï¼šé¢œè‰²ã€åŠ¨ç”»ã€å›¾æ ‡éƒ½è¦ä¼ é€’æƒ…æ„Ÿ
2. **ç½®ä¿¡åº¦å¯è§†åŒ–**ï¼šç”¨æˆ·å¿…é¡»èƒ½çœ‹å‡ºAIçš„ç¡®å®šç¨‹åº¦
3. **æµä½“è¿‡æ¸¡**ï¼šç¦æ­¢ç¡¬åˆ‡ï¼Œæ‰€æœ‰çŠ¶æ€å˜åŒ–éƒ½è¦å¹³æ»‘
4. **åŒæ¨¡å¼æ€ç»´**ï¼šåŒæ—¶æ»¡è¶³æ²‰æµ¸å™äº‹å’Œé«˜æ•ˆæ£€ç´¢

### æŠ€æœ¯æ ˆ

- **UIæ¡†æ¶**ï¼šJetpack Compose + Material Design 3
- **æ¶æ„**ï¼šClean Architecture + MVVM
- **ä¾èµ–æ³¨å…¥**ï¼šHilt
- **çŠ¶æ€ç®¡ç†**ï¼šStateFlow + UiState/UiEvent
- **åŠ¨ç”»**ï¼šCompose Animation API

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [PRD-00003-è”ç³»äººç”»åƒè®°å¿†ç³»ç»Ÿéœ€æ±‚](./PRD-00003-è”ç³»äººç”»åƒè®°å¿†ç³»ç»Ÿéœ€æ±‚.md)
- [FD-00003-è”ç³»äººç”»åƒè®°å¿†ç³»ç»Ÿè®¾è®¡](../FD/FD-00003-è”ç³»äººç”»åƒè®°å¿†ç³»ç»Ÿè®¾è®¡.md)
- [IMPL-00003-è”ç³»äººç”»åƒè®°å¿†ç³»ç»Ÿå®ç°è¿›åº¦](../IMPL/IMPL-00003-è”ç³»äººç”»åƒè®°å¿†ç³»ç»Ÿå®ç°è¿›åº¦.md)
- [HANDOFF-00001-è®°å¿†ç³»ç»ŸUIå¼€å‘çŸ¥è¯†ä¼ é€’](../HANDOFF/HANDOFF-00001-è®°å¿†ç³»ç»ŸUIå¼€å‘çŸ¥è¯†ä¼ é€’.md)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æœ€åæ›´æ–°**: 2025-12-14  
**æ›´æ–°è€…**: Kiro  
**å®¡æ ¸è€…**: å¾…å®¡æ ¸

---

## é™„å½•ï¼šè®¾è®¡å‚è€ƒ

### é¢œè‰²ç³»ç»Ÿ

```kotlin
// å…³ç³»åˆ†æ•°å¯¹åº”çš„é¢œè‰²
object RelationshipColors {
    val Excellent = listOf(Color(0xFFFF6B9D), Color(0xFFFFA06B))  // ç²‰æ©™æ¸å˜
    val Good = listOf(Color(0xFFFFC371), Color(0xFF7FD8BE))       // é»„ç»¿æ¸å˜
    val Normal = listOf(Color(0xFF89B5E0), Color(0xFFB8C5D6))     // è“ç°æ¸å˜
    val Poor = listOf(Color(0xFF6B8CAE), Color(0xFF8B9DAF))       // å†·è“æ¸å˜
}

// æ ‡ç­¾ç±»åˆ«é¢œè‰²
object TagColors {
    val Interest = Color(0xFF4CAF50)      // ç»¿è‰² - å…´è¶£çˆ±å¥½
    val Personality = Color(0xFF2196F3)   // è“è‰² - æ€§æ ¼ç‰¹å¾
    val Value = Color(0xFF9C27B0)         // ç´«è‰² - ä»·å€¼è§‚
    val Taboo = Color(0xFFF44336)         // çº¢è‰² - ç¦å¿Œè¯é¢˜
}
```

### åŠ¨ç”»æ—¶é•¿

```kotlin
object AnimationDurations {
    const val Fast = 200       // å¿«é€ŸåŠ¨ç”»ï¼ˆæŒ‰é’®ç‚¹å‡»ï¼‰
    const val Normal = 300     // æ­£å¸¸åŠ¨ç”»ï¼ˆå¡ç‰‡å±•å¼€ï¼‰
    const val Slow = 500       // æ…¢é€ŸåŠ¨ç”»ï¼ˆé¡µé¢åˆ‡æ¢ï¼‰
    const val Breathing = 2000 // å‘¼å¸åŠ¨æ•ˆ
}
```

### å°ºå¯¸è§„èŒƒ

```kotlin
object Dimensions {
    val HeaderHeightExpanded = 200.dp
    val HeaderHeightCollapsed = 56.dp
    val AvatarSizeLarge = 120.dp
    val AvatarSizeSmall = 40.dp
    val CardCornerRadius = 16.dp
    val TagCornerRadius = 16.dp
    val SpacingSmall = 8.dp
    val SpacingMedium = 16.dp
    val SpacingLarge = 24.dp
}
```

---

**END OF DOCUMENT**
