# PRD-00014-联系人画像界面升级需求

## 1. 文档信息

| 属性 | 内容 |
| --- | --- |
| **文档编号** | PRD-00014 |
| **版本号** | v1.0.0 |
| **状态** | 🟢 待评审 |
| **创建日期** | 2025-12-21 |
| **作者** | Roo |
| **关联任务** | TD-00014 |

## 2. 背景与目标

### 2.1 背景
当前的联系人画像界面（Persona Tab）功能较为基础，存在以下局限性：
1.  **分类固定**：仅支持“雷区标签”和“策略标签”两类，无法展示更丰富的维度（如性格特征、兴趣爱好、背景信息等）。
2.  **交互单一**：缺乏搜索、多选、批量操作等高效管理功能，用户难以管理大量标签。
3.  **展示静态**：缺乏视觉吸引力和动态反馈，无法通过视觉区分不同类型的标签。

### 2.2 目标
升级联系人画像界面，使其成为一个**动态、交互丰富、视觉友好**的个性化信息中心。
1.  **实现动态分类**：支持基于 Fact Key 的自动分组展示，不再限制于预设分类。
2.  **增强交互效率**：提供搜索、长按多选、批量删除/移动等管理功能。
3.  **提升视觉体验**：引入动态配色系统和流畅的布局动画。

## 3. 功能需求

### 3.1 动态标签分类展示
*   **自动分组**：系统应根据标签（Fact）的 Key 字段（如“兴趣爱好”、“性格特征”）自动将标签分组展示。
*   **动态配色**：每个分类应具有独特的颜色标识（标题颜色、标签背景色），系统根据分类名称自动分配协调的颜色。
*   **空状态处理**：若某分类下无标签，则不显示该分类；若整个画像无数据，显示全局空状态。
*   **折叠/展开**：支持点击分类标题折叠或展开该分类下的标签（可选，视标签数量而定）。

### 3.2 标签搜索
*   **搜索入口**：在画像页面顶部提供搜索栏。
*   **实时过滤**：输入关键词时，实时过滤显示匹配的标签（匹配内容或分类名）。
*   **高亮显示**：(可选) 高亮匹配的关键词。

### 3.3 编辑模式与批量操作
*   **进入编辑模式**：长按任意标签进入“编辑模式”。
*   **视觉变化**：
    *   进入编辑模式后，所有标签显示选择框（Checkbox）或选中态样式。
    *   底部弹出“批量操作栏”。
    *   顶部搜索栏变为“已选择 N 项 / 取消”状态栏。
*   **选择操作**：支持点击标签进行选中/取消选中；支持点击分类标题进行该分类的全选/反选。
*   **批量功能**：
    *   **批量删除**：删除选中的标签（需二次确认）。
    *   **批量修改分类**：将选中标签移动到新的分类（修改 Key）。

### 3.4 单个标签交互
*   **查看/编辑**：点击标签弹出详情弹窗，可修改标签内容（Value）和分类（Key）。
*   **确认/驳回**：对于 AI 推断的标签（Guessed Tag），保留原有的确认/驳回交互，或整合进编辑弹窗。

## 4. UI/UX 需求

### 4.1 界面布局
*   **顶部**：搜索栏（Search Bar）。
*   **中间**：滚动列表，包含多个分类区域（Category Section）。
*   **底部**：批量操作栏（仅编辑模式下显示）。

### 4.2 视觉风格
*   **标签样式**：保持圆角风格，增加选中态的视觉区分（如边框变色、出现对勾角标）。
*   **颜色系统**：设计一套柔和的 Pastel 色系调色板，用于动态分配给不同分类。
*   **动画**：
    *   标签列表的增加/删除/过滤应有流畅的 `animateItemPlacement` 动画。
    *   进入/退出编辑模式应有平滑的过渡动画。

## 5. 验收标准
1.  **分类展示**：不同 Key 的 Fact 能正确分组显示，且颜色区分明显。
2.  **搜索功能**：输入关键词能正确过滤出目标标签。
3.  **批量操作**：能成功批量删除标签，数据库同步更新。
4.  **编辑功能**：长按能触发编辑模式，底部操作栏显示正确。
5.  **性能**：在 100+ 标签的情况下，滚动和搜索流畅，无明显卡顿。

## 6. 风险评估
*   **数据迁移**：现有的硬编码分类逻辑去除后，需确保旧数据能正确映射到新分类（直接使用 Key 即可，风险较低）。
*   **颜色适配**：自动生成的颜色需确保在深色模式（Dark Mode）下的可读性。
