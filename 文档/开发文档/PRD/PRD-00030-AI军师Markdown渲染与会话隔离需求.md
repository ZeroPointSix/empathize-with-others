# PRD-00030: AIå†›å¸ˆMarkdownæ¸²æŸ“ä¸ä¼šè¯éš”ç¦»éœ€æ±‚

> **æ–‡æ¡£ç±»å‹**: äº§å“éœ€æ±‚æ–‡æ¡£ (PRD)
> **ç‰ˆæœ¬**: 1.1
> **åˆ›å»ºæ—¥æœŸ**: 2026-01-07
> **æ›´æ–°æ—¥æœŸ**: 2026-01-07
> **è´Ÿè´£äºº**: Kiro
> **çŠ¶æ€**: ğŸ“ éœ€æ±‚è®¨è®º
> **ä¼˜å…ˆçº§**: ğŸ”´ é«˜

---

## ğŸ¯ æ ¸å¿ƒç›®æ ‡

ä¼˜åŒ–AIå†›å¸ˆå¯¹è¯ä½“éªŒï¼Œå®ç°ä¸¤ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼š
1. **Markdownè¯­æ³•æ¸²æŸ“** - AIå›å¤æ”¯æŒåŸºç¡€Markdownæ ¼å¼æ˜¾ç¤º
2. **ä¼šè¯ä¸Šä¸‹æ–‡éš”ç¦»** - æ–°ä¼šè¯åªåŒ…å«è”ç³»äººç”»åƒä¿¡æ¯ï¼Œä¸åŒ…å«å†å²å¯¹è¯

---

## ğŸ“‹ éœ€æ±‚èƒŒæ™¯

### é—®é¢˜1ï¼šAIå›å¤æ ¼å¼å•ä¸€

å½“å‰AIå†›å¸ˆçš„å›å¤å†…å®¹ä»¥çº¯æ–‡æœ¬å½¢å¼æ˜¾ç¤ºï¼Œæ— æ³•å±•ç¤ºç»“æ„åŒ–ä¿¡æ¯ï¼š

**ç”¨æˆ·åé¦ˆ**ï¼š
- "AIå›å¤çš„åˆ—è¡¨é¡¹éƒ½æŒ¤åœ¨ä¸€èµ·ï¼Œçœ‹ä¸æ¸…æ¥š"
- "ä»£ç å»ºè®®æ²¡æœ‰é«˜äº®ï¼Œä¸å¥½å¤åˆ¶"
- "é‡ç‚¹å†…å®¹æ²¡æœ‰åŠ ç²—ï¼Œä¸å¤Ÿé†’ç›®"

**å½±å“**ï¼š
- é™ä½ä¿¡æ¯å¯è¯»æ€§
- å½±å“ç”¨æˆ·ç†è§£AIå»ºè®®
- ä¸ä¸»æµAIäº§å“ä½“éªŒå·®è·å¤§

### é—®é¢˜2ï¼šä¼šè¯ä¸Šä¸‹æ–‡æ··ä¹±

å½“å‰å®ç°ä¸­ï¼ŒAIè·å–çš„å†å²ä¸Šä¸‹æ–‡æ˜¯æŒ‰**è”ç³»äººID**è·å–çš„ï¼Œå¯¼è‡´ï¼š

**å½“å‰è¡Œä¸º**ï¼š
```
ç”¨æˆ·ä¸å¼ ä¸‰çš„ä¼šè¯Aï¼šè®¨è®ºçº¦ä¼šå»ºè®®
ç”¨æˆ·æ–°å»ºä¼šè¯Bï¼šæƒ³è®¨è®ºå·¥ä½œé—®é¢˜
â†’ AIä»ç„¶èƒ½çœ‹åˆ°ä¼šè¯Açš„çº¦ä¼šç›¸å…³å†…å®¹
â†’ ä¸Šä¸‹æ–‡æ··ä¹±ï¼ŒAIå›å¤å¯èƒ½ä¸ç›¸å…³
```

**æœŸæœ›è¡Œä¸º**ï¼š
```
ç”¨æˆ·ä¸å¼ ä¸‰çš„ä¼šè¯Aï¼šè®¨è®ºçº¦ä¼šå»ºè®®
ç”¨æˆ·æ–°å»ºä¼šè¯Bï¼šæƒ³è®¨è®ºå·¥ä½œé—®é¢˜
â†’ AIåªèƒ½çœ‹åˆ°å¼ ä¸‰çš„ç”»åƒä¿¡æ¯ï¼ˆå§“åã€æ ‡ç­¾ã€äº‹å®æµç­‰ï¼‰
â†’ ä¼šè¯Bæ˜¯å…¨æ–°çš„ä¸Šä¸‹æ–‡ï¼ŒAIä¸“æ³¨äºå½“å‰è¯é¢˜
```

---

## ğŸ­ ç”¨æˆ·æ•…äº‹

### US-001: æŸ¥çœ‹æ ¼å¼åŒ–çš„AIå›å¤
**ä½œä¸º** ç”¨æˆ·ï¼Œ
**æˆ‘æƒ³è¦** AIå›å¤èƒ½å¤Ÿæ˜¾ç¤ºMarkdownæ ¼å¼ï¼ˆç²—ä½“ã€åˆ—è¡¨ã€ä»£ç ç­‰ï¼‰ï¼Œ
**ä»¥ä¾¿äº** æ›´æ¸…æ™°åœ°ç†è§£AIçš„å»ºè®®å’Œåˆ†æã€‚

**éªŒæ”¶æ ‡å‡†**ï¼š
- AIå›å¤ä¸­çš„`**ç²—ä½“**`æ˜¾ç¤ºä¸ºç²—ä½“
- AIå›å¤ä¸­çš„`*æ–œä½“*`æ˜¾ç¤ºä¸ºæ–œä½“
- AIå›å¤ä¸­çš„`- åˆ—è¡¨é¡¹`æ˜¾ç¤ºä¸ºé¡¹ç›®ç¬¦å·åˆ—è¡¨
- AIå›å¤ä¸­çš„`1. æœ‰åºåˆ—è¡¨`æ˜¾ç¤ºä¸ºç¼–å·åˆ—è¡¨
- AIå›å¤ä¸­çš„`` `ä»£ç ` ``æ˜¾ç¤ºä¸ºç°è‰²èƒŒæ™¯çš„è¡Œå†…ä»£ç 
- AIå›å¤ä¸­çš„ä»£ç å—æ˜¾ç¤ºä¸ºç°è‰²èƒŒæ™¯åŒºåŸŸ

### US-002: ç‹¬ç«‹çš„ä¼šè¯ä¸Šä¸‹æ–‡
**ä½œä¸º** ç”¨æˆ·ï¼Œ
**æˆ‘æƒ³è¦** æ¯ä¸ªæ–°ä¼šè¯éƒ½æ˜¯ç‹¬ç«‹çš„ä¸Šä¸‹æ–‡ï¼Œ
**ä»¥ä¾¿äº** ä¸AIè®¨è®ºä¸åŒè¯é¢˜æ—¶ä¸ä¼šè¢«ä¹‹å‰çš„å¯¹è¯å¹²æ‰°ã€‚

**éªŒæ”¶æ ‡å‡†**ï¼š
- æ–°å»ºä¼šè¯æ—¶ï¼ŒAIåªèƒ½è·å–è”ç³»äººç”»åƒä¿¡æ¯
- æ–°å»ºä¼šè¯æ—¶ï¼ŒAIæ— æ³•è·å–ä¹‹å‰ä¼šè¯çš„å¯¹è¯å†å²
- åŒä¸€ä¼šè¯å†…çš„å¤šè½®å¯¹è¯ä¿æŒä¸Šä¸‹æ–‡è¿ç»­

---

## ğŸ“‹ åŠŸèƒ½éœ€æ±‚

### åŠŸèƒ½1ï¼šMarkdownè¯­æ³•æ¸²æŸ“

#### 1.1 æ”¯æŒçš„Markdownè¯­æ³•

| è¯­æ³• | ç¤ºä¾‹ | æ¸²æŸ“æ•ˆæœ | ä¼˜å…ˆçº§ |
|------|------|----------|--------|
| **ç²—ä½“** | `**é‡è¦**` | åŠ ç²—æ˜¾ç¤º | P0 |
| *æ–œä½“* | `*å¼ºè°ƒ*` | æ–œä½“æ˜¾ç¤º | P0 |
| æ— åºåˆ—è¡¨ | `- é¡¹ç›®` | é¡¹ç›®ç¬¦å·åˆ—è¡¨ | P0 |
| æœ‰åºåˆ—è¡¨ | `1. æ­¥éª¤` | ç¼–å·åˆ—è¡¨ | P0 |
| è¡Œå†…ä»£ç  | `` `code` `` | ç°è‰²èƒŒæ™¯ | P0 |
| ä»£ç å— | ` ```ä»£ç ``` ` | ç°è‰²èƒŒæ™¯åŒºåŸŸ | P0 |
| æ ‡é¢˜ | `# æ ‡é¢˜` | å¤§å·åŠ ç²— | P1 |
| é“¾æ¥ | `[æ–‡å­—](url)` | å¯ç‚¹å‡»é“¾æ¥ | P2 |
| åˆ†éš”çº¿ | `---` | æ°´å¹³åˆ†éš”çº¿ | P2 |

#### 1.2 ä»£ç å—æ ·å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä»£ç å—åŒºåŸŸ                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ èƒŒæ™¯è‰²: #F5F5F5 (æµ…ç°è‰²)            â”‚ â”‚
â”‚ â”‚ åœ†è§’: 8dp                           â”‚ â”‚
â”‚ â”‚ å†…è¾¹è·: 12dp                        â”‚ â”‚
â”‚ â”‚ å­—ä½“: ç­‰å®½å­—ä½“ (monospace)          â”‚ â”‚
â”‚ â”‚ å­—å·: 14sp                          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 1.3 è¡Œå†…ä»£ç æ ·å¼

| å±æ€§ | å€¼ |
|------|-----|
| èƒŒæ™¯è‰² | `#E8E8E8` (ç°è‰²) |
| åœ†è§’ | 4dp |
| å†…è¾¹è· | æ°´å¹³4dp, å‚ç›´2dp |
| å­—ä½“ | ç­‰å®½å­—ä½“ (monospace) |
| å­—å· | ä¸æ­£æ–‡ç›¸åŒ |

#### 1.4 ä¸æ”¯æŒçš„è¯­æ³•ï¼ˆæ˜ç¡®æ’é™¤ï¼‰

| è¯­æ³• | åŸå›  |
|------|------|
| è¡¨æ ¼ | å¤æ‚åº¦é«˜ï¼Œç§»åŠ¨ç«¯æ˜¾ç¤ºæ•ˆæœå·® |
| å›¾ç‰‡ | å®‰å…¨é£é™©ï¼Œéœ€è¦é¢å¤–å¤„ç† |
| LaTeXå…¬å¼ | ä½¿ç”¨åœºæ™¯å°‘ï¼Œä¾èµ–é‡ |
| ä»£ç é«˜äº® | ä¾èµ–é‡ï¼ŒåŸºç¡€ç°è‰²èƒŒæ™¯è¶³å¤Ÿ |
| HTMLæ ‡ç­¾ | å®‰å…¨é£é™© |

---

### åŠŸèƒ½2ï¼šä¼šè¯ä¸Šä¸‹æ–‡éš”ç¦»

#### 2.1 ä¸Šä¸‹æ–‡æ„æˆ

| ä¼šè¯ç±»å‹ | è”ç³»äººç”»åƒ | å½“å‰ä¼šè¯å†å² | å…¶ä»–ä¼šè¯å†å² |
|----------|------------|--------------|--------------|
| æ–°å»ºä¼šè¯ | âœ… åŒ…å« | âŒ æ— ï¼ˆç©ºï¼‰ | âŒ ä¸åŒ…å« |
| ç»§ç»­ä¼šè¯ | âœ… åŒ…å« | âœ… åŒ…å« | âŒ ä¸åŒ…å« |

#### 2.2 è”ç³»äººç”»åƒä¿¡æ¯

æ–°ä¼šè¯æ—¶ï¼ŒAIå¯è·å–çš„è”ç³»äººä¿¡æ¯ï¼š

| ä¿¡æ¯ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|----------|------|------|
| å§“å | è”ç³»äººåç§° | "å¼ ä¸‰" |
| å…³ç³»æ ‡ç­¾ | å…³ç³»ç±»å‹ | "äº²å¯†"ã€"ç†Ÿæ‚‰" |
| æ ‡ç­¾ç”»åƒ | BrainTagåˆ—è¡¨ | "å–œæ¬¢æ—…æ¸¸"ã€"å·¥ä½œå‹åŠ›å¤§" |
| äº‹å®æµ | é‡è¦äº‹å®è®°å½• | "ä¸Šå‘¨åˆšæ¢å·¥ä½œ" |
| æ€»ç»“ä¿¡æ¯ | AIç”Ÿæˆçš„æ€»ç»“ | "æ€§æ ¼å¤–å‘ï¼Œå–œæ¬¢æˆ·å¤–æ´»åŠ¨" |

#### 2.3 ä¸Šä¸‹æ–‡éš”ç¦»é€»è¾‘

```
å‘é€æ¶ˆæ¯æ—¶æ„å»ºAIæç¤ºè¯ï¼š
    â†“
è·å–è”ç³»äººç”»åƒä¿¡æ¯ï¼ˆå§“åã€æ ‡ç­¾ã€äº‹å®æµã€æ€»ç»“ï¼‰
    â†“
è·å–å½“å‰ä¼šè¯(sessionId)çš„å¯¹è¯å†å²
    â†“
æ„å»ºæç¤ºè¯ = è”ç³»äººç”»åƒ + å½“å‰ä¼šè¯å†å² + ç”¨æˆ·æ¶ˆæ¯
    â†“
å‘é€ç»™AI
```

**å…³é”®å˜æ›´**ï¼š
```kotlin
// ä¿®æ”¹å‰ï¼ˆæŒ‰contactIdè·å–ï¼Œè·¨ä¼šè¯ï¼‰
val history = aiAdvisorRepository.getRecentConversations(contactId, limit)

// ä¿®æ”¹åï¼ˆæŒ‰sessionIdè·å–ï¼Œä¼šè¯éš”ç¦»ï¼‰
val history = aiAdvisorRepository.getConversationsBySession(sessionId, limit)
```

---

## ğŸ”§ æŠ€æœ¯çº¦æŸ

### æŠ€æœ¯æ ˆé™åˆ¶

| ç±»å‹ | è¦æ±‚ |
|------|------|
| UIæ¡†æ¶ | Jetpack Composeï¼ˆå¿…é¡»ä½¿ç”¨ï¼‰ |
| Markdownåº“ | compose-markdownï¼ˆæ¨èä½¿ç”¨ï¼‰ |
| ä¾èµ–æ³¨å…¥ | Hiltï¼ˆå¿…é¡»ä½¿ç”¨ï¼‰ |
| çŠ¶æ€ç®¡ç† | StateFlow + ViewModelï¼ˆå¿…é¡»ä½¿ç”¨ï¼‰ |
| æ•°æ®æµ | Kotlin Flowï¼ˆå¿…é¡»ä½¿ç”¨ï¼‰ |

### æ¶æ„é™åˆ¶

| ç±»å‹ | è¦æ±‚ |
|------|------|
| æ¶æ„æ¨¡å¼ | Clean Architecture + MVVM |
| ä¾èµ–æ–¹å‘ | è¡¨ç°å±‚ â†’ é¢†åŸŸå±‚ â†’ æ•°æ®å±‚ |
| UseCaseä½ç½® | `:domain/usecase/` |
| Screenä½ç½® | `:presentation/ui/screen/advisor/` |

---

## ğŸ”§ æŠ€æœ¯æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šMarkdownæ¸²æŸ“

#### æ¨èæ–¹æ¡ˆï¼šä½¿ç”¨compose-markdownåº“

**ä¾èµ–æ·»åŠ **ï¼ˆlibs.versions.tomlï¼‰ï¼š
```toml
[versions]
compose-markdown = "0.5.4"

[libraries]
compose-markdown = { module = "com.mikepenz:multiplatform-markdown-renderer", version.ref = "compose-markdown" }
```

**ä½¿ç”¨æ–¹å¼**ï¼š
```kotlin
// ä¿®æ”¹å‰
Text(
    text = conversation.content,
    fontSize = 16.sp,
    color = iOSTextPrimary
)

// ä¿®æ”¹å
Markdown(
    content = conversation.content,
    colors = markdownColors(
        text = iOSTextPrimary,
        codeBackground = Color(0xFFF5F5F5)
    )
)
```

**ä¿®æ”¹ä½ç½®**ï¼š
| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ |
|------|----------|
| `ChatBubble` (AiAdvisorChatScreen.kt) | AIæ¶ˆæ¯ä½¿ç”¨Markdownæ¸²æŸ“ |
| `MainTextBubble` (StreamingMessageBubble.kt) | æµå¼AIæ¶ˆæ¯ä½¿ç”¨Markdownæ¸²æŸ“ |

### æ–¹æ¡ˆ2ï¼šä¼šè¯éš”ç¦»

#### ä¿®æ”¹SendAdvisorMessageStreamingUseCase

**å½“å‰ä»£ç **ï¼ˆç¬¬147è¡Œï¼‰ï¼š
```kotlin
val historyResult = aiAdvisorRepository.getRecentConversations(contactId, DEFAULT_HISTORY_LIMIT)
```

**ä¿®æ”¹ä¸º**ï¼š
```kotlin
val historyResult = aiAdvisorRepository.getConversationsBySession(sessionId, DEFAULT_HISTORY_LIMIT)
```

#### å¢å¼ºè”ç³»äººç”»åƒä¿¡æ¯

**å½“å‰ä»£ç **ï¼ˆbuildPromptæ–¹æ³•ï¼‰ï¼š
```kotlin
if (!contactName.isNullOrBlank()) {
    sb.appendLine("ã€è”ç³»äººã€‘$contactName")
}
```

**ä¿®æ”¹ä¸º**ï¼š
```kotlin
// è·å–å®Œæ•´çš„è”ç³»äººç”»åƒ
val contactProfile = contactRepository.getProfile(contactId).getOrNull()
val brainTags = brainTagRepository.getTagsByContact(contactId).getOrNull()
val facts = factRepository.getFactsByContact(contactId).getOrNull()

sb.appendLine("ã€è”ç³»äººç”»åƒã€‘")
sb.appendLine("å§“å: ${contactProfile?.name ?: "æœªçŸ¥"}")
sb.appendLine("å…³ç³»: ${contactProfile?.relationship ?: "æœªè®¾ç½®"}")

if (!brainTags.isNullOrEmpty()) {
    sb.appendLine("æ ‡ç­¾: ${brainTags.joinToString(", ") { it.content }}")
}

if (!facts.isNullOrEmpty()) {
    sb.appendLine("é‡è¦äº‹å®:")
    facts.take(5).forEach { fact ->
        sb.appendLine("- ${fact.content}")
    }
}
```

---

## ğŸ—„ï¸ æ•°æ®åº“å˜æ›´

### Entityå˜æ›´
- âŒ ä¸éœ€è¦æ–°å¢Entityï¼ˆä½¿ç”¨ç°æœ‰`AiAdvisorConversationEntity`ï¼‰

### DAOå˜æ›´
- âœ… éœ€è¦ç¡®è®¤`AiAdvisorConversationDao`ä¸­å­˜åœ¨ä»¥ä¸‹æ–¹æ³•ï¼š

```kotlin
@Query("SELECT * FROM ai_advisor_conversations WHERE session_id = :sessionId ORDER BY timestamp ASC LIMIT :limit")
suspend fun getConversationsBySession(sessionId: String, limit: Int): List<AiAdvisorConversationEntity>
```

### Migration
- âŒ ä¸éœ€è¦æ•°æ®åº“Migrationï¼ˆä¸ä¿®æ”¹è¡¨ç»“æ„ï¼‰

---

## ğŸ—ï¸ ä¸šåŠ¡é€»è¾‘å±‚å˜æ›´

### Repositoryå˜æ›´

| Repository | å˜æ›´ç±»å‹ | è¯´æ˜ |
|------------|----------|------|
| `AiAdvisorRepository` | ç¡®è®¤æ–¹æ³• | ç¡®è®¤`getConversationsBySession(sessionId, limit)`æ–¹æ³•å­˜åœ¨ |
| `ContactRepository` | æ— å˜æ›´ | ä½¿ç”¨ç°æœ‰`getProfile(contactId)`æ–¹æ³• |
| `BrainTagRepository` | æ–°å¢ä¾èµ– | éœ€è¦æ³¨å…¥åˆ°UseCaseä¸­è·å–æ ‡ç­¾ |

### UseCaseå˜æ›´

| UseCase | å˜æ›´ç±»å‹ | è¯´æ˜ |
|---------|----------|------|
| `SendAdvisorMessageStreamingUseCase` | ä¿®æ”¹ | 1. å†å²è·å–æ”¹ä¸ºæŒ‰sessionId<br>2. å¢å¼ºè”ç³»äººç”»åƒä¿¡æ¯æ„å»º<br>3. æ–°å¢BrainTagRepositoryä¾èµ– |

---

## ğŸ”Œ DIæ¨¡å—é›†æˆ

### æ–°å¢DIæ¨¡å—
- âŒ ä¸éœ€è¦æ–°å¢DIæ¨¡å—

### ä¿®æ”¹ç°æœ‰DIæ¨¡å—
- âœ… éœ€è¦åœ¨`AiAdvisorModule`ä¸­æ›´æ–°`SendAdvisorMessageStreamingUseCase`çš„ä¾èµ–ï¼š

```kotlin
@Provides
@Singleton
fun provideSendAdvisorMessageStreamingUseCase(
    aiAdvisorRepository: AiAdvisorRepository,
    aiRepository: AiRepository,
    contactRepository: ContactRepository,
    aiProviderRepository: AiProviderRepository,
    brainTagRepository: BrainTagRepository  // ğŸ†• æ–°å¢ä¾èµ–
): SendAdvisorMessageStreamingUseCase {
    return SendAdvisorMessageStreamingUseCase(
        aiAdvisorRepository,
        aiRepository,
        contactRepository,
        aiProviderRepository,
        brainTagRepository  // ğŸ†• æ–°å¢ä¾èµ–
    )
}
```

---

## ğŸ”— è°ƒç”¨é“¾

### Markdownæ¸²æŸ“è°ƒç”¨é“¾
```
AiAdvisorChatScreen
    â†“ (ChatBubbleç»„ä»¶)
Markdown(content)  // compose-markdownåº“
    â†“ (è§£æMarkdownè¯­æ³•)
æ¸²æŸ“ä¸ºCompose UI
```

### ä¼šè¯éš”ç¦»è°ƒç”¨é“¾
```
AiAdvisorChatViewModel.sendMessage()
    â†“
SendAdvisorMessageStreamingUseCase(contactId, sessionId, message)
    â†“ (è·å–è”ç³»äººç”»åƒ)
ContactRepository.getProfile(contactId)
BrainTagRepository.getTagsByContact(contactId)
    â†“ (è·å–å½“å‰ä¼šè¯å†å² - ğŸ†• ä¿®æ”¹ç‚¹)
AiAdvisorRepository.getConversationsBySession(sessionId, limit)
    â†“ (æ„å»ºæç¤ºè¯)
buildPrompt(contactProfile, brainTags, history, userMessage)
    â†“ (è°ƒç”¨AI)
AiRepository.generateTextStream(provider, prompt, systemInstruction)
```

---

## ğŸ“ å­—ç¬¦ä¸²èµ„æº

### éœ€è¦æ–°å¢çš„å­—ç¬¦ä¸²èµ„æº
- âŒ æœ¬éœ€æ±‚ä¸éœ€è¦æ–°å¢å­—ç¬¦ä¸²èµ„æºï¼ˆMarkdownæ¸²æŸ“å’Œä¼šè¯éš”ç¦»éƒ½æ˜¯åç«¯é€»è¾‘å˜æ›´ï¼‰

---

## ğŸ“ æ–‡ä»¶å˜æ›´æ¸…å•

### æ–°å¢æ–‡ä»¶

| æ–‡ä»¶ | æ¨¡å— | è¯´æ˜ |
|------|------|------|
| æ—  | - | æœ¬éœ€æ±‚ä¸éœ€è¦æ–°å¢æ–‡ä»¶ |

### ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ¨¡å— | ä¿®æ”¹å†…å®¹ |
|------|------|----------|
| `libs.versions.toml` | gradle | æ·»åŠ compose-markdownä¾èµ– |
| `build.gradle.kts` | :presentation | æ·»åŠ compose-markdownä¾èµ– |
| `AiAdvisorChatScreen.kt` | :presentation | ChatBubbleä½¿ç”¨Markdownæ¸²æŸ“ |
| `StreamingMessageBubble.kt` | :presentation | MainTextBubbleä½¿ç”¨Markdownæ¸²æŸ“ |
| `SendAdvisorMessageStreamingUseCase.kt` | :domain | 1. ä¿®æ”¹å†å²è·å–é€»è¾‘ä¸ºæŒ‰sessionId<br>2. å¢å¼ºè”ç³»äººç”»åƒä¿¡æ¯æ„å»º<br>3. æ–°å¢BrainTagRepositoryä¾èµ– |
| `AiAdvisorModule.kt` | :app | æ›´æ–°UseCaseä¾èµ–æ³¨å…¥ |
| `AiAdvisorRepository.kt` | :domain | ç¡®è®¤getConversationsBySessionæ–¹æ³•å­˜åœ¨ |

---

## âš™ï¸ éåŠŸèƒ½éœ€æ±‚

### æ€§èƒ½è¦æ±‚

| æŒ‡æ ‡ | è¦æ±‚ |
|------|------|
| Markdownæ¸²æŸ“æ—¶é—´ | < 50msï¼ˆå•æ¡æ¶ˆæ¯ï¼‰ |
| è”ç³»äººç”»åƒåŠ è½½æ—¶é—´ | < 100ms |
| ä¼šè¯å†å²åŠ è½½æ—¶é—´ | < 200ms |

### å…¼å®¹æ€§è¦æ±‚

| æŒ‡æ ‡ | è¦æ±‚ |
|------|------|
| æœ€ä½Androidç‰ˆæœ¬ | Android 7.0 (API 24) |
| Markdownåº“å…¼å®¹æ€§ | æ”¯æŒCompose BOM 2024.12.01 |

---

## âœ… éªŒæ”¶æ ‡å‡†

### Markdownæ¸²æŸ“éªŒæ”¶

| åºå· | éªŒæ”¶é¡¹ | æ ‡å‡† |
|------|--------|------|
| 1 | ç²—ä½“æ¸²æŸ“ | `**æ–‡å­—**`æ˜¾ç¤ºä¸ºç²—ä½“ |
| 2 | æ–œä½“æ¸²æŸ“ | `*æ–‡å­—*`æ˜¾ç¤ºä¸ºæ–œä½“ |
| 3 | æ— åºåˆ—è¡¨ | `- é¡¹ç›®`æ˜¾ç¤ºä¸ºé¡¹ç›®ç¬¦å·åˆ—è¡¨ |
| 4 | æœ‰åºåˆ—è¡¨ | `1. é¡¹ç›®`æ˜¾ç¤ºä¸ºç¼–å·åˆ—è¡¨ |
| 5 | è¡Œå†…ä»£ç  | `` `code` ``æ˜¾ç¤ºä¸ºç°è‰²èƒŒæ™¯ |
| 6 | ä»£ç å— | ä»£ç å—æ˜¾ç¤ºä¸ºç°è‰²èƒŒæ™¯åŒºåŸŸ |
| 7 | æµå¼æ¸²æŸ“ | æµå¼å“åº”æ—¶Markdownå®æ—¶æ¸²æŸ“ |

### ä¼šè¯éš”ç¦»éªŒæ”¶

| åºå· | éªŒæ”¶é¡¹ | æ ‡å‡† |
|------|--------|------|
| 1 | æ–°ä¼šè¯éš”ç¦» | æ–°å»ºä¼šè¯æ—¶AIæ— æ³•è·å–ä¹‹å‰ä¼šè¯çš„å¯¹è¯å†å² |
| 2 | ç”»åƒä¿¡æ¯ä¿ç•™ | æ–°å»ºä¼šè¯æ—¶AIå¯è·å–è”ç³»äººç”»åƒä¿¡æ¯ |
| 3 | å½“å‰ä¼šè¯è¿ç»­ | åŒä¸€ä¼šè¯å†…å¤šè½®å¯¹è¯ä¿æŒä¸Šä¸‹æ–‡è¿ç»­ |
| 4 | åˆ‡æ¢ä¼šè¯éš”ç¦» | åˆ‡æ¢åˆ°å†å²ä¼šè¯æ—¶åªåŠ è½½è¯¥ä¼šè¯çš„å†å² |

---

## ğŸ“Š å·¥ä½œé‡ä¼°è®¡

| ä»»åŠ¡ | é¢„ä¼°å·¥æ—¶ |
|------|----------|
| Markdownä¾èµ–é›†æˆ | 0.5h |
| ChatBubble Markdownæ¸²æŸ“ | 1h |
| StreamingMessageBubble Markdownæ¸²æŸ“ | 1h |
| ä¼šè¯éš”ç¦»é€»è¾‘ä¿®æ”¹ | 1h |
| è”ç³»äººç”»åƒä¿¡æ¯å¢å¼º | 1.5h |
| å•å…ƒæµ‹è¯• | 2h |
| é›†æˆæµ‹è¯• | 1h |
| **æ€»è®¡** | **8h** |

---

## ğŸ“š å…³è”æ–‡æ¡£

- [PRD-00026-AIå†›å¸ˆå¯¹è¯åŠŸèƒ½éœ€æ±‚](./PRD-00026-AIå†›å¸ˆå¯¹è¯åŠŸèƒ½éœ€æ±‚.md)
- [PRD-00029-AIå†›å¸ˆUIæ¶æ„ä¼˜åŒ–éœ€æ±‚](./PRD-00029-AIå†›å¸ˆUIä¼˜åŒ–éœ€æ±‚.md)
- [TDD-00026-AIå†›å¸ˆå¯¹è¯åŠŸèƒ½æŠ€æœ¯è®¾è®¡](../TDD/TDD-00026-AIå†›å¸ˆå¯¹è¯åŠŸèƒ½æŠ€æœ¯è®¾è®¡.md)

---

## ğŸ“ å˜æ›´è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ | ä½œè€… |
|------|------|----------|------|
| 1.0 | 2026-01-07 | åˆå§‹ç‰ˆæœ¬ | Kiro |
| 1.1 | 2026-01-07 | æ ¹æ®DR-00048å®¡æŸ¥æŠ¥å‘Šè¡¥å……ï¼šæ•°æ®åº“å˜æ›´ã€ä¸šåŠ¡é€»è¾‘å±‚å˜æ›´ã€DIæ¨¡å—é›†æˆã€è°ƒç”¨é“¾ã€å­—ç¬¦ä¸²èµ„æºã€æŠ€æœ¯çº¦æŸç­‰ç« èŠ‚ | Kiro |

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.1  
**æœ€åæ›´æ–°**: 2026-01-07  
**æ›´æ–°å†…å®¹**: æ ¹æ®DR-00048å®¡æŸ¥æŠ¥å‘Šè¡¥å……ç¼ºå¤±ç« èŠ‚
