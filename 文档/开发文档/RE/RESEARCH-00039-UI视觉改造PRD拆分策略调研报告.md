# RESEARCH-00039-UI视觉改造PRD拆分策略调研报告

## 文档信息

| 项目 | 内容 |
|------|------|
| 文档编号 | RESEARCH-00039 |
| 创建日期 | 2025-12-24 |
| 调研人 | Kiro |
| 状态 | ✅ 调研完成 |
| 调研目的 | 评估UI视觉改造的范围和复杂度，确定PRD拆分策略 |
| 关联任务 | PRD-00019 UI视觉美观化改造 |

---

## 1. 调研范围

### 1.1 调研主题
UI视觉改造的范围评估和PRD拆分策略分析

### 1.2 关注重点
- 改造涉及的文件数量和复杂度
- 各模块之间的依赖关系
- 改造的风险等级
- 最优的PRD拆分方案

### 1.3 关联文档

| 文档类型 | 文档编号 | 文档名称 |
|----------|----------|----------|
| PRD | PRD-00019 | UI视觉美观化改造 |
| TD | TD-00018 | UI/UX系统化改进任务清单 |
| RE | RESEARCH-00038 | TD00018测试验证报告 |

---

## 2. 改造范围分析

### 2.1 涉及的文件结构

#### 主题层（Theme）- 9个文件
| 文件 | 改造内容 | 复杂度 |
|------|----------|--------|
| Color.kt | 暖金色主题色彩系统 | 中 |
| Theme.kt | 主题配置切换 | 中 |
| Spacing.kt | 已完成（TD-00018） | ✅ |
| Dimensions.kt | 已完成（TD-00018） | ✅ |
| AnimationSpec.kt | 已完成（TD-00018） | ✅ |
| Type.kt | 字体样式微调 | 低 |
| SemanticColors.kt | 语义色彩更新 | 低 |
| CategoryColorPalette.kt | 分类颜色更新 | 低 |
| RelationshipColors.kt | 关系颜色更新 | 低 |

#### Screen层 - 7个目录
| 目录 | 文件数 | 改造内容 | 复杂度 |
|------|--------|----------|--------|
| contact/ | 10+ | 联系人列表、详情页 | 高 |
| settings/ | 5+ | 设置页面扁平化 | 高 |
| chat/ | 5+ | 聊天界面样式 | 中 |
| aiconfig/ | 3+ | AI配置页面 | 低 |
| prompt/ | 5+ | 提示词编辑器 | 低 |
| tag/ | 3+ | 标签管理页面 | 低 |
| userprofile/ | 3+ | 用户画像页面 | 低 |

#### Component层 - 13个目录
| 目录 | 改造内容 | 复杂度 |
|------|----------|--------|
| card/ | 卡片样式更新 | 中 |
| button/ | 按钮样式更新 | 中 |
| list/ | 列表项样式更新 | 高 |
| state/ | 空状态、错误状态 | 已完成 |
| animation/ | 已完成（TD-00018） | ✅ |
| input/ | 输入框样式 | 低 |
| dialog/ | 对话框样式 | 低 |
| chip/ | 标签样式 | 低 |
| 其他 | 各类组件 | 低 |

### 2.2 改造工作量估算

| 改造项 | 文件数 | 预估工时 | 风险等级 |
|--------|--------|----------|----------|
| 主题色彩系统 | 5 | 1-2天 | 低 |
| 联系人列表 | 3 | 2-3天 | 中 |
| 设置页面 | 3 | 2-3天 | 中 |
| 通用组件 | 10 | 3-4天 | 中 |
| 其他页面 | 15 | 3-4天 | 低 |
| **总计** | **36** | **11-16天** | **中** |

---

## 3. PRD拆分策略分析

### 3.1 方案A：单一PRD（不拆分）

**优点**：
- 设计语言统一，一次性完成
- 避免中间状态的视觉不一致
- 文档管理简单

**缺点**：
- 工作量大（11-16天），周期长
- 风险集中，一旦出问题影响面大
- 难以并行开发
- 验收标准复杂

**适用场景**：小型项目、改造范围小

### 3.2 方案B：按层级拆分（推荐）

```
PRD-00019: 主题系统改造（基础层）
    ↓
PRD-00020: 核心页面改造（联系人+设置）
    ↓
PRD-00021: 通用组件改造
    ↓
PRD-00022: 其他页面改造
```

**优点**：
- 分层递进，风险可控
- 每个PRD独立验收
- 可以并行开发部分内容
- 出问题容易定位和回滚

**缺点**：
- 文档数量增加
- 需要协调多个PRD的依赖关系

### 3.3 方案C：按功能模块拆分

```
PRD-00019A: 主题+联系人模块
PRD-00019B: 设置+AI配置模块
PRD-00019C: 聊天+其他模块
```

**优点**：
- 每个PRD功能完整
- 可以独立发布

**缺点**：
- 主题改造需要重复
- 组件复用困难

---

## 4. 推荐方案

### 4.1 推荐：方案B（按层级拆分）

基于以下考虑：

1. **依赖关系清晰**：主题层 → 组件层 → 页面层
2. **风险可控**：每层独立验收，问题易定位
3. **符合项目规范**：与TD-00018的分阶段实施一致
4. **工作量合理**：每个PRD 3-5天，可控

### 4.2 具体拆分建议

| PRD编号 | 名称 | 范围 | 预估工时 | 依赖 |
|---------|------|------|----------|------|
| PRD-00019 | 暖金色主题系统 | Color.kt、Theme.kt、SemanticColors.kt | 1-2天 | 无 |
| PRD-00020 | 核心页面改造 | 联系人列表、设置页面 | 4-5天 | PRD-00019 |
| PRD-00021 | 通用组件库 | Card、Button、List、Avatar等 | 3-4天 | PRD-00019 |
| PRD-00022 | 其他页面适配 | Chat、Prompt、Tag等 | 3-4天 | PRD-00020/21 |

### 4.3 替代方案：合并为2个PRD

如果觉得4个PRD太多，可以合并为：

| PRD编号 | 名称 | 范围 | 预估工时 |
|---------|------|------|----------|
| PRD-00019 | 主题+核心页面 | 主题系统 + 联系人 + 设置 | 5-7天 |
| PRD-00020 | 组件+其他页面 | 通用组件 + 其他页面适配 | 6-8天 |

---

## 5. 关键发现

### 5.1 核心结论

1. **改造范围中等**：约36个文件，11-16天工作量
2. **已有基础良好**：TD-00018已完成间距、动画系统
3. **建议拆分**：按层级拆分为2-4个PRD更合理
4. **优先级明确**：主题 → 联系人/设置 → 组件 → 其他

### 5.2 技术要点

| 要点 | 说明 | 重要程度 |
|------|------|----------|
| 主题系统是基础 | 必须先完成Color.kt改造 | 高 |
| 联系人列表是核心 | 用户最常用，改造效果最明显 | 高 |
| 组件复用 | 先改组件，再改页面更高效 | 中 |
| 向后兼容 | 保留旧API，渐进式迁移 | 中 |

### 5.3 风险预警

| 风险 | 概率 | 影响 | 缓解措施 |
|------|------|------|----------|
| 主题切换导致全局影响 | 中 | 高 | 先在单个页面验证 |
| 组件改造影响多个页面 | 中 | 中 | 保留旧版本兼容 |
| 设计不一致 | 低 | 中 | 建立设计规范文档 |

---

## 6. 最终建议

### 6.1 推荐方案

**采用2个PRD的拆分方案**：

```
PRD-00019: 主题系统 + 核心页面改造
├── Phase 1: 暖金色主题系统（1-2天）
├── Phase 2: 联系人列表微信风格（2-3天）
└── Phase 3: 设置页面iOS风格（2-3天）

PRD-00020: 组件库 + 其他页面适配
├── Phase 1: 通用组件改造（3-4天）
└── Phase 2: 其他页面适配（3-4天）
```

### 6.2 理由

1. **PRD-00019已存在**：直接扩展现有PRD，减少文档管理成本
2. **核心功能优先**：先完成用户最关心的联系人和设置页面
3. **风险可控**：两个PRD独立验收，问题易定位
4. **工作量均衡**：每个PRD约5-7天，周期合理

### 6.3 下一步行动

1. **更新PRD-00019**：补充Phase划分和详细任务
2. **创建PRD-00020**：组件库和其他页面适配
3. **创建TD任务清单**：基于PRD生成具体任务

---

**文档版本**: 1.0
**最后更新**: 2025-12-24
