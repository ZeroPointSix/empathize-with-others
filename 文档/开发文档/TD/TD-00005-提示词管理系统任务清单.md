# TD-00005: æç¤ºè¯ç®¡ç†ç³»ç»Ÿä»»åŠ¡æ¸…å•

## æ–‡æ¡£ä¿¡æ¯

**æ–‡æ¡£ç¼–å·**: TD-00005  
**ç‰ˆæœ¬**: 1.2  
**åˆ›å»ºæ—¥æœŸ**: 2025-12-16  
**æœ€åæ›´æ–°**: 2025-12-16  
**éœ€æ±‚æ–‡æ¡£**: `æ–‡æ¡£/å¼€å‘æ–‡æ¡£/PRD/PRD-00005-æç¤ºè¯ç®¡ç†ç³»ç»Ÿéœ€æ±‚.md` (v1.0)  
**åŠŸèƒ½è®¾è®¡**: `æ–‡æ¡£/å¼€å‘æ–‡æ¡£/FD/FD-00005-æç¤ºè¯ç®¡ç†ç³»ç»ŸåŠŸèƒ½è®¾è®¡.md` (v1.1)  
**æŠ€æœ¯è®¾è®¡**: `æ–‡æ¡£/å¼€å‘æ–‡æ¡£/TDD/TDD-00005-æç¤ºè¯ç®¡ç†ç³»ç»ŸæŠ€æœ¯è®¾è®¡.md` (v1.2)  
**å®¡æŸ¥æŠ¥å‘Š**: `æ–‡æ¡£/å¼€å‘æ–‡æ¡£/DR/DR-00011-TD00005æ–‡æ¡£å®¡æŸ¥æŠ¥å‘Š.md` (v1.0)  
**çŠ¶æ€**: ğŸ“ å¾…å¼€å‘  
**è´Ÿè´£äºº**: Kiro  
**é¢„è®¡å·¥ä½œé‡**: 5-7ä¸ªå·¥ä½œæ—¥  
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

---

## ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | ä½œè€… | å˜æ›´è¯´æ˜ |
|------|------|------|----------|
| 1.0 | 2025-12-16 | Kiro | åˆå§‹ç‰ˆæœ¬ |
| 1.1 | 2025-12-16 | Kiro | ä¼˜åŒ–ï¼šT040æå‰åˆ°é˜¶æ®µ2ã€æ–°å¢T041å¼€å‘è€…é€‰é¡¹ã€è¡¥å……TestDispatcherè¯´æ˜ |
| 1.2 | 2025-12-16 | Kiro | æ ¹æ®DR-00011å®¡æŸ¥ä¼˜åŒ–ï¼šç»Ÿä¸€ç¼“å­˜ç­–ç•¥æè¿°ã€è¡¥å……T041ä¼˜å…ˆçº§å’Œå®ç°æ—¶æœºã€åˆ¶å®šæµ‹è¯•è¦†ç›–ç‡æ ‡å‡† |

---

## ä»»åŠ¡æ ¼å¼è¯´æ˜

- **[P]**: å¯å¹¶è¡Œæ‰§è¡Œï¼ˆä¸åŒæ–‡ä»¶ï¼Œæ— ä¾èµ–ï¼‰
- **[é˜¶æ®µX]**: æ‰€å±å¼€å‘é˜¶æ®µï¼ˆé˜¶æ®µ1-5ï¼‰
- **[ä¾èµ–]**: ä¾èµ–å…¶ä»–ä»»åŠ¡å®Œæˆ
- æè¿°ä¸­åŒ…å«ç¡®åˆ‡çš„æ–‡ä»¶è·¯å¾„

---

## è·¯å¾„çº¦å®š

åŸºäºé¡¹ç›®ç»“æ„ `com.empathy.ai/`:
- **é¢†åŸŸå±‚**: `domain/model/`, `domain/repository/`, `domain/util/`
- **æ•°æ®å±‚**: `data/local/`, `data/repository/`
- **ä¾èµ–æ³¨å…¥**: `di/`
- **æµ‹è¯•**: `test/`, `androidTest/`

---

## å¼€å‘é˜¶æ®µæ˜ å°„

æ ¹æ®TDD-00005 v1.2ï¼Œæœ¬åŠŸèƒ½åˆ†ä¸º5ä¸ªå¼€å‘é˜¶æ®µï¼š

- **é˜¶æ®µ1**: æ•°æ®æ¨¡å‹å’Œå­˜å‚¨å±‚ï¼ˆ1-2å¤©ï¼‰ğŸ¯ åŸºç¡€
- **é˜¶æ®µ2**: æ ¸å¿ƒç»„ä»¶å®ç°ï¼ˆ1-2å¤©ï¼‰
- **é˜¶æ®µ3**: ä»“åº“å±‚å®ç°ï¼ˆ1å¤©ï¼‰
- **é˜¶æ®µ4**: é›†æˆç°æœ‰AIè°ƒç”¨ï¼ˆ1-2å¤©ï¼‰
- **é˜¶æ®µ5**: æµ‹è¯•å’Œæ–‡æ¡£ï¼ˆ1å¤©ï¼‰

**æ€»å·¥æœŸ**: 5-7ä¸ªå·¥ä½œæ—¥

---

## é˜¶æ®µ1: æ•°æ®æ¨¡å‹å’Œå­˜å‚¨å±‚ï¼ˆ1-2å¤©ï¼‰

**ç›®æ ‡**: å»ºç«‹æ•°æ®æ¨¡å‹å’Œå­˜å‚¨åŸºç¡€è®¾æ–½

**é‡Œç¨‹ç¢‘**: M1 - æ•°æ®å±‚å®Œæˆ

### 1.1 é¢†åŸŸæ¨¡å‹

- [ ] T001 [P] åˆ›å»ºPromptSceneåœºæ™¯æšä¸¾
  - æ–‡ä»¶: `domain/model/PromptScene.kt`
  - å†…å®¹: ANALYZEã€CHECKã€EXTRACTã€SUMMARYå››ç§åœºæ™¯
  - åŒ…å«: displayNameã€descriptionã€availableVariableså±æ€§

- [ ] T002 [P] åˆ›å»ºPromptContextå˜é‡ä¸Šä¸‹æ–‡
  - æ–‡ä»¶: `domain/model/PromptContext.kt`
  - å†…å®¹: contactNameã€relationshipStatusã€riskTagsã€strategyTagsã€factsCountã€todayDate
  - åŒ…å«: getVariable()æ–¹æ³•ã€fromContact()å·¥å‚æ–¹æ³•

- [ ] T003 [P] åˆ›å»ºGlobalPromptConfigå…¨å±€é…ç½®æ¨¡å‹
  - æ–‡ä»¶: `domain/model/GlobalPromptConfig.kt`
  - å†…å®¹: versionã€lastModifiedã€promptsæ˜ å°„
  - åŒ…å«: createDefault()å·¥å‚æ–¹æ³•

- [ ] T004 [P] åˆ›å»ºScenePromptConfigåœºæ™¯é…ç½®æ¨¡å‹
  - æ–‡ä»¶: `domain/model/ScenePromptConfig.kt`
  - å†…å®¹: userPromptã€enabledã€historyåˆ—è¡¨
  - åŒ…å«: addHistory()æ–¹æ³•ã€MAX_HISTORY_SIZEå¸¸é‡

- [ ] T005 [P] åˆ›å»ºPromptHistoryItemå†å²è®°å½•æ¨¡å‹
  - æ–‡ä»¶: `domain/model/PromptHistoryItem.kt`
  - å†…å®¹: timestampã€userPrompt

- [ ] T006 [P] åˆ›å»ºPromptErroré”™è¯¯ç±»å‹
  - æ–‡ä»¶: `domain/model/PromptError.kt`
  - å†…å®¹: ValidationErrorã€StorageErrorã€ParseErrorã€BackupErrorã€DatabaseError
  - åŒ…å«: getUserMessage()ã€isRecoverable()æ–¹æ³•

- [ ] T007 [P] åˆ›å»ºPromptValidationResultéªŒè¯ç»“æœ
  - æ–‡ä»¶: `domain/model/PromptValidationResult.kt`
  - å†…å®¹: Successã€Warningã€Errorå¯†å°ç±»
  - åŒ…å«: WarningTypeã€ErrorTypeæšä¸¾

### 1.2 æ•°æ®å­˜å‚¨

- [ ] T008 åˆ›å»ºDefaultPromptsé»˜è®¤æç¤ºè¯æ¨¡æ¿
  - æ–‡ä»¶: `data/local/DefaultPrompts.kt`
  - å†…å®¹: ANALYZEã€CHECKã€EXTRACTã€SUMMARYå››ä¸ªåœºæ™¯çš„é»˜è®¤æç¤ºè¯
  - åŒ…å«: getDefault(scene)æ–¹æ³•

- [ ] T009 åˆ›å»ºPromptFileBackupå¤‡ä»½æœºåˆ¶
  - æ–‡ä»¶: `data/local/PromptFileBackup.kt`
  - åŠŸèƒ½: é…ç½®æ–‡ä»¶å¤‡ä»½å’Œæ¢å¤
  - åŒ…å«: createBackup()ã€restoreFromLatestBackup()ã€cleanOldBackups()
  - ä¾èµ–: @IoDispatcheræ³¨å…¥

- [ ] T010 åˆ›å»ºPromptFileStorage JSONæ–‡ä»¶å­˜å‚¨
  - æ–‡ä»¶: `data/local/PromptFileStorage.kt`
  - åŠŸèƒ½: å…¨å±€æç¤ºè¯é…ç½®çš„è¯»å†™
  - åŒ…å«: readGlobalConfig()ã€writeGlobalConfig()ã€invalidateCache()
  - ä¾èµ–: T003, T008, T009

### 1.3 æ•°æ®åº“è¿ç§»

- [ ] T011 æ›´æ–°ContactProfileEntityæ·»åŠ custom_promptå­—æ®µ
  - æ–‡ä»¶: `data/local/entity/ContactProfileEntity.kt`
  - ä¿®æ”¹: æ·»åŠ  `@ColumnInfo(name = "custom_prompt") val customPrompt: String? = null`

- [ ] T012 åˆ›å»ºMIGRATION_7_8æ•°æ®åº“è¿ç§»è„šæœ¬
  - æ–‡ä»¶: `data/local/AppDatabase.kt`
  - å†…å®¹: ALTER TABLE contact_profiles ADD COLUMN custom_prompt TEXT DEFAULT NULL
  - ä¿®æ”¹: æ•°æ®åº“ç‰ˆæœ¬ä»7å‡çº§åˆ°8

- [ ] T013 æ‰©å±•ContactDaoæ·»åŠ æç¤ºè¯æ–¹æ³•
  - æ–‡ä»¶: `data/local/dao/ContactDao.kt`
  - æ·»åŠ : getCustomPrompt(contactId)ã€updateCustomPrompt(contactId, prompt)

### 1.4 ä¾èµ–æ³¨å…¥

- [ ] T014 åˆ›å»ºDispatcherModule Dispatcheræ³¨å…¥æ¨¡å—
  - æ–‡ä»¶: `di/DispatcherModule.kt`
  - å†…å®¹: @IoDispatcherã€@DefaultDispatcheræ³¨è§£å’ŒProvider
  - åŠŸèƒ½: ä¾¿äºæµ‹è¯•æ—¶æ›¿æ¢Dispatcher

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ‰€æœ‰æ•°æ®æ¨¡å‹å¯æ­£ç¡®åºåˆ—åŒ–/ååºåˆ—åŒ–
- [ ] JSONæ–‡ä»¶èƒ½æ­£ç¡®è¯»å†™
- [ ] é¦–æ¬¡å¯åŠ¨è‡ªåŠ¨åˆ›å»ºé»˜è®¤é…ç½®
- [ ] æ•°æ®åº“è¿ç§»æˆåŠŸï¼Œä¸ä¸¢å¤±ç°æœ‰æ•°æ®
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡â‰¥80%

---

## é˜¶æ®µ2: æ ¸å¿ƒç»„ä»¶å®ç°ï¼ˆ1-2å¤©ï¼‰

**ç›®æ ‡**: å®ç°å˜é‡è§£æå’Œæç¤ºè¯æ„å»ºæ ¸å¿ƒé€»è¾‘

**é‡Œç¨‹ç¢‘**: M2 - æ ¸å¿ƒç»„ä»¶å®Œæˆ

### 2.0 æµ‹è¯•åŸºç¡€è®¾æ–½ï¼ˆå‰ç½®ä»»åŠ¡ï¼‰

- [ ] T040 åˆ›å»ºPromptTestDataFactoryæµ‹è¯•æ•°æ®å·¥å‚ âš ï¸ æå‰æ‰§è¡Œ
  - æ–‡ä»¶: `test/testutil/PromptTestDataFactory.kt`
  - å†…å®¹:
    - createPromptContext() / createEmptyPromptContext()
    - createGlobalPromptConfig() / createScenePromptConfig()
    - createMaxLengthPrompt() / createOverLengthPrompt() / createNearLimitPrompt()
    - createTemplateWithAllVariables() / createTemplateWithInvalidVariables()
    - createInjectionAttemptPrompt() / createBlankPrompt()
  - ç†ç”±: åç»­T015-T019çš„å•å…ƒæµ‹è¯•éœ€è¦å¤ç”¨è¿™äº›æµ‹è¯•æ•°æ®ï¼Œé¿å…é‡å¤ç¼–å†™

### 2.1 å˜é‡è§£æå™¨

- [ ] T015 åˆ›å»ºPromptVariableResolverå˜é‡è§£æå™¨
  - æ–‡ä»¶: `domain/util/PromptVariableResolver.kt`
  - åŠŸèƒ½: è§£æ{{å˜é‡å}}æ ¼å¼çš„å ä½ç¬¦
  - åŒ…å«: resolve()ã€extractVariables()ã€findInvalidVariables()ã€clearCache()
  - ç‰¹æ€§: é¢„ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼
  - ç¼“å­˜ç­–ç•¥ï¼ˆä¸TDD-00005ä¸€è‡´ï¼‰:
    - âŒ **ä¸ç¼“å­˜** resolve() ç»“æœï¼šPromptContextåŒ…å«Listç±»å‹ï¼ŒhashCodeè®¡ç®—å¼€é”€å¤§ä¸”contextæ•°æ®å˜åŒ–é¢‘ç¹
    - âœ… **ç¼“å­˜** extractVariables() ç»“æœï¼šæ¨¡æ¿ç»“æ„ä¸å¸¸å˜ï¼Œä½¿ç”¨LruCache(50)
  - ä¾èµ–: T002

### 2.2 è¾“å…¥éªŒè¯å™¨

- [ ] T016 åˆ›å»ºPromptValidatorè¾“å…¥éªŒè¯å™¨
  - æ–‡ä»¶: `domain/util/PromptValidator.kt`
  - åŠŸèƒ½: éªŒè¯æç¤ºè¯é•¿åº¦ã€å˜é‡æœ‰æ•ˆæ€§
  - åŒ…å«: validate()ã€validateAll()
  - å¸¸é‡: MAX_PROMPT_LENGTH=1000ã€WARNING_LENGTH_THRESHOLD=800
  - ä¾èµ–: T001, T007, T015

### 2.3 å®‰å…¨è¿‡æ»¤å™¨

- [ ] T017 åˆ›å»ºPromptSanitizerå®‰å…¨è¿‡æ»¤å™¨
  - æ–‡ä»¶: `domain/util/PromptSanitizer.kt`
  - åŠŸèƒ½: æ£€æµ‹Prompt Injectionæ”»å‡»
  - åŒ…å«: detectDangerousContent()ã€DANGEROUS_PATTERNSåˆ—è¡¨
  - æ£€æµ‹æ¨¡å¼: å¿½ç•¥æŒ‡ä»¤ã€ignore instructionã€æ–°çš„è§’è‰²ç­‰

### 2.4 ç³»ç»Ÿæç¤ºè¯

- [ ] T018 åˆ›å»ºSystemPromptsç³»ç»Ÿæç¤ºè¯å¸¸é‡
  - æ–‡ä»¶: `domain/util/SystemPrompts.kt`
  - åŠŸèƒ½: ç®¡ç†ä¸å¯ä¿®æ”¹çš„ç³»ç»Ÿçº¦æŸæç¤ºè¯
  - åŒ…å«: getHeader(scene)ã€getFooter(scene)
  - å†…å®¹: è§’è‰²å®šä¹‰ã€JSONæ ¼å¼çº¦æŸã€å®‰å…¨çº¦æŸå£°æ˜
  - ä¾èµ–: T001

### 2.5 æç¤ºè¯æ„å»ºå™¨

- [ ] T019 åˆ›å»ºPromptBuilderæç¤ºè¯æ„å»ºå™¨
  - æ–‡ä»¶: `domain/util/PromptBuilder.kt`
  - åŠŸèƒ½: æŒ‰åˆå¹¶è§„åˆ™æ„å»ºå®Œæ•´ç³»ç»ŸæŒ‡ä»¤
  - åŒ…å«: buildSystemInstruction()ã€injectContextData()
  - åˆå¹¶é¡ºåº: System Header â†’ ç”¨æˆ·æŒ‡ä»¤ â†’ ä¸Šä¸‹æ–‡æ•°æ® â†’ System Footer
  - ä¾èµ–: T015, T018, T020

**éªŒæ”¶æ ‡å‡†**:
- [ ] å˜é‡{{xxx}}èƒ½æ­£ç¡®è§£æå’Œæ›¿æ¢
- [ ] æœªçŸ¥å˜é‡ä¿æŒåŸæ ·è¾“å‡º
- [ ] è¶…é•¿æç¤ºè¯è¢«æ­£ç¡®æ‹¦æˆªï¼ˆ>1000å­—ç¬¦ï¼‰
- [ ] æ¥è¿‘é•¿åº¦é™åˆ¶æ—¶è¿”å›Warningï¼ˆ>800å­—ç¬¦ï¼‰
- [ ] æ— æ•ˆå˜é‡è¢«æ­£ç¡®æ£€æµ‹
- [ ] å±é™©å†…å®¹è¢«æ­£ç¡®æ£€æµ‹
- [ ] æç¤ºè¯åˆå¹¶é¡ºåºæ­£ç¡®
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡â‰¥90%

---

## é˜¶æ®µ3: ä»“åº“å±‚å®ç°ï¼ˆ1å¤©ï¼‰

**ç›®æ ‡**: å®ç°å®Œæ•´çš„æ•°æ®è®¿é—®å±‚

**é‡Œç¨‹ç¢‘**: M3 - ä»“åº“å±‚å®Œæˆ

### 3.1 ä»“åº“æ¥å£

- [ ] T020 åˆ›å»ºPromptRepositoryä»“åº“æ¥å£
  - æ–‡ä»¶: `domain/repository/PromptRepository.kt`
  - æ–¹æ³•:
    - getGlobalConfig(): Result<GlobalPromptConfig>
    - getGlobalPrompt(scene): Result<String>
    - saveGlobalPrompt(scene, prompt): Result<Unit>
    - getContactPrompt(contactId): Result<String?>
    - saveContactPrompt(contactId, prompt): Result<Unit>
    - restoreDefault(scene): Result<Unit>
    - restoreFromHistory(scene, historyIndex): Result<Unit>
    - getHistory(scene): Result<List<PromptHistoryItem>>

### 3.2 ä»“åº“å®ç°

- [ ] T021 åˆ›å»ºPromptRepositoryImplä»“åº“å®ç°
  - æ–‡ä»¶: `data/repository/PromptRepositoryImpl.kt`
  - åŠŸèƒ½: å®ç°PromptRepositoryæ¥å£
  - ç‰¹æ€§: å†…å­˜ç¼“å­˜ã€Mutexé”ä¿æŠ¤ã€å†å²è®°å½•ç®¡ç†
  - é›†æˆ: PromptValidatoréªŒè¯ã€PromptSanitizerå®‰å…¨æ£€æŸ¥
  - ä¾èµ–: T010, T013, T016, T017, T020

### 3.3 ä¾èµ–æ³¨å…¥

- [ ] T022 åˆ›å»ºPromptModule Hiltä¾èµ–æ³¨å…¥æ¨¡å—
  - æ–‡ä»¶: `di/PromptModule.kt`
  - æä¾›:
    - PromptFileBackup
    - PromptFileStorage
    - PromptVariableResolver
    - PromptValidator
    - PromptRepository (ç»‘å®šPromptRepositoryImpl)
    - PromptBuilder
  - ä¾èµ–: T009, T010, T015, T016, T019, T021

**éªŒæ”¶æ ‡å‡†**:
- [ ] å…¨å±€æç¤ºè¯CRUDæ­£å¸¸
- [ ] è”ç³»äººæç¤ºè¯CRUDæ­£å¸¸
- [ ] å†å²è®°å½•ä¿å­˜æ­£å¸¸ï¼ˆæ¯åœºæ™¯æœ€å¤š3æ¡ï¼‰
- [ ] ä»å†å²ç‰ˆæœ¬æ¢å¤æ­£å¸¸
- [ ] æ¢å¤é»˜è®¤åŠŸèƒ½æ­£å¸¸
- [ ] éªŒè¯å¤±è´¥è¿”å›æ­£ç¡®çš„Error
- [ ] å®‰å…¨æ£€æŸ¥è­¦å‘Šæ­£ç¡®è®°å½•
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡â‰¥85%

---

## é˜¶æ®µ4: é›†æˆç°æœ‰AIè°ƒç”¨ï¼ˆ1-2å¤©ï¼‰

**ç›®æ ‡**: å°†æç¤ºè¯ç³»ç»Ÿé›†æˆåˆ°ç°æœ‰AIè°ƒç”¨æµç¨‹

**é‡Œç¨‹ç¢‘**: M4 - é›†æˆå®Œæˆ

### 4.1 UseCaseé›†æˆ

- [ ] T023 ä¿®æ”¹AnalyzeChatUseCaseé›†æˆPromptBuilder
  - æ–‡ä»¶: `domain/usecase/AnalyzeChatUseCase.kt`
  - ä¿®æ”¹:
    - æ³¨å…¥PromptBuilder
    - ä½¿ç”¨PromptContext.fromContact()æ„å»ºä¸Šä¸‹æ–‡
    - ä½¿ç”¨PromptBuilder.buildSystemInstruction()æ„å»ºæŒ‡ä»¤
    - ä½¿ç”¨PromptBuilder.injectContextData()æ³¨å…¥ä¸Šä¸‹æ–‡æ•°æ®
  - ä¾èµ–: T019, T022

- [ ] T024 ä¿®æ”¹CheckDraftUseCaseé›†æˆPromptBuilder
  - æ–‡ä»¶: `domain/usecase/CheckDraftUseCase.kt`
  - ä¿®æ”¹:
    - æ³¨å…¥PromptBuilder
    - ä½¿ç”¨PromptContextæ„å»ºä¸Šä¸‹æ–‡
    - ä½¿ç”¨PromptBuilderæ„å»ºCHECKåœºæ™¯æŒ‡ä»¤
  - ä¾èµ–: T019, T022

- [ ] T025 ä¿®æ”¹SummarizeDailyConversationsUseCaseé›†æˆPromptBuilder
  - æ–‡ä»¶: `domain/usecase/SummarizeDailyConversationsUseCase.kt`
  - ä¿®æ”¹:
    - æ³¨å…¥PromptBuilder
    - ä½¿ç”¨PromptContextæ„å»ºä¸Šä¸‹æ–‡
    - ä½¿ç”¨PromptBuilderæ„å»ºSUMMARYåœºæ™¯æŒ‡ä»¤
  - ä¾èµ–: T019, T022

### 4.2 æ—§ä»£ç è¿ç§»

- [ ] T026 æ ‡è®°PromptTemplatesä¸º@Deprecated
  - æ–‡ä»¶: `domain/util/PromptTemplates.kt`
  - ä¿®æ”¹:
    - æ·»åŠ @Deprecatedæ³¨è§£
    - æ·»åŠ replaceWith = ReplaceWith("PromptBuilder")
    - ä¿ç•™ç°æœ‰ä»£ç ä½œä¸ºè¿‡æ¸¡

### 4.3 é›†æˆéªŒè¯

- [ ] T027 åˆ›å»ºPromptIntegrationTesté›†æˆæµ‹è¯•
  - æ–‡ä»¶: `test/integration/PromptIntegrationTest.kt`
  - æµ‹è¯•:
    - AnalyzeChatUseCaseä½¿ç”¨è‡ªå®šä¹‰æç¤ºè¯
    - CheckDraftUseCaseä½¿ç”¨è‡ªå®šä¹‰æç¤ºè¯
    - SummarizeDailyConversationsUseCaseä½¿ç”¨è‡ªå®šä¹‰æç¤ºè¯
    - è”ç³»äººä¸“å±æç¤ºè¯ç”Ÿæ•ˆ
    - å˜é‡æ›¿æ¢æ­£ç¡®

### 4.4 å¼€å‘è€…è°ƒè¯•å·¥å…·ï¼ˆå¯é€‰ï¼‰

- [ ] T041 [Optional] æ·»åŠ å¼€å‘è€…é€‰é¡¹å…¥å£
  - æ–‡ä»¶: `presentation/ui/screen/settings/DeveloperOptionsScreen.kt`
  - åŠŸèƒ½:
    - ä¸€é”®é‡ç½®æ‰€æœ‰æç¤ºè¯ä¸ºé»˜è®¤å€¼
    - å¼ºåˆ¶è§¦å‘å¤‡ä»½æ¢å¤
    - æŸ¥çœ‹å½“å‰æç¤ºè¯é…ç½®ï¼ˆJSONæ ¼å¼ï¼‰
    - æ¸…é™¤æç¤ºè¯ç¼“å­˜
  - å…¥å£: è®¾ç½®é¡µé¢ â†’ å…³äº â†’ è¿ç»­ç‚¹å‡»ç‰ˆæœ¬å·5æ¬¡ â†’ æ˜¾ç¤ºå¼€å‘è€…é€‰é¡¹
  - ç†ç”±: æé«˜QAå’Œå¼€å‘è€…çš„è°ƒè¯•æ•ˆç‡ï¼Œä¾¿äºæ’æŸ¥æç¤ºè¯ç›¸å…³é—®é¢˜
  - æ³¨æ„: ä»…åœ¨Debugæ„å»ºä¸­å¯ç”¨ï¼ŒReleaseæ„å»ºéšè—
  - **ä¼˜å…ˆçº§**: ğŸŸ¢ ä½ï¼ˆæ ¸å¿ƒåŠŸèƒ½å®Œæˆåå®ç°ï¼‰
  - **å®ç°æ—¶æœº**: é˜¶æ®µ4é›†æˆæµ‹è¯•é€šè¿‡åï¼Œä½œä¸ºè°ƒè¯•è¾…åŠ©å·¥å…·å¼€å‘
  - **ä¸æ ¸å¿ƒåŠŸèƒ½å…³ç³»**: ä¾èµ–T021 PromptRepositoryImplï¼Œè°ƒç”¨å…¶restoreDefault()ã€getGlobalConfig()ç­‰æ–¹æ³•

**éªŒæ”¶æ ‡å‡†**:
- [ ] ç°æœ‰AIåŠŸèƒ½æ­£å¸¸å·¥ä½œï¼ˆæ— å›å½’ï¼‰
- [ ] ç”¨æˆ·è‡ªå®šä¹‰å…¨å±€æç¤ºè¯ç”Ÿæ•ˆ
- [ ] è”ç³»äººä¸“å±æç¤ºè¯ç”Ÿæ•ˆ
- [ ] å˜é‡æ›¿æ¢æ­£ç¡®ï¼ˆ{{contact_name}}ç­‰ï¼‰
- [ ] æç¤ºè¯åˆå¹¶é¡ºåºæ­£ç¡®
- [ ] æ—§ä»£ç æ ‡è®°ä¸ºDeprecatedä½†ä»å¯ç”¨
- [ ] é›†æˆæµ‹è¯•å…¨éƒ¨é€šè¿‡

---

## é˜¶æ®µ5: æµ‹è¯•å’Œæ–‡æ¡£ï¼ˆ1å¤©ï¼‰

**ç›®æ ‡**: ç¡®ä¿è´¨é‡å’Œå®Œå–„æ–‡æ¡£

**é‡Œç¨‹ç¢‘**: M5 - æµ‹è¯•å®Œæˆ

### 5.1 å•å…ƒæµ‹è¯•

- [ ] T028 [P] åˆ›å»ºPromptSceneTest
  - æ–‡ä»¶: `test/domain/model/PromptSceneTest.kt`
  - æµ‹è¯•: æšä¸¾å€¼ã€displayNameã€availableVariables

- [ ] T029 [P] åˆ›å»ºPromptContextTest
  - æ–‡ä»¶: `test/domain/model/PromptContextTest.kt`
  - æµ‹è¯•: getVariable()ã€fromContact()ã€è¾¹ç•Œæƒ…å†µ

- [ ] T030 [P] åˆ›å»ºGlobalPromptConfigTest
  - æ–‡ä»¶: `test/domain/model/GlobalPromptConfigTest.kt`
  - æµ‹è¯•: createDefault()ã€åºåˆ—åŒ–/ååºåˆ—åŒ–

- [ ] T031 [P] åˆ›å»ºPromptErrorTest
  - æ–‡ä»¶: `test/domain/model/PromptErrorTest.kt`
  - æµ‹è¯•: getUserMessage()ã€isRecoverable()

- [ ] T032 åˆ›å»ºPromptVariableResolverTest
  - æ–‡ä»¶: `test/domain/util/PromptVariableResolverTest.kt`
  - æµ‹è¯•:
    - æ›¿æ¢æ‰€æœ‰æœ‰æ•ˆå˜é‡
    - ä¿ç•™æœªçŸ¥å˜é‡åŸæ ·
    - å˜é‡åå¤§å°å†™ä¸æ•æ„Ÿ
    - extractVariablesç¼“å­˜å‘½ä¸­
    - findInvalidVariablesæ£€æµ‹æ— æ•ˆå˜é‡
  - ä¾èµ–: T015

- [ ] T033 åˆ›å»ºPromptValidatorTest
  - æ–‡ä»¶: `test/domain/util/PromptValidatorTest.kt`
  - æµ‹è¯•:
    - ç©ºæç¤ºè¯è¿”å›Error
    - è¶…é•¿æç¤ºè¯è¿”å›Error
    - æ— æ•ˆå˜é‡è¿”å›Error
    - æ¥è¿‘é•¿åº¦é™åˆ¶è¿”å›Warning
    - æœ‰æ•ˆæç¤ºè¯è¿”å›Success
  - ä¾èµ–: T016

- [ ] T034 åˆ›å»ºPromptSanitizerTest
  - æ–‡ä»¶: `test/domain/util/PromptSanitizerTest.kt`
  - æµ‹è¯•:
    - æ£€æµ‹ä¸­æ–‡æ³¨å…¥
    - æ£€æµ‹è‹±æ–‡æ³¨å…¥
    - å®‰å…¨å†…å®¹é€šè¿‡
  - ä¾èµ–: T017

- [ ] T035 åˆ›å»ºPromptBuilderTest
  - æ–‡ä»¶: `test/domain/util/PromptBuilderTest.kt`
  - æµ‹è¯•:
    - åˆå¹¶é¡ºåºæ­£ç¡®
    - å˜é‡æ³¨å…¥æ­£ç¡®
    - è”ç³»äººæç¤ºè¯ä¼˜å…ˆçº§
  - ä¾èµ–: T019

- [ ] T036 åˆ›å»ºPromptFileStorageTest
  - æ–‡ä»¶: `test/data/local/PromptFileStorageTest.kt`
  - æµ‹è¯•:
    - é¦–æ¬¡è¯»å–åˆ›å»ºé»˜è®¤é…ç½®
    - å†™å…¥åè¯»å–ä¸€è‡´
    - ç¼“å­˜æœºåˆ¶æœ‰æ•ˆ
    - å¹¶å‘è¯»å†™å®‰å…¨æ€§
  - ä¾èµ–: T010, T014
  - æŠ€æœ¯è¦ç‚¹: ä½¿ç”¨ `StandardTestDispatcher` æ›¿æ¢ `@IoDispatcher`ï¼Œé€šè¿‡ `advanceUntilIdle()` æ§åˆ¶åç¨‹æ‰§è¡Œæ—¶åº

- [ ] T037 åˆ›å»ºPromptFileBackupTest
  - æ–‡ä»¶: `test/data/local/PromptFileBackupTest.kt`
  - æµ‹è¯•:
    - åˆ›å»ºå¤‡ä»½æˆåŠŸ
    - æ¢å¤å¤‡ä»½æˆåŠŸ
    - æ¸…ç†æ—§å¤‡ä»½ï¼ˆä¿ç•™3ä¸ªï¼‰
  - ä¾èµ–: T009, T014
  - æŠ€æœ¯è¦ç‚¹: ä½¿ç”¨ `StandardTestDispatcher` æ›¿æ¢ `@IoDispatcher`

- [ ] T038 åˆ›å»ºPromptRepositoryImplTest
  - æ–‡ä»¶: `test/data/repository/PromptRepositoryImplTest.kt`
  - æµ‹è¯•:
    - éªŒè¯å¤±è´¥è¿”å›Error
    - æˆåŠŸä¿å­˜å¹¶æ›´æ–°å†å²
    - æ¢å¤å†å²è®°å½•
    - æ¢å¤é»˜è®¤å€¼
    - Mutexé”å¹¶å‘ä¿æŠ¤
  - ä¾èµ–: T021, T014, T040
  - æŠ€æœ¯è¦ç‚¹: ä½¿ç”¨ `StandardTestDispatcher` æ›¿æ¢ `@IoDispatcher`ï¼Œä½¿ç”¨ `PromptTestDataFactory` ç”Ÿæˆæµ‹è¯•æ•°æ®

### 5.2 Androidæµ‹è¯•

- [ ] T039 åˆ›å»ºDatabaseMigration7To8Test
  - æ–‡ä»¶: `androidTest/data/local/DatabaseMigration7To8Test.kt`
  - æµ‹è¯•:
    - è¿ç§»æ·»åŠ custom_promptå­—æ®µ
    - è¿ç§»ä¿ç•™ç°æœ‰æ•°æ®
    - æ–°å­—æ®µé»˜è®¤ä¸ºNULL
  - ä¾èµ–: T012

### 5.3 æµ‹è¯•å·¥å…·

> âš ï¸ **æ³¨æ„**: T040å·²æå‰åˆ°é˜¶æ®µ2æ‰§è¡Œï¼Œæ­¤å¤„ä»…ä½œè®°å½•

- [x] T040 åˆ›å»ºPromptTestDataFactoryæµ‹è¯•æ•°æ®å·¥å‚ï¼ˆå·²åœ¨é˜¶æ®µ2å®Œæˆï¼‰
  - æ–‡ä»¶: `test/testutil/PromptTestDataFactory.kt`
  - å‚è§: é˜¶æ®µ2 â†’ 2.0 æµ‹è¯•åŸºç¡€è®¾æ–½

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] æ•°æ®åº“è¿ç§»æµ‹è¯•é€šè¿‡
- [ ] æµ‹è¯•è¦†ç›–ç‡è¾¾æ ‡:
  - PromptVariableResolver: â‰¥95%
  - PromptValidator: â‰¥95%
  - PromptSanitizer: â‰¥90%
  - PromptBuilder: â‰¥85%
  - PromptRepositoryImpl: â‰¥90%
  - PromptFileStorage: â‰¥85%
  - æ•°æ®åº“è¿ç§»: 100%

---

## ä»»åŠ¡æ€»è§ˆ

### ä»»åŠ¡ç»Ÿè®¡

| é˜¶æ®µ | ä»»åŠ¡æ•° | é¢„è®¡å·¥æ—¶ | çŠ¶æ€ |
|------|--------|----------|------|
| é˜¶æ®µ1: æ•°æ®æ¨¡å‹å’Œå­˜å‚¨å±‚ | 14 | 1-2å¤© | ğŸ“ å¾…å¼€å‘ |
| é˜¶æ®µ2: æ ¸å¿ƒç»„ä»¶å®ç° | 6 | 1-2å¤© | ğŸ“ å¾…å¼€å‘ |
| é˜¶æ®µ3: ä»“åº“å±‚å®ç° | 3 | 1å¤© | ğŸ“ å¾…å¼€å‘ |
| é˜¶æ®µ4: é›†æˆç°æœ‰AIè°ƒç”¨ | 6 | 1-2å¤© | ğŸ“ å¾…å¼€å‘ |
| é˜¶æ®µ5: æµ‹è¯•å’Œæ–‡æ¡£ | 12 | 1å¤© | ğŸ“ å¾…å¼€å‘ |
| **æ€»è®¡** | **41** | **5-7å¤©** | ğŸ“ å¾…å¼€å‘ |

> ğŸ“ **è°ƒæ•´è¯´æ˜**:
> - T040ï¼ˆæµ‹è¯•æ•°æ®å·¥å‚ï¼‰ä»é˜¶æ®µ5æå‰åˆ°é˜¶æ®µ2ï¼Œä¾¿äºåç»­æµ‹è¯•å¤ç”¨
> - T041ï¼ˆå¼€å‘è€…é€‰é¡¹ï¼‰ä¸ºå¯é€‰ä»»åŠ¡ï¼Œä¸è®¡å…¥å¿…é¡»å·¥æ—¶

### ä»»åŠ¡ä¾èµ–å›¾

```
é˜¶æ®µ1 (æ•°æ®æ¨¡å‹å’Œå­˜å‚¨å±‚)
â”œâ”€â”€ T001-T007 [P] é¢†åŸŸæ¨¡å‹ï¼ˆå¯å¹¶è¡Œï¼‰
â”œâ”€â”€ T008 DefaultPrompts
â”œâ”€â”€ T009 PromptFileBackup â† T014 (DispatcherModule)
â”œâ”€â”€ T010 PromptFileStorage â† T003, T008, T009
â”œâ”€â”€ T011-T013 æ•°æ®åº“è¿ç§»ï¼ˆé¡ºåºæ‰§è¡Œï¼‰
â””â”€â”€ T014 DispatcherModule

é˜¶æ®µ2 (æ ¸å¿ƒç»„ä»¶å®ç°)
â”œâ”€â”€ T040 PromptTestDataFactory âš ï¸ æå‰æ‰§è¡Œï¼ˆæµ‹è¯•åŸºç¡€è®¾æ–½ï¼‰
â”œâ”€â”€ T015 PromptVariableResolver â† T002
â”œâ”€â”€ T016 PromptValidator â† T001, T007, T015
â”œâ”€â”€ T017 PromptSanitizer
â”œâ”€â”€ T018 SystemPrompts â† T001
â””â”€â”€ T019 PromptBuilder â† T015, T018, T020

é˜¶æ®µ3 (ä»“åº“å±‚å®ç°)
â”œâ”€â”€ T020 PromptRepositoryæ¥å£
â”œâ”€â”€ T021 PromptRepositoryImpl â† T010, T013, T016, T017, T020
â””â”€â”€ T022 PromptModule â† T009, T010, T015, T016, T019, T021

é˜¶æ®µ4 (é›†æˆç°æœ‰AIè°ƒç”¨)
â”œâ”€â”€ T023 AnalyzeChatUseCase â† T019, T022
â”œâ”€â”€ T024 CheckDraftUseCase â† T019, T022
â”œâ”€â”€ T025 SummarizeDailyConversationsUseCase â† T019, T022
â”œâ”€â”€ T026 æ ‡è®°PromptTemplatesä¸ºDeprecated
â”œâ”€â”€ T027 é›†æˆæµ‹è¯• â† T023, T024, T025
â””â”€â”€ T041 [Optional] å¼€å‘è€…é€‰é¡¹ â† T021

é˜¶æ®µ5 (æµ‹è¯•å’Œæ–‡æ¡£)
â”œâ”€â”€ T028-T031 [P] æ¨¡å‹æµ‹è¯•ï¼ˆå¯å¹¶è¡Œï¼‰
â”œâ”€â”€ T032-T035 æ ¸å¿ƒç»„ä»¶æµ‹è¯• â† T040
â”œâ”€â”€ T036-T038 å­˜å‚¨å±‚æµ‹è¯• â† T014, T040 (ä½¿ç”¨StandardTestDispatcher)
â””â”€â”€ T039 æ•°æ®åº“è¿ç§»æµ‹è¯• â† T012
```

**TestDispatcherä½¿ç”¨è¯´æ˜**:
- T036/T037/T038 éœ€è¦ä½¿ç”¨ `StandardTestDispatcher` æ›¿æ¢ `@IoDispatcher`
- é€šè¿‡ `advanceUntilIdle()` æ§åˆ¶åç¨‹æ‰§è¡Œæ—¶åºï¼Œç¡®ä¿æµ‹è¯•å¯é¢„æµ‹æ€§
- ç¤ºä¾‹é…ç½®è§ TDD-00005 ç¬¬5.2èŠ‚

---

## æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶ï¼ˆ16ä¸ªï¼‰

| æ–‡ä»¶è·¯å¾„ | ä»»åŠ¡ç¼–å· | è¯´æ˜ |
|---------|---------|------|
| `domain/model/PromptScene.kt` | T001 | åœºæ™¯æšä¸¾ |
| `domain/model/PromptContext.kt` | T002 | å˜é‡ä¸Šä¸‹æ–‡ |
| `domain/model/GlobalPromptConfig.kt` | T003 | å…¨å±€é…ç½®æ¨¡å‹ |
| `domain/model/ScenePromptConfig.kt` | T004 | åœºæ™¯é…ç½®æ¨¡å‹ |
| `domain/model/PromptHistoryItem.kt` | T005 | å†å²è®°å½•æ¨¡å‹ |
| `domain/model/PromptError.kt` | T006 | é”™è¯¯ç±»å‹å®šä¹‰ |
| `domain/model/PromptValidationResult.kt` | T007 | éªŒè¯ç»“æœ |
| `domain/repository/PromptRepository.kt` | T020 | ä»“åº“æ¥å£ |
| `domain/util/PromptBuilder.kt` | T019 | æç¤ºè¯æ„å»ºå™¨ |
| `domain/util/PromptVariableResolver.kt` | T015 | å˜é‡è§£æå™¨ |
| `domain/util/PromptValidator.kt` | T016 | è¾“å…¥éªŒè¯å™¨ |
| `domain/util/PromptSanitizer.kt` | T017 | å®‰å…¨è¿‡æ»¤å™¨ |
| `domain/util/SystemPrompts.kt` | T018 | ç³»ç»Ÿæç¤ºè¯å¸¸é‡ |
| `data/repository/PromptRepositoryImpl.kt` | T021 | ä»“åº“å®ç° |
| `data/local/PromptFileStorage.kt` | T010 | JSONæ–‡ä»¶å­˜å‚¨ |
| `data/local/PromptFileBackup.kt` | T009 | å¤‡ä»½æœºåˆ¶ |
| `data/local/DefaultPrompts.kt` | T008 | é»˜è®¤æç¤ºè¯æ¨¡æ¿ |
| `di/PromptModule.kt` | T022 | Hiltæ¨¡å— |
| `di/DispatcherModule.kt` | T014 | Dispatcheræ³¨å…¥æ¨¡å— |

### ä¿®æ”¹æ–‡ä»¶ï¼ˆ6ä¸ªï¼‰

| æ–‡ä»¶è·¯å¾„ | ä»»åŠ¡ç¼–å· | ä¿®æ”¹å†…å®¹ |
|---------|---------|---------|
| `data/local/AppDatabase.kt` | T012 | ç‰ˆæœ¬å‡çº§åˆ°v8ï¼Œæ·»åŠ MIGRATION_7_8 |
| `data/local/dao/ContactDao.kt` | T013 | æ·»åŠ getCustomPrompt/updateCustomPromptæ–¹æ³• |
| `data/local/entity/ContactProfileEntity.kt` | T011 | æ·»åŠ custom_promptå­—æ®µ |
| `domain/usecase/AnalyzeChatUseCase.kt` | T023 | é›†æˆPromptBuilder |
| `domain/usecase/CheckDraftUseCase.kt` | T024 | é›†æˆPromptBuilder |
| `domain/usecase/SummarizeDailyConversationsUseCase.kt` | T025 | é›†æˆPromptBuilder |
| `domain/util/PromptTemplates.kt` | T026 | æ ‡è®°ä¸º@Deprecated |

### æµ‹è¯•æ–‡ä»¶ï¼ˆ13ä¸ªï¼‰

| æ–‡ä»¶è·¯å¾„ | ä»»åŠ¡ç¼–å· | è¯´æ˜ | ç‰¹æ®Šä¾èµ– |
|---------|---------|------|---------|
| `test/testutil/PromptTestDataFactory.kt` | T040 | æµ‹è¯•æ•°æ®å·¥å‚ | âš ï¸ é˜¶æ®µ2å‰ç½® |
| `test/domain/model/PromptSceneTest.kt` | T028 | åœºæ™¯æšä¸¾æµ‹è¯• | - |
| `test/domain/model/PromptContextTest.kt` | T029 | å˜é‡ä¸Šä¸‹æ–‡æµ‹è¯• | - |
| `test/domain/model/GlobalPromptConfigTest.kt` | T030 | é…ç½®æ¨¡å‹æµ‹è¯• | - |
| `test/domain/model/PromptErrorTest.kt` | T031 | é”™è¯¯ç±»å‹æµ‹è¯• | - |
| `test/domain/util/PromptVariableResolverTest.kt` | T032 | å˜é‡è§£æå™¨æµ‹è¯• | T040 |
| `test/domain/util/PromptValidatorTest.kt` | T033 | éªŒè¯å™¨æµ‹è¯• | T040 |
| `test/domain/util/PromptSanitizerTest.kt` | T034 | å®‰å…¨è¿‡æ»¤å™¨æµ‹è¯• | T040 |
| `test/domain/util/PromptBuilderTest.kt` | T035 | æ„å»ºå™¨æµ‹è¯• | T040 |
| `test/data/local/PromptFileStorageTest.kt` | T036 | æ–‡ä»¶å­˜å‚¨æµ‹è¯• | T014, T040, TestDispatcher |
| `test/data/local/PromptFileBackupTest.kt` | T037 | å¤‡ä»½æœºåˆ¶æµ‹è¯• | T014, TestDispatcher |
| `test/data/repository/PromptRepositoryImplTest.kt` | T038 | ä»“åº“å®ç°æµ‹è¯• | T014, T040, TestDispatcher |
| `androidTest/data/local/DatabaseMigration7To8Test.kt` | T039 | æ•°æ®åº“è¿ç§»æµ‹è¯• | - |
| `test/integration/PromptIntegrationTest.kt` | T027 | é›†æˆæµ‹è¯• | T040 |

### å¯é€‰æ–‡ä»¶ï¼ˆ1ä¸ªï¼‰

| æ–‡ä»¶è·¯å¾„ | ä»»åŠ¡ç¼–å· | è¯´æ˜ |
|---------|---------|------|
| `presentation/ui/screen/settings/DeveloperOptionsScreen.kt` | T041 | å¼€å‘è€…è°ƒè¯•é€‰é¡¹ï¼ˆä»…Debugï¼‰ |

---

## æµ‹è¯•è¦†ç›–ç‡æ ‡å‡†

æ ¹æ®DR-00011å®¡æŸ¥å»ºè®®ï¼Œåˆ¶å®šç»Ÿä¸€çš„æµ‹è¯•è¦†ç›–ç‡æ ‡å‡†ï¼š

### æ¨¡å—åˆ†ç±»ä¸è¦†ç›–ç‡è¦æ±‚

| æ¨¡å—ç±»å‹ | è¦†ç›–ç‡è¦æ±‚ | é€‚ç”¨æ¨¡å— | è¯´æ˜ |
|---------|-----------|---------|------|
| **æ ¸å¿ƒä¸šåŠ¡é€»è¾‘** | â‰¥95% | PromptVariableResolver, PromptValidator | ç›´æ¥å½±å“AIè¾“å‡ºè´¨é‡ |
| **å®‰å…¨ç›¸å…³** | â‰¥90% | PromptSanitizer | é˜²æ­¢Prompt Injection |
| **æ•°æ®è®¿é—®å±‚** | â‰¥90% | PromptRepositoryImpl | æ•°æ®å®Œæ•´æ€§å…³é”® |
| **å­˜å‚¨å±‚** | â‰¥85% | PromptFileStorage, PromptFileBackup | IOæ“ä½œï¼Œéƒ¨åˆ†è¾¹ç•Œéš¾è¦†ç›– |
| **æ„å»ºå™¨/å·¥å…·ç±»** | â‰¥85% | PromptBuilder, SystemPrompts | ç»„åˆé€»è¾‘ |
| **æ•°æ®åº“è¿ç§»** | 100% | MIGRATION_7_8 | æ•°æ®å®‰å…¨ï¼Œå¿…é¡»å®Œå…¨è¦†ç›– |
| **æ•°æ®æ¨¡å‹** | â‰¥80% | PromptScene, PromptContextç­‰ | ç®€å•æ•°æ®ç±» |

### æµ‹è¯•ç±»å‹è¦æ±‚

| æµ‹è¯•ç±»å‹ | æ•°é‡è¦æ±‚ | è¯´æ˜ |
|---------|---------|------|
| **å•å…ƒæµ‹è¯•** | æ¯ä¸ªå…¬å¼€æ–¹æ³•è‡³å°‘1ä¸ª | è¦†ç›–æ­£å¸¸è·¯å¾„å’Œè¾¹ç•Œæƒ…å†µ |
| **é›†æˆæµ‹è¯•** | æ¯ä¸ªUseCaseè‡³å°‘1ä¸ª | éªŒè¯ç«¯åˆ°ç«¯æµç¨‹ |
| **æ•°æ®åº“è¿ç§»æµ‹è¯•** | æ¯ä¸ªMigrationè‡³å°‘2ä¸ª | éªŒè¯è¿ç§»å’Œæ•°æ®ä¿ç•™ |

### è¦†ç›–ç‡æ£€æŸ¥å‘½ä»¤

```bash
# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
./gradlew testDebugUnitTest jacocoTestReport

# æŸ¥çœ‹æŠ¥å‘Š
open app/build/reports/jacoco/testDebugUnitTest/html/index.html
```

---

## é£é™©è¯„ä¼°

| é£é™© | ä¸¥é‡ç¨‹åº¦ | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|------|---------|------|------|---------|
| JSONè§£æå¤±è´¥ | ğŸŸ¡ ä¸­ | 20% | é…ç½®ä¸¢å¤± | æä¾›é»˜è®¤å€¼å›é€€ï¼Œå¤‡ä»½æœºåˆ¶ |
| æ•°æ®åº“è¿ç§»å¤±è´¥ | ğŸ”´ é«˜ | 10% | æ•°æ®ä¸¢å¤± | å®Œæ•´æµ‹è¯•è¿ç§»è„šæœ¬ï¼Œæä¾›å›æ»šæ–¹æ¡ˆ |
| å˜é‡æ›¿æ¢æ€§èƒ½é—®é¢˜ | ğŸŸ¢ ä½ | 10% | å“åº”å˜æ…¢ | æ­£åˆ™è¡¨è¾¾å¼é¢„ç¼–è¯‘ï¼Œç¼“å­˜æœºåˆ¶ |
| ä¸ç°æœ‰ä»£ç å†²çª | ğŸŸ¡ ä¸­ | 30% | åŠŸèƒ½å¼‚å¸¸ | æ¸è¿›å¼é›†æˆï¼Œå……åˆ†æµ‹è¯• |
| Prompt Injectionæ”»å‡» | ğŸŸ¡ ä¸­ | 15% | å®‰å…¨é£é™© | PromptSanitizeræ£€æµ‹ï¼ŒSystem Footerå®‰å…¨çº¦æŸ |

---

## ç›¸å…³æ–‡æ¡£

- [PRD-00005-æç¤ºè¯ç®¡ç†ç³»ç»Ÿéœ€æ±‚](../PRD/PRD-00005-æç¤ºè¯ç®¡ç†ç³»ç»Ÿéœ€æ±‚.md)
- [FD-00005-æç¤ºè¯ç®¡ç†ç³»ç»ŸåŠŸèƒ½è®¾è®¡](../FD/FD-00005-æç¤ºè¯ç®¡ç†ç³»ç»ŸåŠŸèƒ½è®¾è®¡.md)
- [TDD-00005-æç¤ºè¯ç®¡ç†ç³»ç»ŸæŠ€æœ¯è®¾è®¡](../TDD/TDD-00005-æç¤ºè¯ç®¡ç†ç³»ç»ŸæŠ€æœ¯è®¾è®¡.md)
- [RESEARCH-00001-æç¤ºè¯ç³»ç»Ÿè°ƒç ”æŠ¥å‘Š](../è°ƒç ”/RESEARCH-00001-æç¤ºè¯ç³»ç»Ÿè°ƒç ”æŠ¥å‘Š.md)
