# TD-00006: æç¤ºè¯ç¼–è¾‘ç•Œé¢ä»»åŠ¡æ¸…å•

## æ–‡æ¡£ä¿¡æ¯

**æ–‡æ¡£ç¼–å·**: TD-00006  
**ç‰ˆæœ¬**: 1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-12-16  
**æœ€åæ›´æ–°**: 2025-12-16  
**éœ€æ±‚æ–‡æ¡£**: `æ–‡æ¡£/å¼€å‘æ–‡æ¡£/PRD/PRD-00006-æç¤ºè¯ç¼–è¾‘ç•Œé¢éœ€æ±‚.md` (v1.0)  
**åŠŸèƒ½è®¾è®¡**: `æ–‡æ¡£/å¼€å‘æ–‡æ¡£/FD/FD-00006-æç¤ºè¯ç¼–è¾‘ç•Œé¢åŠŸèƒ½è®¾è®¡.md` (v1.1)  
**æŠ€æœ¯è®¾è®¡**: `æ–‡æ¡£/å¼€å‘æ–‡æ¡£/TDD/TDD-00006-æç¤ºè¯ç¼–è¾‘ç•Œé¢æŠ€æœ¯è®¾è®¡.md` (v1.1)  
**çŠ¶æ€**: ï¿½ å¾…å¼€å‘ä¸­  
**è´Ÿè´£äºº**: Kiro  
**é¢„è®¡å·¥ä½œé‡**: 2-3ä¸ªå·¥ä½œæ—¥  
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­  
**å®é™…è¿›åº¦**: é˜¶æ®µ1-3å®Œæˆï¼Œé˜¶æ®µ4éƒ¨åˆ†å®Œæˆ

---

## ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | ä½œè€… | å˜æ›´è¯´æ˜ |
|------|------|------|----------|
| 1.0 | 2025-12-16 | Kiro | åˆå§‹ç‰ˆæœ¬ï¼ŒåŸºäºTDD-00006 v1.1 |
| 1.1 | 2025-12-16 | Kiro | ä¼˜åŒ–ï¼šT013å­—ç¬¦ä¸²å‚æ•°åŒ–ã€T012å¢åŠ Previewå­ä»»åŠ¡ |

---

## ä»»åŠ¡æ ¼å¼è¯´æ˜

- **[P]**: å¯å¹¶è¡Œæ‰§è¡Œï¼ˆä¸åŒæ–‡ä»¶ï¼Œæ— ä¾èµ–ï¼‰
- **[é˜¶æ®µX]**: æ‰€å±å¼€å‘é˜¶æ®µ
- **[ä¾èµ–]**: ä¾èµ–å…¶ä»–ä»»åŠ¡å®Œæˆ
- æè¿°ä¸­åŒ…å«ç¡®åˆ‡çš„æ–‡ä»¶è·¯å¾„

---

## è·¯å¾„çº¦å®š

åŸºäºé¡¹ç›®ç»“æ„ `com.empathy.ai/`:
- **è¡¨ç°å±‚**: `presentation/ui/screen/prompt/`, `presentation/viewmodel/`
- **å¯¼èˆª**: `presentation/navigation/`
- **ä¸»é¢˜**: `presentation/theme/`
- **æµ‹è¯•**: `test/`, `androidTest/`
- **èµ„æº**: `res/values/`, `res/values-en/`

---

## å¼€å‘é˜¶æ®µæ˜ å°„

æ ¹æ®TDD-00006 v1.1ï¼Œæœ¬åŠŸèƒ½åˆ†ä¸º4ä¸ªå¼€å‘é˜¶æ®µï¼š

- **é˜¶æ®µ1**: æ•°æ®æ¨¡å‹å’ŒViewModelï¼ˆ0.5å¤©ï¼‰ğŸ¯ åŸºç¡€
- **é˜¶æ®µ2**: UIç»„ä»¶å®ç°ï¼ˆ1å¤©ï¼‰
- **é˜¶æ®µ3**: å¯¼èˆªé›†æˆï¼ˆ0.5å¤©ï¼‰
- **é˜¶æ®µ4**: æµ‹è¯•å’Œä¼˜åŒ–ï¼ˆ0.5-1å¤©ï¼‰

**æ€»å·¥æœŸ**: 2-3ä¸ªå·¥ä½œæ—¥

---

## å‰ç½®ä¾èµ–

æœ¬ä»»åŠ¡ä¾èµ–TD-00005æç¤ºè¯ç®¡ç†ç³»ç»Ÿçš„ä»¥ä¸‹ç»„ä»¶ï¼š

| ä¾èµ–ç»„ä»¶ | æ–‡ä»¶è·¯å¾„ | çŠ¶æ€ |
|---------|---------|------|
| PromptScene | `domain/model/PromptScene.kt` | âœ… å·²å®ç° |
| PromptRepository | `domain/repository/PromptRepository.kt` | âœ… å·²å®ç° |
| PromptValidator | `domain/util/PromptValidator.kt` | âœ… å·²å®ç° |
| EmotionalBackground | `presentation/ui/component/emotion/EmotionalBackground.kt` | âœ… å·²å­˜åœ¨ |
| GlassmorphicCard | `presentation/ui/component/emotion/GlassmorphicCard.kt` | âœ… å·²å­˜åœ¨ |

---

## é˜¶æ®µ1: æ•°æ®æ¨¡å‹å’ŒViewModelï¼ˆ0.5å¤©ï¼‰

**ç›®æ ‡**: å»ºç«‹UIçŠ¶æ€ç®¡ç†åŸºç¡€

**é‡Œç¨‹ç¢‘**: M1 - ViewModelå®Œæˆ

### 1.1 æ•°æ®æ¨¡å‹

- [x] T001 [P] åˆ›å»ºPromptEditorUiState UIçŠ¶æ€ç±» âœ…
  - æ–‡ä»¶: `presentation/ui/screen/prompt/PromptEditorUiState.kt`
  - å†…å®¹:
    - editMode: PromptEditModeï¼ˆç¼–è¾‘æ¨¡å¼ï¼‰
    - originalPrompt: Stringï¼ˆåŸå§‹æç¤ºè¯ï¼‰
    - currentPrompt: Stringï¼ˆå½“å‰ç¼–è¾‘å†…å®¹ï¼‰
    - placeholderText: Stringï¼ˆåŠ¨æ€å ä½ç¬¦ï¼‰
    - isLoading: Booleanï¼ˆåŠ è½½çŠ¶æ€ï¼‰
    - isSaving: Booleanï¼ˆä¿å­˜çŠ¶æ€ï¼‰
    - showDiscardDialog: Booleanï¼ˆæ”¾å¼ƒå¯¹è¯æ¡†ï¼‰
    - errorMessage: String?ï¼ˆé”™è¯¯ä¿¡æ¯ï¼‰
  - è®¡ç®—å±æ€§: charCountã€isOverLimitã€isNearLimitã€hasUnsavedChangesã€canSave
  - æ ‡é¢˜è·å–: ä½¿ç”¨getTitleResId()è¿”å›èµ„æºIDï¼Œè”ç³»äººæ¨¡å¼è¿”å›å‚æ•°åŒ–å­—ç¬¦ä¸²èµ„æº
  - å¸¸é‡: MAX_PROMPT_LENGTH=1000ã€WARN_PROMPT_LENGTH=800
  - æ³¨æ„: titleTextæ”¹ä¸ºåœ¨Composableä¸­é€šè¿‡stringResourceè·å–ï¼Œæ”¯æŒå‚æ•°åŒ–

- [x] T002 [P] åˆ›å»ºPromptEditModeç¼–è¾‘æ¨¡å¼å¯†å°ç±» âœ…
  - æ–‡ä»¶: `presentation/ui/screen/prompt/PromptEditMode.kt`
  - å†…å®¹:
    - GlobalScene(scene: PromptScene)ï¼šå…¨å±€åœºæ™¯ç¼–è¾‘
    - ContactCustom(contactId: String, contactName: String)ï¼šè”ç³»äººä¸“å±ç¼–è¾‘

- [x] T003 [P] åˆ›å»ºPromptEditorUiEvent UIäº‹ä»¶å¯†å°ç±» âœ…
  - æ–‡ä»¶: `presentation/ui/screen/prompt/PromptEditorUiEvent.kt`
  - å†…å®¹:
    - UpdatePrompt(text: String)
    - SavePrompt
    - CancelEdit
    - ConfirmDiscard
    - DismissDiscardDialog
    - ClearError

- [x] T004 [P] åˆ›å»ºPromptEditorResultç¼–è¾‘ç»“æœå¯†å°ç±» âœ…
  - æ–‡ä»¶: `presentation/ui/screen/prompt/PromptEditorResult.kt`
  - å†…å®¹:
    - Savedï¼šä¿å­˜æˆåŠŸ
    - Cancelledï¼šå–æ¶ˆç¼–è¾‘

### 1.2 ViewModel

- [x] T005 åˆ›å»ºPromptEditorViewModel âœ…
  - æ–‡ä»¶: `presentation/viewmodel/PromptEditorViewModel.kt`
  - åŠŸèƒ½:
    - è§£æSavedStateHandleè·å–ç¼–è¾‘æ¨¡å¼
    - åŠ è½½æç¤ºè¯ï¼ˆå…¨å±€/è”ç³»äººï¼‰
    - å¤„ç†è¾“å…¥äº‹ä»¶ï¼ˆå«å¤§æ–‡æœ¬æˆªæ–­ä¿æŠ¤ï¼‰
    - ä¿å­˜æç¤ºè¯
    - å¤„ç†å–æ¶ˆ/æ”¾å¼ƒé€»è¾‘
  - ç‰¹æ€§:
    - Channel + debounceé˜²æŠ–ï¼ˆ100msï¼‰
    - å¤§æ–‡æœ¬æˆªæ–­ä¿æŠ¤ï¼ˆtake 1000ï¼‰
    - SharedFlowå‘é€ç¼–è¾‘ç»“æœ
  - ä¾èµ–: T001-T004, PromptRepository, PromptValidator

**éªŒæ”¶æ ‡å‡†**:
- [x] UiStateæ­£ç¡®ç®¡ç†æ‰€æœ‰ç•Œé¢çŠ¶æ€ âœ…
- [x] ç¼–è¾‘æ¨¡å¼æ­£ç¡®è§£æï¼ˆå…¨å±€/è”ç³»äººï¼‰âœ…
- [x] è¾“å…¥é˜²æŠ–æ­£å¸¸å·¥ä½œ âœ…
- [x] å¤§æ–‡æœ¬ç²˜è´´è¢«æ­£ç¡®æˆªæ–­ âœ…
- [x] ä¿å­˜/å–æ¶ˆé€»è¾‘æ­£ç¡® âœ…

---

## é˜¶æ®µ2: UIç»„ä»¶å®ç°ï¼ˆ1å¤©ï¼‰

**ç›®æ ‡**: å®ç°å®Œæ•´çš„ç¼–è¾‘ç•Œé¢

**é‡Œç¨‹ç¢‘**: M2 - UIç»„ä»¶å®Œæˆ

### 2.1 ä¸»é¢˜æ‰©å±•

- [x] T006 æ‰©å±•Color.ktæ·»åŠ å“ç‰Œè‰² âœ…
  - æ–‡ä»¶: `presentation/theme/Color.kt`
  - æ·»åŠ :
    - BrandWarmGold = Color(0xFFF5A623)
    - BrandWarmOrange = Color(0xFFFF9500)
    - BrandWarmAmber = Color(0xFFFFCC00)

### 2.2 é¡¶éƒ¨å¯¼èˆªæ 

- [x] T007 åˆ›å»ºPromptEditorTopBarç»„ä»¶ âœ…
  - æ–‡ä»¶: `presentation/ui/screen/prompt/component/PromptEditorTopBar.kt`
  - åŠŸèƒ½:
    - å·¦ä¾§ï¼šå–æ¶ˆæŒ‰é’®ï¼ˆTextButtonï¼‰
    - ä¸­é—´ï¼šæ ‡é¢˜ï¼ˆåŠ¨æ€æ˜¾ç¤º"ç¼–è¾‘æŒ‡ä»¤"/"ç¼–è¾‘ä¸“å±æŒ‡ä»¤"ï¼‰
    - å³ä¾§ï¼šå®ŒæˆæŒ‰é’®ï¼ˆå“ç‰Œè‰²ï¼‰/ åŠ è½½åœˆï¼ˆisSavingæ—¶ï¼‰
  - è§„æ ¼:
    - é«˜åº¦: 44.dp
    - å®ŒæˆæŒ‰é’®: BrandWarmGold
    - åŠ è½½åœˆ: 20.dp, strokeWidth 2.dp
  - ä¾èµ–: T006

### 2.3 è¾“å…¥ç»„ä»¶

- [x] T008 åˆ›å»ºPromptInputFieldè¾“å…¥æ¡†ç»„ä»¶ âœ…
  - æ–‡ä»¶: `presentation/ui/screen/prompt/component/PromptInputField.kt`
  - åŠŸèƒ½:
    - BasicTextFieldå¤šè¡Œè¾“å…¥
    - åŠ¨æ€å ä½ç¬¦æ˜¾ç¤º
    - å“ç‰Œè‰²å…‰æ ‡å’Œé€‰ä¸­æ‰‹æŸ„
    - BringIntoViewRequesterå…‰æ ‡è·Ÿéš
  - è§„æ ¼:
    - æœ€å°é«˜åº¦: 200.dp
    - æ–‡å­—æ ·å¼: bodyLarge, lineHeight 24.sp
    - å…‰æ ‡é¢œè‰²: BrandWarmGold
    - å ä½ç¬¦é¢œè‰²: onSurface.copy(alpha = 0.4f)
  - ä¾èµ–: T006

- [x] T009 åˆ›å»ºCharacterCounterå­—ç¬¦è®¡æ•°å™¨ç»„ä»¶ âœ…
  - æ–‡ä»¶: `presentation/ui/screen/prompt/component/CharacterCounter.kt`
  - åŠŸèƒ½:
    - æ˜¾ç¤ºå½“å‰å­—æ•°/æœ€å¤§å­—æ•°
    - æ ¹æ®çŠ¶æ€å˜è‰²ï¼ˆæ­£å¸¸/è­¦å‘Š/è¶…é™ï¼‰
  - è§„æ ¼:
    - æ ·å¼: bodySmall
    - æ­£å¸¸: onSurface.copy(alpha = 0.5f)
    - è­¦å‘Š(>800): BrandWarmOrange
    - è¶…é™(>1000): Color.Red
  - ä¾èµ–: T006

### 2.4 é”™è¯¯æç¤º

- [x] T010 åˆ›å»ºInlineErrorBanneré”™è¯¯æç¤ºæ¡ç»„ä»¶ âœ…
  - æ–‡ä»¶: `presentation/ui/screen/prompt/component/InlineErrorBanner.kt`
  - åŠŸèƒ½:
    - TopBarä¸‹æ–¹æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
    - AnimatedVisibilityå¹³æ»‘æ˜¾ç¤º/éšè—
    - 3ç§’åè‡ªåŠ¨æ¶ˆå¤±
    - æ‰‹åŠ¨å…³é—­æŒ‰é’®
  - è§„æ ¼:
    - èƒŒæ™¯: errorContainer
    - å›¾æ ‡: Warning, 20.dp
    - åœ†è§’: 8.dp

### 2.5 å¯¹è¯æ¡†

- [x] T011 åˆ›å»ºDiscardConfirmDialogæ”¾å¼ƒç¡®è®¤å¯¹è¯æ¡† âœ…
  - æ–‡ä»¶: `presentation/ui/screen/prompt/component/DiscardConfirmDialog.kt`
  - åŠŸèƒ½:
    - æç¤ºç”¨æˆ·æœ‰æœªä¿å­˜çš„ä¿®æ”¹
    - ç¡®è®¤æ”¾å¼ƒ / ç»§ç»­ç¼–è¾‘
  - æ–‡æ¡ˆ:
    - æ ‡é¢˜: "æ”¾å¼ƒä¿®æ”¹ï¼Ÿ"
    - å†…å®¹: "ä½ æœ‰æœªä¿å­˜çš„ä¿®æ”¹ï¼Œç¡®å®šè¦æ”¾å¼ƒå—ï¼Ÿ"
    - ç¡®è®¤: "æ”¾å¼ƒ"
    - å–æ¶ˆ: "ç»§ç»­ç¼–è¾‘"

### 2.6 ä¸»ç•Œé¢

- [x] T012 åˆ›å»ºPromptEditorScreenä¸»ç•Œé¢ âœ…
  - æ–‡ä»¶: `presentation/ui/screen/prompt/PromptEditorScreen.kt`
  - åŠŸèƒ½:
    - ç»„åˆæ‰€æœ‰å­ç»„ä»¶
    - é”®ç›˜é¿è®©ï¼ˆimePadding + navigationBarsPaddingï¼‰
    - ç›‘å¬ç¼–è¾‘ç»“æœå¹¶å¯¼èˆªè¿”å›
  - ç»“æ„:
    ```
    Box (imePadding)
    â””â”€â”€ EmotionalBackground
        â””â”€â”€ GlassmorphicCard
            â””â”€â”€ Column
                â”œâ”€â”€ PromptEditorTopBar
                â”œâ”€â”€ InlineErrorBanner
                â”œâ”€â”€ PromptInputField (weight 1f)
                â””â”€â”€ CharacterCounter
    â””â”€â”€ DiscardConfirmDialog (æ¡ä»¶æ˜¾ç¤º)
    ```
  - **Previewä»£ç **ï¼ˆå­ä»»åŠ¡ï¼‰:
    - PromptEditorScreenPreviewï¼šé»˜è®¤çŠ¶æ€é¢„è§ˆ
    - PromptEditorScreenLoadingPreviewï¼šåŠ è½½çŠ¶æ€é¢„è§ˆ
    - PromptEditorScreenSavingPreviewï¼šä¿å­˜çŠ¶æ€é¢„è§ˆ
    - PromptEditorScreenErrorPreviewï¼šé”™è¯¯çŠ¶æ€é¢„è§ˆ
    - PromptEditorScreenNearLimitPreviewï¼šæ¥è¿‘å­—æ•°é™åˆ¶é¢„è§ˆ
    - PromptEditorScreenOverLimitPreviewï¼šè¶…å‡ºå­—æ•°é™åˆ¶é¢„è§ˆ
    - PromptEditorScreenContactModePreviewï¼šè”ç³»äººæ¨¡å¼é¢„è§ˆ
  - ä¾èµ–: T005, T007-T011

### 2.7 å­—ç¬¦ä¸²èµ„æº

- [x] T013 [P] æ·»åŠ ä¸­æ–‡å­—ç¬¦ä¸²èµ„æº âœ…
  - æ–‡ä»¶: `res/values/strings.xml`
  - æ·»åŠ :
    - prompt_editor_title_global: "ç¼–è¾‘æŒ‡ä»¤"
    - prompt_editor_title_contact: "ç¼–è¾‘ %s çš„ä¸“å±æŒ‡ä»¤"ï¼ˆå‚æ•°åŒ–ï¼Œæ˜¾ç¤ºè”ç³»äººåå­—ï¼‰
    - prompt_editor_cancel: "å–æ¶ˆ"
    - prompt_editor_save: "å®Œæˆ"
    - prompt_editor_placeholder_analyze: "ä¾‹å¦‚ï¼šè¯·å¸®æˆ‘åˆ†æå¥¹è¿™å¥è¯çš„æ½œå°è¯..."
    - prompt_editor_placeholder_check: "ä¾‹å¦‚ï¼šæ£€æŸ¥æ—¶è¦ç‰¹åˆ«æ³¨æ„å·¥ä½œç›¸å…³è¯é¢˜..."
    - prompt_editor_placeholder_extract: "ä¾‹å¦‚ï¼šé‡ç‚¹å…³æ³¨å¯¹æ–¹æåˆ°çš„å…´è¶£çˆ±å¥½..."
    - prompt_editor_placeholder_summary: "ä¾‹å¦‚ï¼šæ€»ç»“ä»Šå¤©çš„å¯¹è¯äº®ç‚¹å’Œéœ€è¦æ³¨æ„çš„åœ°æ–¹..."
    - prompt_editor_placeholder_contact: "ä¾‹å¦‚ï¼šå’Œå¥¹èŠå¤©æ—¶è¦æ³¨æ„é¿å¼€å‰ä»»è¯é¢˜..."
    - prompt_editor_discard_title: "æ”¾å¼ƒä¿®æ”¹ï¼Ÿ"
    - prompt_editor_discard_message: "ä½ æœ‰æœªä¿å­˜çš„ä¿®æ”¹ï¼Œç¡®å®šè¦æ”¾å¼ƒå—ï¼Ÿ"
    - prompt_editor_discard_confirm: "æ”¾å¼ƒ"
    - prompt_editor_discard_cancel: "ç»§ç»­ç¼–è¾‘"
    - prompt_editor_error_load: "åŠ è½½å¤±è´¥"
    - prompt_editor_error_save: "ä¿å­˜å¤±è´¥"
  - ä½¿ç”¨ç¤ºä¾‹: `stringResource(R.string.prompt_editor_title_contact, contactName)`

- [x] T014 [P] æ·»åŠ è‹±æ–‡å­—ç¬¦ä¸²èµ„æº âœ…
  - æ–‡ä»¶: `res/values-en/strings.xml`
  - æ·»åŠ å¯¹åº”çš„è‹±æ–‡ç¿»è¯‘
  - æ³¨æ„: prompt_editor_title_contact ç¿»è¯‘ä¸º "Edit %s's Custom Prompt"

**éªŒæ”¶æ ‡å‡†**:
- [x] ç•Œé¢ç¬¦åˆPRDè®¾è®¡ç¨¿ âœ…
- [x] å“ç‰Œè‰²æ­£ç¡®åº”ç”¨ âœ…
- [x] é”®ç›˜å¼¹èµ·æ—¶åº•éƒ¨å†…å®¹ä¸è¢«é®æŒ¡ âœ…
- [x] å…‰æ ‡å§‹ç»ˆå¯è§ âœ…
- [x] é”™è¯¯æç¤ºåœ¨TopBarä¸‹æ–¹æ˜¾ç¤º âœ…
- [x] å­—ç¬¦è®¡æ•°é¢œè‰²æ­£ç¡®å˜åŒ– âœ…
- [x] è”ç³»äººæ¨¡å¼æ ‡é¢˜æ˜¾ç¤ºè”ç³»äººåå­—ï¼ˆå¦‚"ç¼–è¾‘æ—å©‰å„¿çš„ä¸“å±æŒ‡ä»¤"ï¼‰âœ…
- [x] æ‰€æœ‰UIç»„ä»¶åŒ…å«@Previewä»£ç ï¼Œå¯åœ¨Android Studioä¸­é¢„è§ˆ âœ…

---

## é˜¶æ®µ3: å¯¼èˆªé›†æˆï¼ˆ0.5å¤©ï¼‰

**ç›®æ ‡**: é›†æˆåˆ°åº”ç”¨å¯¼èˆªç³»ç»Ÿ

**é‡Œç¨‹ç¢‘**: M3 - å¯¼èˆªå®Œæˆ

### 3.1 è·¯ç”±å®šä¹‰

- [x] T015 åˆ›å»ºPromptEditorNavigationå¯¼èˆªé…ç½® âœ…
  - æ–‡ä»¶: `presentation/navigation/PromptEditorNavigation.kt`
  - å†…å®¹:
    - PromptEditorRouteså¯¹è±¡ï¼ˆè·¯ç”±å¸¸é‡ï¼‰
    - globalScene(scene)è·¯ç”±æ„å»ºå‡½æ•°
    - contactCustom(contactId, contactName)è·¯ç”±æ„å»ºå‡½æ•°
    - NavGraphBuilder.promptEditorNavigation()æ‰©å±•å‡½æ•°
  - å‚æ•°:
    - mode: Stringï¼ˆglobal/contactï¼‰
    - scene: String?ï¼ˆåœºæ™¯åç§°ï¼‰
    - contactId: String?ï¼ˆè”ç³»äººIDï¼‰
    - contactName: String?ï¼ˆè”ç³»äººåç§°ï¼ŒURLç¼–ç ï¼‰

### 3.2 å¯¼èˆªå›¾é›†æˆ

- [x] T016 ä¿®æ”¹NavGraphæ·»åŠ ç¼–è¾‘å™¨è·¯ç”± âœ…
  - æ–‡ä»¶: `presentation/navigation/NavGraph.kt`
  - ä¿®æ”¹:
    - å¯¼å…¥PromptEditorNavigation
    - è°ƒç”¨promptEditorNavigation(navController)

### 3.3 å…¥å£é›†æˆ

- [x] T017 åœ¨è®¾ç½®é¡µé¢æ·»åŠ ç¼–è¾‘å…¥å£ï¼ˆå…¨å±€æç¤ºè¯ï¼‰âœ…
  - æ–‡ä»¶: `presentation/ui/screen/settings/SettingsScreen.kt`
  - ä¿®æ”¹:
    - æ·»åŠ "æç¤ºè¯è®¾ç½®"åˆ†ç»„
    - æ·»åŠ å››ä¸ªåœºæ™¯çš„ç¼–è¾‘å…¥å£ï¼ˆåˆ†æ/æ£€æŸ¥/æå–/æ€»ç»“ï¼‰
    - ç‚¹å‡»è·³è½¬åˆ°PromptEditorScreen

- [x] T018 åœ¨è”ç³»äººè¯¦æƒ…é¡µæ·»åŠ ç¼–è¾‘å…¥å£ï¼ˆè”ç³»äººä¸“å±ï¼‰âœ…
  - æ–‡ä»¶: `presentation/ui/screen/contact/ContactDetailTabScreen.kt` (æ³¨ï¼šå®é™…ä¿®æ”¹çš„æ˜¯TabScreen)
  - ä¿®æ”¹:
    - åœ¨æ¦‚è§ˆæ ‡ç­¾é¡µæ·»åŠ "ä¸“å±æŒ‡ä»¤"ç¼–è¾‘å¡ç‰‡
    - ç‚¹å‡»è·³è½¬åˆ°PromptEditorScreenï¼ˆä¼ é€’contactIdå’ŒcontactNameï¼‰

**éªŒæ”¶æ ‡å‡†**:
- [x] ä»è®¾ç½®é¡µé¢å¯è¿›å…¥å…¨å±€æç¤ºè¯ç¼–è¾‘ âœ…
- [x] ä»è”ç³»äººè¯¦æƒ…å¯è¿›å…¥ä¸“å±æç¤ºè¯ç¼–è¾‘ âœ…
- [x] ç¼–è¾‘å®Œæˆåæ­£ç¡®è¿”å› âœ…
- [x] å‚æ•°ä¼ é€’æ­£ç¡®ï¼ˆåœºæ™¯/è”ç³»äººä¿¡æ¯ï¼‰âœ…

---

## é˜¶æ®µ4: æµ‹è¯•å’Œä¼˜åŒ–ï¼ˆ0.5-1å¤©ï¼‰

**ç›®æ ‡**: ç¡®ä¿è´¨é‡å’Œæ€§èƒ½

**é‡Œç¨‹ç¢‘**: M4 - æµ‹è¯•å®Œæˆ

### 4.1 å•å…ƒæµ‹è¯•

- [x] T019 åˆ›å»ºPromptEditorUiStateTest âœ…
  - æ–‡ä»¶: `test/presentation/ui/screen/prompt/PromptEditorUiStateTest.kt`
  - æµ‹è¯•:
    - charCountè®¡ç®—æ­£ç¡®
    - isOverLimitåˆ¤æ–­æ­£ç¡®ï¼ˆ>1000ï¼‰
    - isNearLimitåˆ¤æ–­æ­£ç¡®ï¼ˆ>800ï¼‰
    - hasUnsavedChangesåˆ¤æ–­æ­£ç¡®
    - canSaveåˆ¤æ–­æ­£ç¡®
    - titleTextæ ¹æ®editModeæ­£ç¡®è¿”å›

- [x] T020 åˆ›å»ºPromptEditorViewModelTest âœ…
  - æ–‡ä»¶: `test/presentation/viewmodel/PromptEditorViewModelTest.kt`
  - æµ‹è¯•:
    - åˆå§‹åŒ–åŠ è½½æç¤ºè¯æˆåŠŸ
    - åˆå§‹åŒ–åŠ è½½æç¤ºè¯å¤±è´¥
    - è¾“å…¥æ›´æ–°çŠ¶æ€æ­£ç¡®
    - å¤§æ–‡æœ¬è¾“å…¥è¢«æˆªæ–­åˆ°1000å­—
    - ä¿å­˜æˆåŠŸå‘é€Savedç»“æœ
    - ä¿å­˜å¤±è´¥æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
    - æœ‰ä¿®æ”¹æ—¶å–æ¶ˆæ˜¾ç¤ºå¯¹è¯æ¡†
    - æ— ä¿®æ”¹æ—¶å–æ¶ˆç›´æ¥è¿”å›
    - ç¡®è®¤æ”¾å¼ƒå‘é€Cancelledç»“æœ
    - é˜²æŠ–é€»è¾‘æ­£ç¡®ï¼ˆ100msï¼‰
  - ä¾èµ–: MockK, Turbine

### 4.2 UIæµ‹è¯•

- [ ] T021 åˆ›å»ºPromptEditorScreenTest
  - æ–‡ä»¶: `androidTest/presentation/ui/screen/prompt/PromptEditorScreenTest.kt`
  - æµ‹è¯•:
    - ç•Œé¢æ­£ç¡®æ¸²æŸ“
    - è¾“å…¥æ–‡å­—æ›´æ–°æ˜¾ç¤º
    - å­—ç¬¦è®¡æ•°æ­£ç¡®æ˜¾ç¤º
    - è¶…é™æ—¶è®¡æ•°å˜çº¢
    - ç‚¹å‡»å–æ¶ˆè§¦å‘äº‹ä»¶
    - ç‚¹å‡»å®Œæˆè§¦å‘äº‹ä»¶
    - ä¿å­˜ä¸­æ˜¾ç¤ºåŠ è½½åœˆ
    - é”™è¯¯ä¿¡æ¯æ­£ç¡®æ˜¾ç¤º

- [ ] T022 åˆ›å»ºInlineErrorBannerTest
  - æ–‡ä»¶: `androidTest/presentation/ui/component/InlineErrorBannerTest.kt`
  - æµ‹è¯•:
    - æœ‰é”™è¯¯æ—¶æ˜¾ç¤º
    - æ— é”™è¯¯æ—¶éšè—
    - ç‚¹å‡»å…³é—­æŒ‰é’®è§¦å‘å›è°ƒ
    - 3ç§’åè‡ªåŠ¨æ¶ˆå¤±

### 4.3 é›†æˆæµ‹è¯•

- [ ] T023 åˆ›å»ºPromptEditorIntegrationTest
  - æ–‡ä»¶: `androidTest/presentation/integration/PromptEditorIntegrationTest.kt`
  - æµ‹è¯•:
    - å®Œæ•´ç¼–è¾‘æµç¨‹ï¼ˆåŠ è½½â†’ç¼–è¾‘â†’ä¿å­˜â†’è¿”å›ï¼‰
    - æ”¾å¼ƒä¿®æ”¹æµç¨‹
    - å¯¼èˆªå‚æ•°ä¼ é€’æ­£ç¡®
    - å…¨å±€æç¤ºè¯ç¼–è¾‘
    - è”ç³»äººä¸“å±æç¤ºè¯ç¼–è¾‘

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] æ‰€æœ‰UIæµ‹è¯•é€šè¿‡
- [ ] é›†æˆæµ‹è¯•é€šè¿‡
- [ ] æµ‹è¯•è¦†ç›–ç‡:
  - PromptEditorViewModel: â‰¥90%
  - PromptEditorUiState: â‰¥95%
  - UIç»„ä»¶: â‰¥80%

---

## ä»»åŠ¡æ€»è§ˆ

### ä»»åŠ¡ç»Ÿè®¡

| é˜¶æ®µ | ä»»åŠ¡æ•° | é¢„è®¡å·¥æ—¶ | çŠ¶æ€ |
|------|--------|----------|------|
| é˜¶æ®µ1: æ•°æ®æ¨¡å‹å’ŒViewModel | 5 | 0.5å¤© | ğŸ“ å¾…å¼€å‘ |
| é˜¶æ®µ2: UIç»„ä»¶å®ç° | 9 | 1å¤© | ğŸ“ å¾…å¼€å‘ |
| é˜¶æ®µ3: å¯¼èˆªé›†æˆ | 4 | 0.5å¤© | ğŸ“ å¾…å¼€å‘ |
| é˜¶æ®µ4: æµ‹è¯•å’Œä¼˜åŒ– | 5 | 0.5-1å¤© | ğŸ“ å¾…å¼€å‘ |
| **æ€»è®¡** | **23** | **2-3å¤©** | ğŸ“ å¾…å¼€å‘ |

### ä»»åŠ¡ä¾èµ–å›¾

```
é˜¶æ®µ1 (æ•°æ®æ¨¡å‹å’ŒViewModel)
â”œâ”€â”€ T001-T004 [P] æ•°æ®æ¨¡å‹ï¼ˆå¯å¹¶è¡Œï¼‰
â””â”€â”€ T005 PromptEditorViewModel â† T001-T004

é˜¶æ®µ2 (UIç»„ä»¶å®ç°)
â”œâ”€â”€ T006 å“ç‰Œè‰²æ‰©å±•
â”œâ”€â”€ T007 PromptEditorTopBar â† T006
â”œâ”€â”€ T008 PromptInputField â† T006
â”œâ”€â”€ T009 CharacterCounter â† T006
â”œâ”€â”€ T010 InlineErrorBanner
â”œâ”€â”€ T011 DiscardConfirmDialog
â”œâ”€â”€ T012 PromptEditorScreen â† T005, T007-T011
â””â”€â”€ T013-T014 [P] å­—ç¬¦ä¸²èµ„æºï¼ˆå¯å¹¶è¡Œï¼‰

é˜¶æ®µ3 (å¯¼èˆªé›†æˆ)
â”œâ”€â”€ T015 PromptEditorNavigation
â”œâ”€â”€ T016 NavGraphä¿®æ”¹ â† T015
â”œâ”€â”€ T017 è®¾ç½®é¡µé¢å…¥å£ â† T012, T016
â””â”€â”€ T018 è”ç³»äººè¯¦æƒ…å…¥å£ â† T012, T016

é˜¶æ®µ4 (æµ‹è¯•å’Œä¼˜åŒ–)
â”œâ”€â”€ T019 PromptEditorUiStateTest â† T001
â”œâ”€â”€ T020 PromptEditorViewModelTest â† T005
â”œâ”€â”€ T021 PromptEditorScreenTest â† T012
â”œâ”€â”€ T022 InlineErrorBannerTest â† T010
â””â”€â”€ T023 PromptEditorIntegrationTest â† T017, T018
```

---

## æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶ï¼ˆ14ä¸ªï¼‰

| æ–‡ä»¶è·¯å¾„ | ä»»åŠ¡ç¼–å· | è¯´æ˜ |
|---------|---------|------|
| `presentation/ui/screen/prompt/PromptEditorUiState.kt` | T001 | UIçŠ¶æ€ç±» |
| `presentation/ui/screen/prompt/PromptEditMode.kt` | T002 | ç¼–è¾‘æ¨¡å¼ |
| `presentation/ui/screen/prompt/PromptEditorUiEvent.kt` | T003 | UIäº‹ä»¶ |
| `presentation/ui/screen/prompt/PromptEditorResult.kt` | T004 | ç¼–è¾‘ç»“æœ |
| `presentation/viewmodel/PromptEditorViewModel.kt` | T005 | ViewModel |
| `presentation/ui/screen/prompt/component/PromptEditorTopBar.kt` | T007 | é¡¶éƒ¨å¯¼èˆªæ  |
| `presentation/ui/screen/prompt/component/PromptInputField.kt` | T008 | è¾“å…¥æ¡† |
| `presentation/ui/screen/prompt/component/CharacterCounter.kt` | T009 | å­—ç¬¦è®¡æ•°å™¨ |
| `presentation/ui/screen/prompt/component/InlineErrorBanner.kt` | T010 | é”™è¯¯æç¤ºæ¡ |
| `presentation/ui/screen/prompt/component/DiscardConfirmDialog.kt` | T011 | ç¡®è®¤å¯¹è¯æ¡† |
| `presentation/ui/screen/prompt/PromptEditorScreen.kt` | T012 | ä¸»ç•Œé¢ |
| `presentation/navigation/PromptEditorNavigation.kt` | T015 | å¯¼èˆªé…ç½® |

### ä¿®æ”¹æ–‡ä»¶ï¼ˆ4ä¸ªï¼‰

| æ–‡ä»¶è·¯å¾„ | ä»»åŠ¡ç¼–å· | ä¿®æ”¹å†…å®¹ |
|---------|---------|---------|
| `presentation/theme/Color.kt` | T006 | æ·»åŠ å“ç‰Œè‰²å®šä¹‰ |
| `presentation/navigation/NavGraph.kt` | T016 | æ·»åŠ ç¼–è¾‘å™¨è·¯ç”± |
| `presentation/ui/screen/settings/SettingsScreen.kt` | T017 | æ·»åŠ æç¤ºè¯è®¾ç½®å…¥å£ |
| `presentation/ui/screen/contact/ContactDetailScreen.kt` | T018 | æ·»åŠ ä¸“å±æŒ‡ä»¤å…¥å£ |

### èµ„æºæ–‡ä»¶ï¼ˆ2ä¸ªï¼‰

| æ–‡ä»¶è·¯å¾„ | ä»»åŠ¡ç¼–å· | è¯´æ˜ |
|---------|---------|------|
| `res/values/strings.xml` | T013 | ä¸­æ–‡å­—ç¬¦ä¸² |
| `res/values-en/strings.xml` | T014 | è‹±æ–‡å­—ç¬¦ä¸² |

### æµ‹è¯•æ–‡ä»¶ï¼ˆ5ä¸ªï¼‰

| æ–‡ä»¶è·¯å¾„ | ä»»åŠ¡ç¼–å· | è¯´æ˜ |
|---------|---------|------|
| `test/presentation/ui/screen/prompt/PromptEditorUiStateTest.kt` | T019 | çŠ¶æ€ç±»æµ‹è¯• |
| `test/presentation/viewmodel/PromptEditorViewModelTest.kt` | T020 | ViewModelæµ‹è¯• |
| `androidTest/presentation/ui/screen/prompt/PromptEditorScreenTest.kt` | T021 | ç•Œé¢æµ‹è¯• |
| `androidTest/presentation/ui/component/InlineErrorBannerTest.kt` | T022 | é”™è¯¯æç¤ºæµ‹è¯• |
| `androidTest/presentation/integration/PromptEditorIntegrationTest.kt` | T023 | é›†æˆæµ‹è¯• |

---

## æµ‹è¯•è¦†ç›–ç‡æ ‡å‡†

| æ¨¡å— | è¦†ç›–ç‡è¦æ±‚ | è¯´æ˜ |
|------|-----------|------|
| PromptEditorViewModel | â‰¥90% | æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ |
| PromptEditorUiState | â‰¥95% | è®¡ç®—å±æ€§éªŒè¯ |
| UIç»„ä»¶ | â‰¥80% | äº¤äº’é€»è¾‘ |
| å¯¼èˆª | â‰¥85% | å‚æ•°ä¼ é€’ |

---

## é£é™©è¯„ä¼°

| é£é™© | ä¸¥é‡ç¨‹åº¦ | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|------|---------|------|------|---------|
| é”®ç›˜é¿è®©ä¸å®Œå–„ | ğŸŸ¡ ä¸­ | 30% | ç”¨æˆ·ä½“éªŒå·® | å¤šè®¾å¤‡æµ‹è¯•ï¼Œä½¿ç”¨imePadding |
| å¤§æ–‡æœ¬æ€§èƒ½é—®é¢˜ | ğŸŸ¡ ä¸­ | 20% | ç•Œé¢å¡é¡¿ | è¾“å…¥æˆªæ–­ä¿æŠ¤ï¼Œé˜²æŠ–å¤„ç† |
| å…‰æ ‡è·Ÿéšå¤±æ•ˆ | ğŸŸ¢ ä½ | 15% | è¾“å…¥ä¸ä¾¿ | BringIntoViewRequester + å¤‡é€‰æ–¹æ¡ˆ |
| å¯¼èˆªå‚æ•°ä¸¢å¤± | ğŸŸ¢ ä½ | 10% | åŠŸèƒ½å¼‚å¸¸ | URLç¼–ç ï¼ŒSavedStateHandle |

---

## ç›¸å…³æ–‡æ¡£

- [PRD-00006-æç¤ºè¯ç¼–è¾‘ç•Œé¢éœ€æ±‚](../PRD/PRD-00006-æç¤ºè¯ç¼–è¾‘ç•Œé¢éœ€æ±‚.md)
- [FD-00006-æç¤ºè¯ç¼–è¾‘ç•Œé¢åŠŸèƒ½è®¾è®¡](../FD/FD-00006-æç¤ºè¯ç¼–è¾‘ç•Œé¢åŠŸèƒ½è®¾è®¡.md)
- [TDD-00006-æç¤ºè¯ç¼–è¾‘ç•Œé¢æŠ€æœ¯è®¾è®¡](../TDD/TDD-00006-æç¤ºè¯ç¼–è¾‘ç•Œé¢æŠ€æœ¯è®¾è®¡.md)
- [TD-00005-æç¤ºè¯ç®¡ç†ç³»ç»Ÿä»»åŠ¡æ¸…å•](TD-00005-æç¤ºè¯ç®¡ç†ç³»ç»Ÿä»»åŠ¡æ¸…å•.md)
