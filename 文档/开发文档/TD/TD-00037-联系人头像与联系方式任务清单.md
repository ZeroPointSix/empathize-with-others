# TD-00037: è”ç³»äººå¤´åƒä¸è”ç³»æ–¹å¼ä»»åŠ¡æ¸…å•

## 1. æ–‡æ¡£ä¿¡æ¯

| é¡¹ç›® | å†…å®¹ |
|------|------|
| æ–‡æ¡£ç±»å‹ | TD (Task Document) |
| æ–‡æ¡£ç¼–å· | TD-00037 |
| åŠŸèƒ½åç§° | è”ç³»äººå¤´åƒä¸è”ç³»æ–¹å¼ |
| ç‰ˆæœ¬ | 1.0 |
| åˆ›å»ºæ—¥æœŸ | 2026-01-20 |
| ä½œè€… | Codex |
| å…³è”æ–‡æ¡£ | PRD-00037, FD-00037, TDD-00037 |

---

## 2. ä»»åŠ¡æ¦‚è§ˆ

| é˜¶æ®µ | ä»»åŠ¡æ•° | é¢„è®¡å·¥æ—¶ | çŠ¶æ€ |
|------|--------|----------|------|
| é˜¶æ®µä¸€ï¼šæ•°æ®æ¨¡å‹ä¸è¿ç§» | 6 | 0.5å¤© | âœ… å·²å®Œæˆ |
| é˜¶æ®µäºŒï¼šä»“åº“ä¸ç”¨ä¾‹ | 5 | 0.5å¤© | âœ… å·²å®Œæˆ |
| é˜¶æ®µä¸‰ï¼šUIä¸äº¤äº’ | 8 | 1å¤© | âœ… å·²å®Œæˆ |
| é˜¶æ®µå››ï¼šæµ‹è¯•ä¸éªŒæ”¶ | 4 | 0.5å¤© | ğŸŸ¡ è¿›è¡Œä¸­ |
| **æ€»è®¡** | **23** | **2.5å¤©** | **21/23 å®Œæˆ** |

---

## 3. é˜¶æ®µä¸€ï¼šæ•°æ®æ¨¡å‹ä¸è¿ç§»ï¼ˆ0.5å¤©ï¼‰

### ä»»åŠ¡ 1.1ï¼šæ‰©å±•è”ç³»äººé¢†åŸŸæ¨¡å‹
- **æ–‡ä»¶**ï¼š`domain/src/main/kotlin/com/empathy/ai/domain/model/ContactProfile.kt`
- **å†…å®¹**ï¼šæ–°å¢ `contactInfo`ã€`avatarColorSeed`
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] å­—æ®µå®šä¹‰å®Œæˆä¸”é»˜è®¤å€¼åˆç†
  - [ ] ç°æœ‰è°ƒç”¨ç¼–è¯‘é€šè¿‡
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 1.2ï¼šæ‰©å±•è”ç³»äººæ•°æ®åº“å®ä½“
- **æ–‡ä»¶**ï¼š`data/src/main/kotlin/com/empathy/ai/data/local/entity/ContactProfileEntity.kt`
- **å†…å®¹**ï¼šæ–°å¢ `contact_info`ã€`avatar_color_seed`
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] å­—æ®µå‘½åç¬¦åˆè§„èŒƒ
  - [ ] é»˜è®¤å€¼è®¾ç½®æ­£ç¡®
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 1.3ï¼šå‡çº§æ•°æ®åº“ç‰ˆæœ¬
- **æ–‡ä»¶**ï¼š`data/src/main/kotlin/com/empathy/ai/data/local/AppDatabase.kt`
- **å†…å®¹**ï¼šç‰ˆæœ¬å·å‡çº§ v16 â†’ v17
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] ç‰ˆæœ¬å·æ›´æ–°
  - [ ] è¿ç§»é“¾æ›´æ–°è¯´æ˜
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 1.4ï¼šæ·»åŠ æ•°æ®åº“è¿ç§»è„šæœ¬
- **æ–‡ä»¶**ï¼š`data/src/main/kotlin/com/empathy/ai/data/di/DatabaseModule.kt`
- **å†…å®¹**ï¼šæ–°å¢ `MIGRATION_16_17`
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] SQL æ‰§è¡ŒæˆåŠŸ
  - [ ] è¿ç§»é“¾åŠ å…¥ 16â†’17
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 1.5ï¼šæ‰©å±• DAO æ›´æ–°æ–¹æ³•
- **æ–‡ä»¶**ï¼š`data/src/main/kotlin/com/empathy/ai/data/local/dao/ContactDao.kt`
- **å†…å®¹**ï¼šæ–°å¢ `updateContactInfo` / `updateAvatar`
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] SQL æ­£ç¡®ã€å­—æ®µæ›´æ–°æ— è¯¯
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 1.6ï¼šæ›´æ–°å®ä½“/é¢†åŸŸæ˜ å°„
- **æ–‡ä»¶**ï¼š`data/src/main/kotlin/com/empathy/ai/data/repository/ContactRepositoryImpl.kt`
- **å†…å®¹**ï¼šæ–°å¢å­—æ®µæ˜ å°„
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] entityToDomain / domainToEntity å®Œæ•´åŒæ­¥
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

---

## 4. é˜¶æ®µäºŒï¼šä»“åº“ä¸ç”¨ä¾‹ï¼ˆ0.5å¤©ï¼‰

### ä»»åŠ¡ 2.1ï¼šæ‰©å±•ä»“åº“æ¥å£
- **æ–‡ä»¶**ï¼š`domain/src/main/kotlin/com/empathy/ai/domain/repository/ContactRepository.kt`
- **å†…å®¹**ï¼šæ–°å¢è”ç³»æ–¹å¼/å¤´åƒæ›´æ–°æ¥å£
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] æ¥å£å‘½åæ¸…æ™°
  - [ ] ä½¿ç”¨åœºæ™¯è¦†ç›–å®Œæ•´
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 2.2ï¼šå®ç°ä»“åº“æ›´æ–°é€»è¾‘
- **æ–‡ä»¶**ï¼š`data/src/main/kotlin/com/empathy/ai/data/repository/ContactRepositoryImpl.kt`
- **å†…å®¹**ï¼šå®ç° `updateContactInfo` / `updateAvatar`
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] æ•°æ®æ›´æ–°æˆåŠŸ
  - [ ] é”™è¯¯å¤„ç†ç¬¦åˆç°æœ‰é£æ ¼
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 2.3ï¼šæ‰©å±•ç¼–è¾‘ç”¨ä¾‹
- **æ–‡ä»¶**ï¼š`domain/src/main/kotlin/com/empathy/ai/domain/usecase/EditContactInfoUseCase.kt`
- **å†…å®¹**ï¼šæ–°å¢è”ç³»æ–¹å¼æ›´æ–°é€»è¾‘ï¼ˆå¤´åƒæ›´æ–°å¯ç›´æ¥èµ°ä»“åº“ï¼‰
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] è¾“å…¥æ ¡éªŒç¬¦åˆè§„åˆ™
  - [ ] ç»“æœè¿”å›ä¸€è‡´
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 2.4ï¼šæ›´æ–°è”ç³»äººè¯¦æƒ…çŠ¶æ€æ¨¡å‹
- **æ–‡ä»¶**ï¼š`presentation/src/main/kotlin/com/empathy/ai/presentation/ui/screen/contact/ContactDetailUiState.kt`
- **å†…å®¹**ï¼šæ–°å¢ contactInfo/avatarColorSeed ç­‰å­—æ®µ
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] çŠ¶æ€å­—æ®µé½å…¨
  - [ ] é»˜è®¤å€¼å®‰å…¨
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 2.5ï¼šæ›´æ–°è”ç³»äººè¯¦æƒ…äº‹ä»¶æ¨¡å‹
- **æ–‡ä»¶**ï¼š`presentation/src/main/kotlin/com/empathy/ai/presentation/ui/screen/contact/ContactDetailUiEvent.kt`
- **å†…å®¹**ï¼šæ–°å¢ UpdateContactInfo / UpdateAvatar ç­‰äº‹ä»¶
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] äº‹ä»¶è¦†ç›–æ‰€æœ‰äº¤äº’
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

---

## 5. é˜¶æ®µä¸‰ï¼šUI ä¸äº¤äº’ï¼ˆ1å¤©ï¼‰

### ä»»åŠ¡ 3.1ï¼šæ–°å»ºè”ç³»äººé¡µå†™å…¥è”ç³»æ–¹å¼
- **æ–‡ä»¶**ï¼š`presentation/src/main/kotlin/com/empathy/ai/presentation/ui/screen/contact/CreateContactScreen.kt`
- **å†…å®¹**ï¼šä¿å­˜æ—¶å¸¦ä¸Š contactInfo/avatarColorSeed
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] ä¿å­˜åè¯¦æƒ…é¡µå¯è§è”ç³»æ–¹å¼
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 3.2ï¼šè”ç³»æ–¹å¼å ä½æ–‡æ¡ˆè°ƒæ•´
- **æ–‡ä»¶**ï¼š`presentation/src/main/kotlin/com/empathy/ai/presentation/ui/component/contact/ContactFormCard.kt`
- **å†…å®¹**ï¼šè°ƒæ•´è”ç³»æ–¹å¼ placeholderï¼ˆæœ€ç»ˆæ–‡æ¡ˆå¾…å®šï¼‰
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] å ä½æ–‡æ¡ˆä¸€è‡´
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 3.3ï¼šè¯¦æƒ…é¡µåŸºç¡€ä¿¡æ¯åŒºå±•ç¤ºè”ç³»æ–¹å¼
- **æ–‡ä»¶**ï¼š`presentation/src/main/kotlin/com/empathy/ai/presentation/ui/component/overview/IdentityCard.kt`
- **å†…å®¹**ï¼šæ–°å¢è”ç³»æ–¹å¼è¡Œï¼Œç©ºå€¼æ˜¾ç¤ºå ä½
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] ç©ºå€¼æ˜¾ç¤ºå ä½æ–‡æœ¬
  - [ ] éç©ºæ˜¾ç¤ºè”ç³»æ–¹å¼
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 3.4ï¼šç¼–è¾‘å¯¹è¯æ¡†æ‰©å±•è”ç³»æ–¹å¼
- **æ–‡ä»¶**ï¼š`presentation/src/main/kotlin/com/empathy/ai/presentation/ui/component/dialog/EditContactInfoDialog.kt`
- **å†…å®¹**ï¼šå¢åŠ è”ç³»æ–¹å¼è¾“å…¥æ¡†
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] è”ç³»æ–¹å¼å¯ä¿®æ”¹
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 3.5ï¼šå¤´åƒé€‰æ‹©ç»„ä»¶æ¥å…¥ç›¸å†Œ/æ‹ç…§
- **æ–‡ä»¶**ï¼š`presentation/src/main/kotlin/com/empathy/ai/presentation/ui/component/contact/AvatarPicker.kt`
- **å†…å®¹**ï¼šæ¥å…¥ ActivityResult é€‰æ‹©å™¨
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] ç›¸å†Œ/æ‹ç…§å…¥å£å¯ç”¨
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 3.6ï¼šè£å‰ªæµç¨‹ä¸å­˜å‚¨
- **æ–‡ä»¶**ï¼š`presentation/src/main/kotlin/com/empathy/ai/presentation/ui/screen/contact/CreateContactScreen.kt`
- **å†…å®¹**ï¼šè£å‰ªåç”Ÿæˆæœ¬åœ° Uri å¹¶ä¿å­˜
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] è£å‰ªåå¤´åƒæ›´æ–°
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 3.7ï¼šè¯¦æƒ…é¡µç¼–è¾‘é€»è¾‘æ¥å…¥å¤´åƒ/è”ç³»æ–¹å¼æ›´æ–°
- **æ–‡ä»¶**ï¼š`presentation/src/main/kotlin/com/empathy/ai/presentation/viewmodel/ContactDetailViewModel.kt`
- **å†…å®¹**ï¼šå¤„ç†æ–°äº‹ä»¶å¹¶è°ƒç”¨ä»“åº“æ›´æ–°
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] æ›´æ–°å UI å³æ—¶åˆ·æ–°
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 3.8ï¼šé»˜è®¤å¤´åƒé¢œè‰²æ˜ å°„
- **æ–‡ä»¶**ï¼š`presentation/src/main/kotlin/com/empathy/ai/presentation/ui/component/overview/IdentityCard.kt`
- **å†…å®¹**ï¼šæŒ‰ avatarColorSeed æ˜ å°„é¢œè‰²
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] é¢œè‰²ç¨³å®šã€ä¸ä¼šéšé‡å¯å˜åŒ–
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

---

## 6. é˜¶æ®µå››ï¼šæµ‹è¯•ä¸éªŒæ”¶ï¼ˆ0.5å¤©ï¼‰

### ä»»åŠ¡ 4.1ï¼šæ•°æ®åº“è¿ç§»æµ‹è¯•
- **æ–‡ä»¶**ï¼š`data/src/androidTest/.../DatabaseMigration16To17Test.kt`
- **å†…å®¹**ï¼šéªŒè¯æ–°å¢å­—æ®µè¿ç§»æˆåŠŸ
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] è¿ç§»æµ‹è¯•é€šè¿‡
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 4.2ï¼šä»“åº“æ›´æ–°å•å…ƒæµ‹è¯•
- **æ–‡ä»¶**ï¼š`data/src/test/.../ContactRepositoryImplTest.kt`
- **å†…å®¹**ï¼šè¦†ç›–è”ç³»æ–¹å¼/å¤´åƒæ›´æ–°
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] æ›´æ–°é€»è¾‘æ­£ç¡®
- **çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

### ä»»åŠ¡ 4.3ï¼šæ–°å»º/ç¼–è¾‘æµç¨‹æ‰‹æµ‹
- **å†…å®¹**ï¼š
  - æ–°å»ºè”ç³»äººä¿å­˜è”ç³»æ–¹å¼
  - ç¼–è¾‘è”ç³»äººä¿®æ”¹è”ç³»æ–¹å¼ä¸å¤´åƒ
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] è¯¦æƒ…é¡µå±•ç¤ºæ­£ç¡®
- **çŠ¶æ€**ï¼šâ¬œ å¾…å¼€å§‹

### ä»»åŠ¡ 4.4ï¼šå¼‚å¸¸åœºæ™¯æ‰‹æµ‹
- **å†…å®¹**ï¼šæƒé™æ‹’ç»ã€æ‹ç…§å¤±è´¥ã€è£å‰ªå¤±è´¥
- **éªŒæ”¶æ ‡å‡†**ï¼š
  - [ ] æç¤ºæ–‡æ¡ˆæ­£ç¡®ï¼Œæ•°æ®ä¸ä¸¢å¤±
- **çŠ¶æ€**ï¼šâ¬œ å¾…å¼€å§‹

---

## 7. å›å½’é—®é¢˜ä¿®å¤è®°å½•

| æ—¥æœŸ | é—®é¢˜ | ä¿®å¤å†…å®¹ | å…³è”æ–‡ä»¶ |
|------|------|----------|----------|
| 2026-01-21 | è¿ç§»åé»˜è®¤å¤´åƒé¢œè‰²ç»Ÿä¸€ | v16â†’v17 è¿ç§»æ—¶æŒ‰è”ç³»äººå§“å hash å›å¡« `avatar_color_seed` | `data/src/main/kotlin/com/empathy/ai/data/di/DatabaseModule.kt` |
| 2026-01-21 | æ¸…ç†ç¼“å­˜åå¤´åƒä¸¢å¤± | è£å‰ªå®Œæˆåå°†å¤´åƒå¤åˆ¶åˆ° `filesDir/avatars` å†æŒä¹…åŒ– Uri | `presentation/src/main/kotlin/com/empathy/ai/presentation/ui/component/contact/AvatarPicker.kt` |

---

## 8. ç›¸å…³æ–‡æ¡£

- [PRD-00037-è”ç³»äººå¤´åƒä¸è”ç³»æ–¹å¼éœ€æ±‚](../PRD/PRD-00037-è”ç³»äººå¤´åƒä¸è”ç³»æ–¹å¼éœ€æ±‚.md)
- [FD-00037-è”ç³»äººå¤´åƒä¸è”ç³»æ–¹å¼åŠŸèƒ½è®¾è®¡](../FD/FD-00037-è”ç³»äººå¤´åƒä¸è”ç³»æ–¹å¼åŠŸèƒ½è®¾è®¡.md)
- [TDD-00037-è”ç³»äººå¤´åƒä¸è”ç³»æ–¹å¼æŠ€æœ¯è®¾è®¡](../TDD/TDD-00037-è”ç³»äººå¤´åƒä¸è”ç³»æ–¹å¼æŠ€æœ¯è®¾è®¡.md)

---

**æ–‡æ¡£å®Œæˆæ—¥æœŸ**: 2026-01-20  
**æ–‡æ¡£çŠ¶æ€**: å·²å®Œæˆ  
**ä¸‹ä¸€æ­¥**: è¿›å…¥é˜¶æ®µä¸€ä»»åŠ¡æ‰§è¡Œ
