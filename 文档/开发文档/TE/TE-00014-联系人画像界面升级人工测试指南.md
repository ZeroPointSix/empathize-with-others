# TE-00014-联系人画像界面升级人工测试指南

---
**文档类型**: TE (Test Guide) - 开发过程文档  
**存放规范**: 符合项目宪法第IV条 - 文档规范  
**版本控制**: Git管理，见.commit钩子  
---

## 1. 文档信息

| 项目 | 内容 |
|------|------|
| 文档类型 | TE (Test Guide) |
| 文档编号 | TE-00014 |
| 功能名称 | 联系人画像界面升级人工测试指南 |
| 版本 | 1.0 |
| 创建日期 | 2025-12-22 |
| 作者 | Roo |
| 关联文档 | PRD-00014, FD-00014, TDD-00014, TD-00014 |

---

## 2. 测试概述

### 2.1 测试目标

本测试指南旨在全面验证联系人画像界面升级功能，确保以下目标达成：

1. **功能完整性**：验证动态标签分类、搜索功能、编辑模式和批量操作等核心功能正常工作
2. **用户体验**：确保界面交互流畅、视觉反馈明确、操作路径清晰
3. **性能稳定性**：验证在各种数据量和设备条件下的性能表现
4. **兼容性**：确保与现有系统兼容，不影响其他功能模块

### 2.2 测试范围

| 测试模块 | 测试内容 | 优先级 |
|---------|---------|--------|
| 动态标签分类展示 | 基于Fact Key的自动分组、颜色分配、折叠/展开 | P0 |
| 搜索功能 | 实时过滤、关键词高亮、空状态处理 | P0 |
| 编辑模式 | 长按进入、选择状态、批量操作 | P0 |
| 批量操作 | 批量删除、批量移动分类 | P0 |
| UI/UX | 界面元素、交互流程、响应式设计 | P1 |
| 兼容性 | 设备适配、Android版本、屏幕尺寸 | P1 |
| 性能 | 加载时间、内存使用、电池消耗 | P1 |
| 回归测试 | 与现有功能的兼容性 | P1 |

### 2.3 测试环境要求

| 环境项 | 要求 |
|--------|------|
| 设备类型 | 手机（至少2种不同屏幕尺寸） |
| Android版本 | Android 7.0 (API 24) 及以上 |
| 内存 | 最低4GB RAM |
| 存储空间 | 至少2GB可用空间 |
| 网络环境 | WiFi和移动网络（4G/5G） |
| 测试数据 | 包含多种分类和数量的标签数据（至少5个分类，总计50+标签） |

---

## 3. 功能测试用例

### 3.1 动态标签分类展示

#### 测试用例 TC-001：标签按Key正确分组
**测试步骤**：
1. 准备测试数据：创建包含多个不同Key的标签的联系人
2. 进入联系人详情页面，切换到"标签画像"Tab
3. 观察标签是否按Key正确分组显示

**预期结果**：
- 相同Key的标签归为同一分类
- 不同Key的标签显示在不同分类中
- 分类按字母顺序排列（中文按拼音）

**测试数据示例**：
```
兴趣爱好: 篮球, 足球, 阅读
工作信息: 程序员, 互联网行业
性格特点: 内向, 理性, 细心
```

#### 测试用例 TC-002：分类颜色分配
**测试步骤**：
1. 准备包含多个分类的测试数据
2. 进入标签画像界面
3. 观察每个分类的颜色标识
4. 切换深色/浅色模式，观察颜色变化

**预期结果**：
- 每个分类有独特的颜色标识（标题颜色、标签背景色）
- 同一分类在深色/浅色模式下颜色协调
- 颜色符合Pastel色系设计规范

#### 测试用例 TC-003：空分类处理
**测试步骤**：
1. 创建包含空分类的测试数据（通过API直接操作）
2. 进入标签画像界面

**预期结果**：
- 空分类不显示
- 只有包含标签的分类显示

#### 测试用例 TC-004：分类折叠/展开
**测试步骤**：
1. 准备包含多个标签的分类数据
2. 点击分类标题栏
3. 观察分类的折叠/展开状态变化
4. 测试动画效果

**预期结果**：
- 点击标题栏可切换折叠/展开状态
- 折叠时只显示标题栏，隐藏标签
- 展开时显示所有标签
- 动画流畅，无卡顿

### 3.2 搜索功能

#### 测试用例 TC-005：搜索栏基本功能
**测试步骤**：
1. 进入标签画像界面
2. 观察搜索栏显示
3. 点击搜索栏，输入关键词
4. 点击清除按钮

**预期结果**：
- 搜索栏显示"搜索标签或分类..."占位文本
- 输入时显示清除按钮
- 点击清除按钮清空输入内容

#### 测试用例 TC-006：实时过滤功能
**测试步骤**：
1. 准备包含多种标签的测试数据
2. 在搜索栏输入关键词
3. 观察过滤结果

**预期结果**：
- 输入关键词后实时过滤显示匹配结果
- 匹配标签内容的标签显示
- 匹配分类名称的分类完整显示
- 无匹配时显示"未找到匹配的标签"提示

#### 测试用例 TC-007：搜索关键词高亮
**测试步骤**：
1. 准备测试数据
2. 在搜索栏输入部分匹配的关键词
3. 观察匹配结果中的高亮显示

**预期结果**：
- 匹配的文字以加粗+Primary色高亮显示
- 非匹配文字保持正常样式

#### 测试用例 TC-008：搜索防抖处理
**测试步骤**：
1. 快速输入多个字符
2. 观察过滤响应时间

**预期结果**：
- 输入停止约300ms后才触发过滤
- 避免频繁过滤导致的性能问题

### 3.3 编辑模式

#### 测试用例 TC-009：进入编辑模式
**测试步骤**：
1. 进入标签画像界面
2. 长按任意标签（保持500ms）
3. 观察界面变化

**预期结果**：
- 触发轻微震动反馈
- 所有标签显示选择框
- 顶部显示"已选择 N 项"状态栏
- 底部显示批量操作栏
- 搜索栏被编辑模式顶栏替换

#### 测试用例 TC-010：标签选择操作
**测试步骤**：
1. 进入编辑模式
2. 点击不同标签进行选择/取消选择
3. 观察选择状态变化和计数更新

**预期结果**：
- 点击标签切换选中状态
- 选中标签显示CheckCircle图标和选中边框
- 顶部计数实时更新
- 底部操作按钮根据选择状态启用/禁用

#### 测试用例 TC-011：全选/取消全选
**测试步骤**：
1. 进入编辑模式
2. 点击分类旁的"全选"按钮
3. 观察该分类所有标签的选中状态
4. 点击"取消全选"按钮
5. 观察所有标签的选中状态

**预期结果**：
- 全选按钮选中该分类所有标签
- 取消全选按钮取消该分类所有标签的选中
- 顶部计数正确更新

#### 测试用例 TC-012：退出编辑模式
**测试步骤**：
1. 进入编辑模式并选择一些标签
2. 点击顶部的"取消"按钮

**预期结果**：
- 退出编辑模式
- 清空所有选择
- 恢复搜索栏显示
- 隐藏批量操作栏

### 3.4 批量操作

#### 测试用例 TC-013：批量删除功能
**测试步骤**：
1. 进入编辑模式
2. 选择多个标签
3. 点击底部"删除"按钮
4. 在确认对话框中点击"删除"
5. 观察删除结果

**预期结果**：
- 显示删除确认对话框
- 对话框显示选中标签数量
- 确认后选中的标签被删除
- 显示"已删除N个标签"Toast提示
- 自动退出编辑模式
- 数据库同步更新

#### 测试用例 TC-014：批量移动分类功能
**测试步骤**：
1. 进入编辑模式
2. 选择多个标签
3. 点击底部"移动分类"按钮
4. 在对话框中选择现有分类或创建新分类
5. 点击"确认移动"
6. 观察移动结果

**预期结果**：
- 显示移动分类对话框
- 显示现有分类列表和创建新分类选项
- 选择分类后启用确认按钮
- 确认后标签移动到新分类
- 显示"已移动N个标签到[分类名]"Toast提示
- 自动退出编辑模式
- 数据库同步更新

#### 测试用例 TC-015：新建分类验证
**测试步骤**：
1. 在批量移动对话框中选择"创建新分类"
2. 测试各种输入情况：
   - 空名称
   - 超过20字符的名称
   - 重复的分类名称
   - 合法的分类名称

**预期结果**：
- 空名称时显示错误提示，禁用确认按钮
- 超过20字符时自动截断
- 重复名称时提示"该分类已存在"
- 合法名称可以成功创建新分类

### 3.5 单元测试补充（自动化）

**说明**：以下用例用于保障 PRD-00014 关键业务逻辑的稳定性，测试均位于 `:domain` 模块。

| 测试文件 | 覆盖点 | 说明 |
|----------|--------|------|
| `domain/src/test/kotlin/com/empathy/ai/domain/usecase/GroupFactsByCategoryUseCaseTest.kt` | 分组/排序/颜色 | 验证按 key 分组、分类排序、颜色分配逻辑 |
| `domain/src/test/kotlin/com/empathy/ai/domain/usecase/BatchDeleteFactsUseCaseTest.kt` | 批量删除 | 验证空列表、联系人不存在、删除成功与无命中路径 |
| `domain/src/test/kotlin/com/empathy/ai/domain/usecase/BatchMoveFactsUseCaseTest.kt` | 批量移动 | 验证目标分类校验、联系人不存在、移动成功与无变化路径 |

**运行命令**：
```bash
./gradlew :domain:test --tests "*GroupFactsByCategoryUseCaseTest*"
./gradlew :domain:test --tests "*BatchDeleteFactsUseCaseTest*"
./gradlew :domain:test --tests "*BatchMoveFactsUseCaseTest*"
```

---

## 4. UI/UX测试

### 4.1 界面元素测试

#### 测试用例 TC-016：界面布局
**测试步骤**：
1. 在不同屏幕尺寸的设备上进入标签画像界面
2. 观察整体布局和元素排列

**预期结果**：
- 搜索栏/编辑模式顶栏位于顶部
- 分类卡片垂直排列，间距合理
- 批量操作栏固定在底部（编辑模式时）
- 所有元素在不同屏幕尺寸下正确显示

#### 测试用例 TC-017：视觉风格
**测试步骤**：
1. 在浅色模式下观察界面
2. 切换到深色模式观察界面
3. 测试系统主题自动跟随

**预期结果**：
- 浅色/深色模式下颜色协调
- 文字对比度符合可读性要求
- 系统主题变化时界面自动适应

#### 测试用例 TC-018：动画效果
**测试步骤**：
1. 测试分类折叠/展开动画
2. 测试进入/退出编辑模式动画
3. 测试标签选择动画
4. 测试对话框显示/隐藏动画

**预期结果**：
- 所有动画流畅，无卡顿
- 动画时长合理（约300ms）
- 动画缓动自然

### 4.2 交互流程测试

#### 测试用例 TC-019：操作路径清晰性
**测试步骤**：
1. 测试从普通模式到编辑模式的操作路径
2. 测试批量操作的完整流程
3. 测试搜索功能的操作路径

**预期结果**：
- 操作路径直观，符合用户预期
- 关键操作有明确提示（如删除确认）
- 操作反馈及时（如Toast提示）

#### 测试用例 TC-020：错误处理
**测试步骤**：
1. 测试网络异常时的操作
2. 测试数据库操作失败的处理
3. 测试边界条件（如极长文本）

**预期结果**：
- 错误提示友好，不使用技术术语
- 提供重试机制
- 不会导致应用崩溃

### 4.3 响应式设计测试

#### 测试用例 TC-021：屏幕尺寸适配
**测试步骤**：
1. 在小屏设备（如5.5英寸）上测试
2. 在大屏设备（如6.7英寸）上测试
3. 测试横屏模式

**预期结果**：
- 不同屏幕尺寸下布局合理
- 文字大小适中，可读性好
- 触摸目标大小符合规范（最小48dp）

#### 测试用例 TC-022：字体大小适配
**测试步骤**：
1. 在系统设置中调整字体大小（小、标准、大）
2. 观察界面文字显示

**预期结果**：
- 文字大小随系统设置变化
- 布局不因文字大小变化而错乱

---

## 5. 兼容性测试

### 5.1 设备兼容性

#### 测试用例 TC-023：不同设备型号
**测试步骤**：
1. 在至少3种不同品牌/型号的设备上测试
2. 验证所有功能正常工作

**预期结果**：
- 所有设备上功能一致
- 无设备特定的问题

#### 测试用例 TC-024：Android版本兼容性
**测试步骤**：
1. 在Android 7.0、10.0、13.0等不同版本上测试
2. 验证核心功能正常

**预期结果**：
- 支持的最低Android版本（7.0）上功能正常
- 新版本Android上无兼容性问题

### 5.2 屏幕尺寸测试

#### 测试用例 TC-025：分辨率适配
**测试步骤**：
1. 测试不同分辨率（720p、1080p、1440p等）
2. 验证界面元素正确显示

**预期结果**：
- 不同分辨率下界面清晰
- 元素大小比例协调

---

## 6. 性能测试

### 6.1 加载性能

#### 测试用例 TC-026：首屏加载时间
**测试步骤**：
1. 清空应用缓存
2. 进入包含大量标签（100+）的联系人详情页
3. 切换到标签画像Tab
4. 记录加载完成时间

**预期结果**：
- 首屏加载时间 < 500ms
- 用户感知加载流畅

#### 测试用例 TC-027：搜索响应时间
**测试步骤**：
1. 在包含大量标签的界面进行搜索
2. 测量从输入到显示结果的时间

**预期结果**：
- 搜索响应时间 < 300ms（含防抖）
- 搜索过程流畅

### 6.2 内存使用

#### 测试用例 TC-028：内存占用
**测试步骤**：
1. 使用开发工具监控内存使用
2. 测试不同数据量下的内存占用

**预期结果**：
- 100个标签的内存增量 < 5MB
- 无明显内存泄漏

### 6.3 电池消耗

#### 测试用例 TC-029：电池优化
**测试步骤**：
1. 长时间使用标签画像功能（30分钟）
2. 监控电池消耗

**预期结果**：
- 无异常的电池消耗
- 后台无不必要的活动

---

## 7. 回归测试清单

### 7.1 基础功能回归

| 测试项 | 测试方法 | 预期结果 |
|--------|----------|----------|
| 联系人列表显示 | 进入联系人列表 | 正常显示所有联系人 |
| 联系人详情查看 | 点击联系人进入详情 | 正常显示联系人信息 |
| 其他Tab切换 | 在联系人详情页切换不同Tab | 所有Tab正常显示 |
| 现有标签编辑 | 点击现有标签编辑 | 编辑功能正常 |
| 事实流功能 | 切换到事实流Tab | 正常显示事实流 |

### 7.2 数据兼容性

| 测试项 | 测试方法 | 预期结果 |
|--------|----------|----------|
| 旧数据兼容 | 使用升级前创建的联系人数据 | 正常显示和操作 |
| 数据同步 | 修改标签后检查数据库 | 数据正确保存 |
| 数据完整性 | 批量操作后验证数据完整性 | 无数据丢失或损坏 |

---

## 8. 测试报告模板

### 8.1 测试执行报告

```
# 联系人画像界面升级测试报告

## 测试基本信息
- 测试日期：YYYY-MM-DD
- 测试人员：[姓名]
- 测试设备：[设备型号]
- Android版本：[版本号]
- 应用版本：[版本号]

## 测试结果汇总
- 总测试用例数：[数量]
- 通过用例数：[数量]
- 失败用例数：[数量]
- 阻塞用例数：[数量]
- 通过率：[百分比]%

## 功能测试结果
### 动态标签分类展示
- TC-001: [通过/失败] - [备注]
- TC-002: [通过/失败] - [备注]
- ...

### 搜索功能
- TC-005: [通过/失败] - [备注]
- ...

[其他功能模块]

## 发现的问题
| 问题ID | 严重程度 | 问题描述 | 复现步骤 | 预期结果 | 实际结果 |
|--------|----------|----------|----------|----------|----------|
| BUG-001 | [高/中/低] | [描述] | [步骤] | [预期] | [实际] |

## 测试建议
1. [建议1]
2. [建议2]

## 测试结论
[总体评价和发布建议]
```

### 8.2 问题跟踪模板

```
# 问题跟踪表

## 基本信息
- 问题ID：BUG-XXX
- 发现日期：YYYY-MM-DD
- 发现人：[姓名]
- 严重程度：[致命/严重/一般/轻微]
- 优先级：[高/中/低]

## 问题描述
### 简要描述
[简短描述问题]

### 详细描述
[详细描述问题现象和影响]

### 复现步骤
1. [步骤1]
2. [步骤2]
3. [步骤3]

### 预期结果
[描述应该出现的正确结果]

### 实际结果
[描述实际出现的结果]

### 环境信息
- 设备型号：[型号]
- Android版本：[版本]
- 应用版本：[版本]
- 测试数据：[描述]

## 附件
- [截图1]
- [日志文件]
- [录屏视频]

## 处理状态
- 状态：[新建/处理中/已修复/已验证/已关闭]
- 负责人：[姓名]
- 修复版本：[版本号]
- 验证结果：[通过/失败]
```

---

## 9. 测试注意事项

### 9.1 测试前准备

1. **数据准备**：确保测试账号包含足够的测试数据
   - 至少5个不同分类的标签
   - 每个分类包含5-10个标签
   - 包含特殊字符和长文本的标签

2. **环境准备**：
   - 清空应用缓存，确保首次加载测试
   - 确保网络连接稳定
   - 关闭不必要的后台应用

3. **工具准备**：
   - 安装Android Studio用于查看日志
   - 准备性能监控工具
   - 准备截图和录屏工具

### 9.2 测试执行要点

1. **逐步验证**：按照测试用例顺序执行，确保每个功能点都覆盖到
2. **边界测试**：特别注意边界条件和异常情况
3. **性能关注**：在测试过程中关注性能表现，记录异常情况
4. **用户体验**：从用户角度评估操作流程的合理性

### 9.3 问题记录规范

1. **详细描述**：问题描述要清晰、完整
2. **复现步骤**：提供明确的复现步骤
3. **环境信息**：记录详细的测试环境信息
4. **附件齐全**：提供截图、日志等辅助信息

---

## 10. 发布标准

### 10.1 功能完整性

- [ ] 所有P0级别测试用例100%通过
- [ ] 所有P1级别测试用例95%以上通过
- [ ] 核心功能无严重缺陷
- [ ] 用户操作流程完整且顺畅

### 10.2 性能标准

- [ ] 首屏加载时间 < 500ms
- [ ] 搜索响应时间 < 300ms
- [ ] 列表滚动帧率 ≥ 55fps
- [ ] 内存增量 < 5MB（100标签）

### 10.3 兼容性标准

- [ ] 支持的Android版本上功能正常
- [ ] 不同屏幕尺寸适配良好
- [ ] 与现有功能无冲突

### 10.4 用户体验标准

- [ ] 操作流程直观易懂
- [ ] 错误提示友好明确
- [ ] 视觉效果符合设计规范
- [ ] 交互反馈及时准确

---

## 11. 相关文档

- [PRD-00014-联系人画像界面升级需求](../PRD/PRD-00014-联系人画像界面升级需求.md)
- [FD-00014-联系人画像界面升级功能设计](../FD/FD-00014-联系人画像界面升级功能设计.md)
- [TDD-00014-联系人画像界面升级技术设计](../TDD/TDD-00014-联系人画像界面升级技术设计.md)
- [TD-00014-联系人画像界面升级任务清单](../TD/TD-00014-联系人画像界面升级任务清单.md)

---

## 12. 修订历史

| 版本 | 日期 | 作者 | 修改内容 |
|------|------|------|----------|
| 1.0 | 2025-12-22 | Roo | 初始版本，基于PRD-00014、FD-00014、TDD-00014和TD-00014创建完整测试指南 |
| 1.1 | 2026-01-18 | Codex | 补充单元测试覆盖与运行命令 |
