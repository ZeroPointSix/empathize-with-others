<!DOCTYPE html>
<html lang="zh-CN" style="height: 100%;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>资料库页 - DataVaultTab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body {
            height: 100%;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            overflow: auto;
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        .filled {
            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(10px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
    </style>
</head>
<body>
    <div class="w-full h-full bg-[#F2F2F7] flex flex-col font-sans select-none overflow-hidden">
        
        <!-- 固定头部导航 -->
        <div class="sticky top-0 z-50 bg-[#F2F2F7]/85 backdrop-blur-xl border-b border-slate-200/50">
            <!-- 顶部操作栏 -->
            <div class="flex justify-between items-center px-4 h-[52px]">
                <button class="w-10 h-10 flex items-center justify-center rounded-full bg-white/50 hover:bg-white transition-colors text-slate-900 backdrop-blur-md shadow-sm border border-white/20" title="返回">
                    <span class="material-symbols-outlined text-[22px]">arrow_back</span>
                </button>
                <h1 class="text-[17px] font-semibold text-slate-900">小红</h1>
                <button class="w-10 h-10 flex items-center justify-center rounded-full bg-white/50 hover:bg-white transition-colors text-slate-900 backdrop-blur-md shadow-sm border border-white/20" title="更多">
                    <span class="material-symbols-outlined text-[22px]">more_horiz</span>
                </button>
            </div>

            <!-- 标签页导航 - DetailTab枚举 -->
            <div class="flex justify-around items-end px-2 h-11 mt-1">
                <button class="px-4 py-2.5 text-[15px] font-medium text-slate-500 hover:text-slate-700 transition-colors">概览</button>
                <button class="px-4 py-2.5 text-[15px] font-medium text-slate-500 hover:text-slate-700 transition-colors">事实流</button>
                <button class="px-4 py-2.5 text-[15px] font-medium text-slate-500 hover:text-slate-700 transition-colors">标签画像</button>
                <button class="relative px-4 py-2.5 text-[15px] font-bold text-slate-900">
                    资料库
                    <div class="absolute bottom-0 left-1/2 -translate-x-1/2 w-8 h-[3px] bg-indigo-600 rounded-full"></div>
                </button>
            </div>
        </div>

        <!-- 主滚动内容 - DataVaultTab -->
        <div class="flex-1 overflow-y-auto no-scrollbar pb-28">
            
            <!-- 标题区域 -->
            <div class="px-4 pt-4 pb-3">
                <h2 class="text-[28px] font-bold text-slate-900 tracking-tight mb-1">数据来源</h2>
                <p class="text-[14px] text-slate-500">管理与该联系人相关的所有数据</p>
            </div>

            <!-- 数据统计卡片 -->
            <div class="px-4 mb-5 animate-fade-in" style="animation-delay: 0.1s;">
                <div class="bg-white rounded-[20px] p-5 shadow-[0_8px_30px_-12px_rgba(0,0,0,0.06)] border border-slate-100 flex justify-between items-center relative overflow-hidden">
                    <!-- 装饰性背景 -->
                    <div class="absolute -right-6 -top-6 w-24 h-24 bg-indigo-100 rounded-full blur-2xl opacity-60"></div>
                    <div class="absolute -left-4 -bottom-4 w-16 h-16 bg-purple-100 rounded-full blur-xl opacity-40"></div>
                    
                    <div class="relative z-10">
                        <p class="text-indigo-600/80 text-[11px] font-bold uppercase tracking-wider">数据总量</p>
                        <p class="text-slate-900 text-3xl font-bold mt-1 tracking-tight">
                            <span id="total-count">854</span> 
                            <span class="text-sm font-normal text-slate-400 ml-0.5">条</span>
                        </p>
                    </div>
                    <div class="relative z-10 w-12 h-12 bg-indigo-50 rounded-full flex items-center justify-center text-indigo-600 shadow-sm">
                        <span class="material-symbols-outlined">analytics</span>
                    </div>
                </div>
            </div>

            <!-- 数据网格 - DataSourceCard (2列网格) -->
            <div class="px-4 grid grid-cols-2 gap-3">
                
                <!-- 聊天记录 - conversationCount -->
                <div class="bg-white rounded-[20px] p-4 shadow-[0_8px_30px_-12px_rgba(0,0,0,0.06)] border border-slate-100 active:scale-[0.98] transition-all group hover:border-blue-200 hover:shadow-lg cursor-pointer animate-fade-in" style="animation-delay: 0.15s;">
                    <div class="flex justify-between items-start mb-3">
                        <div class="w-11 h-11 bg-blue-50 rounded-xl flex items-center justify-center group-hover:bg-blue-100 transition-colors">
                            <span class="material-symbols-outlined text-blue-600 text-[24px]">chat_bubble</span>
                        </div>
                        <span class="text-[11px] font-bold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg">842</span>
                    </div>
                    <p class="text-[16px] font-semibold text-slate-900">聊天记录</p>
                    <p class="text-[12px] text-slate-400 mt-0.5">对话历史</p>
                </div>

                <!-- AI总结 - summaryCount -->
                <div class="bg-white rounded-[20px] p-4 shadow-[0_8px_30px_-12px_rgba(0,0,0,0.06)] border border-slate-100 active:scale-[0.98] transition-all group hover:border-violet-200 hover:shadow-lg cursor-pointer animate-fade-in" style="animation-delay: 0.2s;">
                    <div class="flex justify-between items-start mb-3">
                        <div class="w-11 h-11 bg-violet-50 rounded-xl flex items-center justify-center group-hover:bg-violet-100 transition-colors">
                            <span class="material-symbols-outlined text-violet-600 text-[24px]">auto_awesome</span>
                        </div>
                        <span class="text-[11px] font-bold text-violet-600 bg-violet-50 px-2.5 py-1 rounded-lg">12</span>
                    </div>
                    <p class="text-[16px] font-semibold text-slate-900">AI 总结</p>
                    <p class="text-[12px] text-slate-400 mt-0.5">智能分析</p>
                </div>

                <!-- 图片 - 媒体类未实现，固定为0 -->
                <div class="bg-white rounded-[20px] p-4 shadow-[0_8px_30px_-12px_rgba(0,0,0,0.06)] border border-slate-100 active:scale-[0.98] transition-all group hover:border-pink-200 hover:shadow-lg cursor-pointer animate-fade-in relative" style="animation-delay: 0.25s;">
                    <div class="flex justify-between items-start mb-3">
                        <div class="w-11 h-11 bg-pink-50 rounded-xl flex items-center justify-center group-hover:bg-pink-100 transition-colors">
                            <span class="material-symbols-outlined text-pink-600 text-[24px]">image</span>
                        </div>
                        <span class="text-[11px] font-bold text-slate-400 bg-slate-100 px-2.5 py-1 rounded-lg">0</span>
                    </div>
                    <p class="text-[16px] font-semibold text-slate-900">图片</p>
                    <p class="text-[12px] text-slate-400 mt-0.5">媒体文件</p>
                    <!-- 状态角标 - DataStatus.NOT_AVAILABLE -->
                    <div class="absolute top-3 right-3 w-2 h-2 bg-slate-300 rounded-full" title="不可用"></div>
                </div>

                <!-- 语音 - 媒体类未实现，固定为0 -->
                <div class="bg-white rounded-[20px] p-4 shadow-[0_8px_30px_-12px_rgba(0,0,0,0.06)] border border-slate-100 active:scale-[0.98] transition-all group hover:border-cyan-200 hover:shadow-lg cursor-pointer animate-fade-in relative" style="animation-delay: 0.3s;">
                    <div class="flex justify-between items-start mb-3">
                        <div class="w-11 h-11 bg-cyan-50 rounded-xl flex items-center justify-center group-hover:bg-cyan-100 transition-colors">
                            <span class="material-symbols-outlined text-cyan-600 text-[24px]">mic</span>
                        </div>
                        <span class="text-[11px] font-bold text-slate-400 bg-slate-100 px-2.5 py-1 rounded-lg">0</span>
                    </div>
                    <p class="text-[16px] font-semibold text-slate-900">语音消息</p>
                    <p class="text-[12px] text-slate-400 mt-0.5">音频记录</p>
                    <!-- 状态角标 - DataStatus.NOT_AVAILABLE -->
                    <div class="absolute top-3 right-3 w-2 h-2 bg-slate-300 rounded-full" title="不可用"></div>
                </div>

                <!-- 视频 - 媒体类未实现，固定为0 -->
                <div class="bg-white rounded-[20px] p-4 shadow-[0_8px_30px_-12px_rgba(0,0,0,0.06)] border border-slate-100 active:scale-[0.98] transition-all group hover:border-orange-200 hover:shadow-lg cursor-pointer animate-fade-in relative" style="animation-delay: 0.35s;">
                    <div class="flex justify-between items-start mb-3">
                        <div class="w-11 h-11 bg-orange-50 rounded-xl flex items-center justify-center group-hover:bg-orange-100 transition-colors">
                            <span class="material-symbols-outlined text-orange-600 text-[24px]">videocam</span>
                        </div>
                        <span class="text-[11px] font-bold text-slate-400 bg-slate-100 px-2.5 py-1 rounded-lg">0</span>
                    </div>
                    <p class="text-[16px] font-semibold text-slate-900">视频</p>
                    <p class="text-[12px] text-slate-400 mt-0.5">视频动态</p>
                    <!-- 状态角标 - DataStatus.NOT_AVAILABLE -->
                    <div class="absolute top-3 right-3 w-2 h-2 bg-slate-300 rounded-full" title="不可用"></div>
                </div>

                <!-- 文件 - 媒体类未实现，固定为0 -->
                <div class="bg-white rounded-[20px] p-4 shadow-[0_8px_30px_-12px_rgba(0,0,0,0.06)] border border-slate-100 active:scale-[0.98] transition-all group hover:border-emerald-200 hover:shadow-lg cursor-pointer animate-fade-in relative" style="animation-delay: 0.4s;">
                    <div class="flex justify-between items-start mb-3">
                        <div class="w-11 h-11 bg-emerald-50 rounded-xl flex items-center justify-center group-hover:bg-emerald-100 transition-colors">
                            <span class="material-symbols-outlined text-emerald-600 text-[24px]">folder</span>
                        </div>
                        <span class="text-[11px] font-bold text-slate-400 bg-slate-100 px-2.5 py-1 rounded-lg">0</span>
                    </div>
                    <p class="text-[16px] font-semibold text-slate-900">文件</p>
                    <p class="text-[12px] text-slate-400 mt-0.5">其他文档</p>
                    <!-- 状态角标 - DataStatus.NOT_AVAILABLE -->
                    <div class="absolute top-3 right-3 w-2 h-2 bg-slate-300 rounded-full" title="不可用"></div>
                </div>

            </div>

            <!-- 功能说明区域 -->
            <div class="px-4 mt-6 animate-fade-in" style="animation-delay: 0.45s;">
                <div class="bg-amber-50/50 rounded-[20px] p-4 border border-amber-100">
                    <div class="flex items-start gap-3">
                        <span class="material-symbols-outlined text-amber-500 text-[20px] mt-0.5">info</span>
                        <div>
                            <p class="text-[14px] font-medium text-amber-700 mb-1">媒体功能开发中</p>
                            <p class="text-[13px] text-amber-600/80">图片、语音、视频和文件功能正在开发中，敬请期待。目前仅支持聊天记录和AI总结的管理。</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 状态说明 -->
            <div class="px-4 mt-4 animate-fade-in" style="animation-delay: 0.5s;">
                <h3 class="text-[13px] font-medium text-slate-400 uppercase tracking-wider mb-3">状态说明</h3>
                <div class="bg-white rounded-[20px] p-4 shadow-[0_8px_30px_-12px_rgba(0,0,0,0.06)] border border-slate-100">
                    <div class="space-y-3">
                        <div class="flex items-center gap-3">
                            <div class="w-3 h-3 bg-emerald-500 rounded-full"></div>
                            <span class="text-[14px] text-slate-700">已完成 - 数据已同步</span>
                        </div>
                        <div class="flex items-center gap-3">
                            <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                            <span class="text-[14px] text-slate-700">处理中 - 正在同步数据</span>
                        </div>
                        <div class="flex items-center gap-3">
                            <div class="w-3 h-3 bg-slate-300 rounded-full"></div>
                            <span class="text-[14px] text-slate-700">不可用 - 功能开发中</span>
                        </div>
                        <div class="flex items-center gap-3">
                            <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                            <span class="text-[14px] text-slate-700">失败 - 同步出错</span>
                        </div>
                    </div>
                </div>
            </div>

        </div>

    </div>

    <!-- 
    ============================================================
    代码映射说明 (基于实际Kotlin代码 - 2025-12-25更新)
    ============================================================
    
    【文件映射】
    - DataVaultTab.kt: 资料库标签页主容器
    - DataSourceCard.kt: 数据来源卡片组件
    - StatusBadge.kt: 状态角标组件
    - EmptyVaultView.kt: 空状态视图（内部私有组件）
    
    【数据模型】
    - DataSourceInfo: 数据来源信息
      ├─ id: String (唯一标识)
      ├─ title: String (显示标题)
      ├─ icon: ImageVector (Material图标)
      ├─ count: Int (数据数量)
      └─ status: DataStatus (状态枚举)
    
    - DataStatus枚举 (4种状态):
      ├─ COMPLETED: 已完成（绿色 - 数据已分析完成，已合入事实流和画像）
      ├─ PROCESSING: 处理中（蓝色 - 数据正在排队或分析中）
      ├─ FAILED: 失败（红色 - 数据分析失败）
      └─ NOT_AVAILABLE: 不可用（灰色 - 功能未实现或数据源不可用）
    
    【当前支持的数据源】
    ✅ 已实现:
    - chat: 聊天记录 (conversationCount) - Icons.Default.Chat
    - summary: AI总结 (summaryCount) - Icons.Default.AutoAwesome
    
    ❌ 未实现 (状态固定为NOT_AVAILABLE):
    - image: 图片 - Icons.Default.Image
    - voice: 语音消息 - Icons.Default.Mic
    - video: 视频 - Icons.Default.VideoFile
    - folder: 文件 - Icons.Default.Folder
    - note: 备注 - Icons.Default.Note
    
    【技术债务说明】
    - 媒体数据源未实现：AiRepositoryImpl.transcribeMedia方法返回未实现异常
    - 需要集成：FFmpeg音视频处理、ASR语音识别、OCR文字识别
    - FFmpeg Kit 6.0.LTS已配置但未启用（app/build.gradle.kts中已注释）
    
    【交互事件】
    - onDataSourceClick: ((DataSourceInfo) -> Unit)? - 数据源点击回调
    
    【布局说明】
    - 使用LazyVerticalGrid实现2列网格布局
    - GridCells.Fixed(2): 固定2列
    - contentPadding: Dimensions.SpacingMedium
    - horizontalArrangement/verticalArrangement: spacedBy(Dimensions.SpacingMedium)
    
    【字符串资源】
    - data_status_completed: "已完成"
    - data_status_processing: "处理中"
    - data_status_failed: "失败"
    - data_status_not_available: "不可用"
    -->
</body>
</html>
